import{b1 as t,c as e,aA as n,aO as o}from"../index-Bk8j52k6.mjs";import{b as i,t as l,T as r,F as s,S as a,c,P as h,N as f}from"../tiptap-pm-entry-C1u8SbQo.mjs";const d=["top","right","bottom","left"],u=["start","end"],p=/* @__PURE__ */d.reduce((t,e)=>t.concat(e,e+"-"+u[0],e+"-"+u[1]),[]),m=Math.min,g=Math.max,w=Math.round,y=t=>({x:t,y:t}),v={left:"right",right:"left",bottom:"top",top:"bottom"},b={start:"end",end:"start"};function x(t,e,n){return g(t,m(e,n))}function C(t,e){return"function"==typeof t?t(e):t}function R(t){return t.split("-")[0]}function O(t){return t.split("-")[1]}function S(t){return"x"===t?"y":"x"}function T(t){return"y"===t?"height":"width"}const D=/* @__PURE__ */new Set(["top","bottom"]);function $(t){return D.has(R(t))?"y":"x"}function E(t){return S($(t))}function A(t,e,n){void 0===n&&(n=!1);const o=O(t),i=E(t),l=T(i);let r="x"===i?o===(n?"end":"start")?"right":"left":"start"===o?"bottom":"top";return e.reference[l]>e.floating[l]&&(r=P(r)),[r,P(r)]}function L(t){return t.replace(/start|end/g,t=>b[t])}const H=["left","right"],I=["right","left"],U=["top","bottom"],M=["bottom","top"];function z(t,e,n,o){const i=O(t);let l=function(t,e,n){switch(t){case"top":case"bottom":return n?e?I:H:e?H:I;case"left":case"right":return e?U:M;default:return[]}}(R(t),"start"===n,o);return i&&(l=l.map(t=>t+"-"+i),e&&(l=l.concat(l.map(L)))),l}function P(t){return t.replace(/left|right|bottom|top/g,t=>v[t])}function B(t){return"number"!=typeof t?function(t){return{top:0,right:0,bottom:0,left:0,...t}}(t):{top:t,right:t,bottom:t,left:t}}function k(t){const{x:e,y:n,width:o,height:i}=t;return{width:o,height:i,top:n,left:e,right:e+o,bottom:n+i,x:e,y:n}}function V(t,e,n){let{reference:o,floating:i}=t;const l=$(e),r=E(e),s=T(r),a=R(e),c="y"===l,h=o.x+o.width/2-i.width/2,f=o.y+o.height/2-i.height/2,d=o[s]/2-i[s]/2;let u;switch(a){case"top":u={x:h,y:o.y-i.height};break;case"bottom":u={x:h,y:o.y+o.height};break;case"right":u={x:o.x+o.width,y:f};break;case"left":u={x:o.x-i.width,y:f};break;default:u={x:o.x,y:o.y}}switch(O(e)){case"start":u[r]-=d*(n&&c?-1:1);break;case"end":u[r]+=d*(n&&c?-1:1)}return u}async function N(t,e){var n;void 0===e&&(e={});const{x:o,y:i,platform:l,rects:r,elements:s,strategy:a}=t,{boundary:c="clippingAncestors",rootBoundary:h="viewport",elementContext:f="floating",altBoundary:d=!1,padding:u=0}=C(e,t),p=B(u),m=s[d?"floating"===f?"reference":"floating":f],g=k(await l.getClippingRect({element:null==(n=await(null==l.isElement?void 0:l.isElement(m)))||n?m:m.contextElement||await(null==l.getDocumentElement?void 0:l.getDocumentElement(s.floating)),boundary:c,rootBoundary:h,strategy:a})),w="floating"===f?{x:o,y:i,width:r.floating.width,height:r.floating.height}:r.reference,y=await(null==l.getOffsetParent?void 0:l.getOffsetParent(s.floating)),v=await(null==l.isElement?void 0:l.isElement(y))&&await(null==l.getScale?void 0:l.getScale(y))||{x:1,y:1},b=k(l.convertOffsetParentRelativeRectToViewportRelativeRect?await l.convertOffsetParentRelativeRectToViewportRelativeRect({elements:s,rect:w,offsetParent:y,strategy:a}):w);return{top:(g.top-b.top+p.top)/v.y,bottom:(b.bottom-g.bottom+p.bottom)/v.y,left:(g.left-b.left+p.left)/v.x,right:(b.right-g.right+p.right)/v.x}}function F(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function W(t){return d.some(e=>t[e]>=0)}function _(t){const e=m(...t.map(t=>t.left)),n=m(...t.map(t=>t.top));return{x:e,y:n,width:g(...t.map(t=>t.right))-e,height:g(...t.map(t=>t.bottom))-n}}const q=/* @__PURE__ */new Set(["left","top"]);function j(){return"undefined"!=typeof window}function K(t){return Y(t)?(t.nodeName||"").toLowerCase():"#document"}function J(t){var e;return(null==t||null==(e=t.ownerDocument)?void 0:e.defaultView)||window}function X(t){var e;return null==(e=(Y(t)?t.ownerDocument:t.document)||window.document)?void 0:e.documentElement}function Y(t){return!!j()&&(t instanceof Node||t instanceof J(t).Node)}function G(t){return!!j()&&(t instanceof Element||t instanceof J(t).Element)}function Q(t){return!!j()&&(t instanceof HTMLElement||t instanceof J(t).HTMLElement)}function Z(t){return!(!j()||"undefined"==typeof ShadowRoot)&&(t instanceof ShadowRoot||t instanceof J(t).ShadowRoot)}const tt=/* @__PURE__ */new Set(["inline","contents"]);function et(t){const{overflow:e,overflowX:n,overflowY:o,display:i}=ut(t);return/auto|scroll|overlay|hidden|clip/.test(e+o+n)&&!tt.has(i)}const nt=/* @__PURE__ */new Set(["table","td","th"]);function ot(t){return nt.has(K(t))}const it=[":popover-open",":modal"];function lt(t){return it.some(e=>{try{return t.matches(e)}catch(n){return!1}})}const rt=["transform","translate","scale","rotate","perspective"],st=["transform","translate","scale","rotate","perspective","filter"],at=["paint","layout","strict","content"];function ct(t){const e=ht(),n=G(t)?ut(t):t;return rt.some(t=>!!n[t]&&"none"!==n[t])||!!n.containerType&&"normal"!==n.containerType||!e&&!!n.backdropFilter&&"none"!==n.backdropFilter||!e&&!!n.filter&&"none"!==n.filter||st.some(t=>(n.willChange||"").includes(t))||at.some(t=>(n.contain||"").includes(t))}function ht(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}const ft=/* @__PURE__ */new Set(["html","body","#document"]);function dt(t){return ft.has(K(t))}function ut(t){return J(t).getComputedStyle(t)}function pt(t){return G(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function mt(t){if("html"===K(t))return t;const e=t.assignedSlot||t.parentNode||Z(t)&&t.host||X(t);return Z(e)?e.host:e}function gt(t){const e=mt(t);return dt(e)?t.ownerDocument?t.ownerDocument.body:t.body:Q(e)&&et(e)?e:gt(e)}function wt(t,e,n){var o;void 0===e&&(e=[]);const i=gt(t),l=i===(null==(o=t.ownerDocument)?void 0:o.body),r=J(i);return l?(yt(r),e.concat(r,r.visualViewport||[],et(i)?i:[],[])):e.concat(i,wt(i,[]))}function yt(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function vt(t){const e=ut(t);let n=parseFloat(e.width)||0,o=parseFloat(e.height)||0;const i=Q(t),l=i?t.offsetWidth:n,r=i?t.offsetHeight:o,s=w(n)!==l||w(o)!==r;return s&&(n=l,o=r),{width:n,height:o,$:s}}function bt(t){return G(t)?t:t.contextElement}function xt(t){const e=bt(t);if(!Q(e))return y(1);const n=e.getBoundingClientRect(),{width:o,height:i,$:l}=vt(e);let r=(l?w(n.width):n.width)/o,s=(l?w(n.height):n.height)/i;return r&&Number.isFinite(r)||(r=1),s&&Number.isFinite(s)||(s=1),{x:r,y:s}}const Ct=/* @__PURE__ */y(0);function Rt(t){const e=J(t);return ht()&&e.visualViewport?{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}:Ct}function Ot(t,e,n,o){void 0===e&&(e=!1),void 0===n&&(n=!1);const i=t.getBoundingClientRect(),l=bt(t);let r=y(1);e&&(o?G(o)&&(r=xt(o)):r=xt(t));const s=function(t,e,n){return void 0===e&&(e=!1),!(!n||e&&n!==J(t))&&e}(l,n,o)?Rt(l):y(0);let a=(i.left+s.x)/r.x,c=(i.top+s.y)/r.y,h=i.width/r.x,f=i.height/r.y;if(l){const t=J(l),e=o&&G(o)?J(o):o;let n=t,i=yt(n);for(;i&&o&&e!==n;){const t=xt(i),e=i.getBoundingClientRect(),o=ut(i),l=e.left+(i.clientLeft+parseFloat(o.paddingLeft))*t.x,r=e.top+(i.clientTop+parseFloat(o.paddingTop))*t.y;a*=t.x,c*=t.y,h*=t.x,f*=t.y,a+=l,c+=r,n=J(i),i=yt(n)}}return k({width:h,height:f,x:a,y:c})}function St(t,e){const n=pt(t).scrollLeft;return e?e.left+n:Ot(X(t)).left+n}function Tt(t,e){const n=t.getBoundingClientRect();return{x:n.left+e.scrollLeft-St(t,n),y:n.top+e.scrollTop}}const Dt=/* @__PURE__ */new Set(["absolute","fixed"]);function $t(t,e,n){let o;if("viewport"===e)o=function(t,e){const n=J(t),o=X(t),i=n.visualViewport;let l=o.clientWidth,r=o.clientHeight,s=0,a=0;if(i){l=i.width,r=i.height;const t=ht();(!t||t&&"fixed"===e)&&(s=i.offsetLeft,a=i.offsetTop)}const c=St(o);if(c<=0){const t=o.ownerDocument,e=t.body,n=getComputedStyle(e),i="CSS1Compat"===t.compatMode&&parseFloat(n.marginLeft)+parseFloat(n.marginRight)||0,r=Math.abs(o.clientWidth-e.clientWidth-i);r<=25&&(l-=r)}else c<=25&&(l+=c);return{width:l,height:r,x:s,y:a}}(t,n);else if("document"===e)o=function(t){const e=X(t),n=pt(t),o=t.ownerDocument.body,i=g(e.scrollWidth,e.clientWidth,o.scrollWidth,o.clientWidth),l=g(e.scrollHeight,e.clientHeight,o.scrollHeight,o.clientHeight);let r=-n.scrollLeft+St(t);const s=-n.scrollTop;return"rtl"===ut(o).direction&&(r+=g(e.clientWidth,o.clientWidth)-i),{width:i,height:l,x:r,y:s}}(X(t));else if(G(e))o=function(t,e){const n=Ot(t,!0,"fixed"===e),o=n.top+t.clientTop,i=n.left+t.clientLeft,l=Q(t)?xt(t):y(1);return{width:t.clientWidth*l.x,height:t.clientHeight*l.y,x:i*l.x,y:o*l.y}}(e,n);else{const n=Rt(t);o={x:e.x-n.x,y:e.y-n.y,width:e.width,height:e.height}}return k(o)}function Et(t,e){const n=mt(t);return!(n===e||!G(n)||dt(n))&&("fixed"===ut(n).position||Et(n,e))}function At(t,e,n){const o=Q(e),i=X(e),l="fixed"===n,r=Ot(t,!0,l,e);let s={scrollLeft:0,scrollTop:0};const a=y(0);function c(){a.x=St(i)}if(o||!o&&!l)if(("body"!==K(e)||et(i))&&(s=pt(e)),o){const t=Ot(e,!0,l,e);a.x=t.x+e.clientLeft,a.y=t.y+e.clientTop}else i&&c();l&&!o&&i&&c();const h=!i||o||l?y(0):Tt(i,s);return{x:r.left+s.scrollLeft-a.x-h.x,y:r.top+s.scrollTop-a.y-h.y,width:r.width,height:r.height}}function Lt(t){return"static"===ut(t).position}function Ht(t,e){if(!Q(t)||"fixed"===ut(t).position)return null;if(e)return e(t);let n=t.offsetParent;return X(t)===n&&(n=n.ownerDocument.body),n}function It(t,e){const n=J(t);if(lt(t))return n;if(!Q(t)){let e=mt(t);for(;e&&!dt(e);){if(G(e)&&!Lt(e))return e;e=mt(e)}return n}let o=Ht(t,e);for(;o&&ot(o)&&Lt(o);)o=Ht(o,e);return o&&dt(o)&&Lt(o)&&!ct(o)?n:o||function(t){let e=mt(t);for(;Q(e)&&!dt(e);){if(ct(e))return e;if(lt(e))return null;e=mt(e)}return null}(t)||n}const Ut={convertOffsetParentRelativeRectToViewportRelativeRect:function(t){let{elements:e,rect:n,offsetParent:o,strategy:i}=t;const l="fixed"===i,r=X(o),s=!!e&&lt(e.floating);if(o===r||s&&l)return n;let a={scrollLeft:0,scrollTop:0},c=y(1);const h=y(0),f=Q(o);if((f||!f&&!l)&&(("body"!==K(o)||et(r))&&(a=pt(o)),Q(o))){const t=Ot(o);c=xt(o),h.x=t.x+o.clientLeft,h.y=t.y+o.clientTop}const d=!r||f||l?y(0):Tt(r,a);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-a.scrollLeft*c.x+h.x+d.x,y:n.y*c.y-a.scrollTop*c.y+h.y+d.y}},getDocumentElement:X,getClippingRect:function(t){let{element:e,boundary:n,rootBoundary:o,strategy:i}=t;const l=[..."clippingAncestors"===n?lt(e)?[]:function(t,e){const n=e.get(t);if(n)return n;let o=wt(t,[]).filter(t=>G(t)&&"body"!==K(t)),i=null;const l="fixed"===ut(t).position;let r=l?mt(t):t;for(;G(r)&&!dt(r);){const e=ut(r),n=ct(r);n||"fixed"!==e.position||(i=null),(l?!n&&!i:!n&&"static"===e.position&&i&&Dt.has(i.position)||et(r)&&!n&&Et(t,r))?o=o.filter(t=>t!==r):i=e,r=mt(r)}return e.set(t,o),o}(e,this._c):[].concat(n),o],r=l[0],s=l.reduce((t,n)=>{const o=$t(e,n,i);return t.top=g(o.top,t.top),t.right=m(o.right,t.right),t.bottom=m(o.bottom,t.bottom),t.left=g(o.left,t.left),t},$t(e,r,i));return{width:s.right-s.left,height:s.bottom-s.top,x:s.left,y:s.top}},getOffsetParent:It,getElementRects:async function(t){const e=this.getOffsetParent||It,n=this.getDimensions,o=await n(t.floating);return{reference:At(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:o.width,height:o.height}}},getClientRects:function(t){return Array.from(t.getClientRects())},getDimensions:function(t){const{width:e,height:n}=vt(t);return{width:e,height:n}},getScale:xt,isElement:G,isRTL:function(t){return"rtl"===ut(t).direction}},Mt=function(t){return void 0===t&&(t=0),{name:"offset",options:t,async fn(e){var n,o;const{x:i,y:l,placement:r,middlewareData:s}=e,a=await async function(t,e){const{placement:n,platform:o,elements:i}=t,l=await(null==o.isRTL?void 0:o.isRTL(i.floating)),r=R(n),s=O(n),a="y"===$(n),c=q.has(r)?-1:1,h=l&&a?-1:1,f=C(e,t);let{mainAxis:d,crossAxis:u,alignmentAxis:p}="number"==typeof f?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:f.mainAxis||0,crossAxis:f.crossAxis||0,alignmentAxis:f.alignmentAxis};return s&&"number"==typeof p&&(u="end"===s?-1*p:p),a?{x:u*h,y:d*c}:{x:d*c,y:u*h}}(e,t);return r===(null==(n=s.offset)?void 0:n.placement)&&null!=(o=s.arrow)&&o.alignmentOffset?{}:{x:i+a.x,y:l+a.y,data:{...a,placement:r}}}}},zt=function(t){return void 0===t&&(t={}),{name:"autoPlacement",options:t,async fn(e){var n,o,i;const{rects:l,middlewareData:r,placement:s,platform:a,elements:c}=e,{crossAxis:h=!1,alignment:f,allowedPlacements:d=p,autoAlignment:u=!0,...m}=C(t,e),g=void 0!==f||d===p?function(t,e,n){return(t?[...n.filter(e=>O(e)===t),...n.filter(e=>O(e)!==t)]:n.filter(t=>R(t)===t)).filter(n=>!t||O(n)===t||!!e&&L(n)!==n)}(f||null,u,d):d,w=await a.detectOverflow(e,m),y=(null==(n=r.autoPlacement)?void 0:n.index)||0,v=g[y];if(null==v)return{};const b=A(v,l,await(null==a.isRTL?void 0:a.isRTL(c.floating)));if(s!==v)return{reset:{placement:g[0]}};const x=[w[R(v)],w[b[0]],w[b[1]]],S=[...(null==(o=r.autoPlacement)?void 0:o.overflows)||[],{placement:v,overflows:x}],T=g[y+1];if(T)return{data:{index:y+1,overflows:S},reset:{placement:T}};const D=S.map(t=>{const e=O(t.placement);return[t.placement,e&&h?t.overflows.slice(0,2).reduce((t,e)=>t+e,0):t.overflows[0],t.overflows]}).sort((t,e)=>t[1]-e[1]),$=(null==(i=D.filter(t=>t[2].slice(0,O(t[0])?2:3).every(t=>t<=0))[0])?void 0:i[0])||D[0][0];return $!==s?{data:{index:y+1,overflows:S},reset:{placement:$}}:{}}}},Pt=function(t){return void 0===t&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:o,placement:i,platform:l}=e,{mainAxis:r=!0,crossAxis:s=!1,limiter:a={fn:t=>{let{x:e,y:n}=t;return{x:e,y:n}}},...c}=C(t,e),h={x:n,y:o},f=await l.detectOverflow(e,c),d=$(R(i)),u=S(d);let p=h[u],m=h[d];if(r){const t="y"===u?"bottom":"right";p=x(p+f["y"===u?"top":"left"],p,p-f[t])}if(s){const t="y"===d?"bottom":"right";m=x(m+f["y"===d?"top":"left"],m,m-f[t])}const g=a.fn({...e,[u]:p,[d]:m});return{...g,data:{x:g.x-n,y:g.y-o,enabled:{[u]:r,[d]:s}}}}}},Bt=function(t){return void 0===t&&(t={}),{name:"flip",options:t,async fn(e){var n,o;const{placement:i,middlewareData:l,rects:r,initialPlacement:s,platform:a,elements:c}=e,{mainAxis:h=!0,crossAxis:f=!0,fallbackPlacements:d,fallbackStrategy:u="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:m=!0,...g}=C(t,e);if(null!=(n=l.arrow)&&n.alignmentOffset)return{};const w=R(i),y=$(s),v=R(s)===s,b=await(null==a.isRTL?void 0:a.isRTL(c.floating)),x=d||(v||!m?[P(s)]:function(t){const e=P(t);return[L(t),e,L(e)]}(s)),O="none"!==p;!d&&O&&x.push(...z(s,m,p,b));const S=[s,...x],T=await a.detectOverflow(e,g),D=[];let E=(null==(o=l.flip)?void 0:o.overflows)||[];if(h&&D.push(T[w]),f){const t=A(i,r,b);D.push(T[t[0]],T[t[1]])}if(E=[...E,{placement:i,overflows:D}],!D.every(t=>t<=0)){var H,I;const t=((null==(H=l.flip)?void 0:H.index)||0)+1,e=S[t];if(e){if(!("alignment"===f&&y!==$(e))||E.every(t=>$(t.placement)!==y||t.overflows[0]>0))return{data:{index:t,overflows:E},reset:{placement:e}}}let n=null==(I=E.filter(t=>t.overflows[0]<=0).sort((t,e)=>t.overflows[1]-e.overflows[1])[0])?void 0:I.placement;if(!n)switch(u){case"bestFit":{var U;const t=null==(U=E.filter(t=>{if(O){const e=$(t.placement);return e===y||"y"===e}return!0}).map(t=>[t.placement,t.overflows.filter(t=>t>0).reduce((t,e)=>t+e,0)]).sort((t,e)=>t[1]-e[1])[0])?void 0:U[0];t&&(n=t);break}case"initialPlacement":n=s}if(i!==n)return{reset:{placement:n}}}return{}}}},kt=function(t){return void 0===t&&(t={}),{name:"size",options:t,async fn(e){var n,o;const{placement:i,rects:l,platform:r,elements:s}=e,{apply:a=()=>{},...c}=C(t,e),h=await r.detectOverflow(e,c),f=R(i),d=O(i),u="y"===$(i),{width:p,height:w}=l.floating;let y,v;"top"===f||"bottom"===f?(y=f,v=d===(await(null==r.isRTL?void 0:r.isRTL(s.floating))?"start":"end")?"left":"right"):(v=f,y="end"===d?"top":"bottom");const b=w-h.top-h.bottom,x=p-h.left-h.right,S=m(w-h[y],b),T=m(p-h[v],x),D=!e.middlewareData.shift;let E=S,A=T;if(null!=(n=e.middlewareData.shift)&&n.enabled.x&&(A=x),null!=(o=e.middlewareData.shift)&&o.enabled.y&&(E=b),D&&!d){const t=g(h.left,0),e=g(h.right,0),n=g(h.top,0),o=g(h.bottom,0);u?A=p-2*(0!==t||0!==e?t+e:g(h.left,h.right)):E=w-2*(0!==n||0!==o?n+o:g(h.top,h.bottom))}await a({...e,availableWidth:A,availableHeight:E});const L=await r.getDimensions(s.floating);return p!==L.width||w!==L.height?{reset:{rects:!0}}:{}}}},Vt=function(t){return void 0===t&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n,platform:o}=e,{strategy:i="referenceHidden",...l}=C(t,e);switch(i){case"referenceHidden":{const t=F(await o.detectOverflow(e,{...l,elementContext:"reference"}),n.reference);return{data:{referenceHiddenOffsets:t,referenceHidden:W(t)}}}case"escaped":{const t=F(await o.detectOverflow(e,{...l,altBoundary:!0}),n.floating);return{data:{escapedOffsets:t,escaped:W(t)}}}default:return{}}}}},Nt=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:o,placement:i,rects:l,platform:r,elements:s,middlewareData:a}=e,{element:c,padding:h=0}=C(t,e)||{};if(null==c)return{};const f=B(h),d={x:n,y:o},u=E(i),p=T(u),g=await r.getDimensions(c),w="y"===u,y=w?"top":"left",v=w?"bottom":"right",b=w?"clientHeight":"clientWidth",R=l.reference[p]+l.reference[u]-d[u]-l.floating[p],S=d[u]-l.reference[u],D=await(null==r.getOffsetParent?void 0:r.getOffsetParent(c));let $=D?D[b]:0;$&&await(null==r.isElement?void 0:r.isElement(D))||($=s.floating[b]||l.floating[p]);const A=R/2-S/2,L=$/2-g[p]/2-1,H=m(f[y],L),I=m(f[v],L),U=H,M=$-g[p]-I,z=$/2-g[p]/2+A,P=x(U,z,M),k=!a.arrow&&null!=O(i)&&z!==P&&l.reference[p]/2-(z<U?H:I)-g[p]/2<0,V=k?z<U?z-U:z-M:0;return{[u]:d[u]+V,data:{[u]:P,centerOffset:z-P-V,...k&&{alignmentOffset:V}},reset:k}}}),Ft=function(t){return void 0===t&&(t={}),{name:"inline",options:t,async fn(e){const{placement:n,elements:o,rects:i,platform:l,strategy:r}=e,{padding:s=2,x:a,y:c}=C(t,e),h=Array.from(await(null==l.getClientRects?void 0:l.getClientRects(o.reference))||[]),f=function(t){const e=t.slice().sort((t,e)=>t.y-e.y),n=[];let o=null;for(let i=0;i<e.length;i++){const t=e[i];!o||t.y-o.y>o.height/2?n.push([t]):n[n.length-1].push(t),o=t}return n.map(t=>k(_(t)))}(h),d=k(_(h)),u=B(s);const p=await l.getElementRects({reference:{getBoundingClientRect:function(){if(2===f.length&&f[0].left>f[1].right&&null!=a&&null!=c)return f.find(t=>a>t.left-u.left&&a<t.right+u.right&&c>t.top-u.top&&c<t.bottom+u.bottom)||d;if(f.length>=2){if("y"===$(n)){const t=f[0],e=f[f.length-1],o="top"===R(n),i=t.top,l=e.bottom,r=o?t.left:e.left,s=o?t.right:e.right;return{top:i,bottom:l,left:r,right:s,width:s-r,height:l-i,x:r,y:i}}const t="left"===R(n),e=g(...f.map(t=>t.right)),o=m(...f.map(t=>t.left)),i=f.filter(n=>t?n.left===o:n.right===e),l=i[0].top,r=i[i.length-1].bottom;return{top:l,bottom:r,left:o,right:e,width:e-o,height:r-l,x:o,y:l}}return d}},floating:o.floating,strategy:r});return i.reference.x!==p.reference.x||i.reference.y!==p.reference.y||i.reference.width!==p.reference.width||i.reference.height!==p.reference.height?{reset:{rects:p}}:{}}}},Wt=(t,e,n)=>{const o=/* @__PURE__ */new Map,i={platform:Ut,...n},l={...i.platform,_c:o};return(async(t,e,n)=>{const{placement:o="bottom",strategy:i="absolute",middleware:l=[],platform:r}=n,s=l.filter(Boolean),a=await(null==r.isRTL?void 0:r.isRTL(e));let c=await r.getElementRects({reference:t,floating:e,strategy:i}),{x:h,y:f}=V(c,o,a),d=o,u={},p=0;for(let g=0;g<s.length;g++){var m;const{name:n,fn:l}=s[g],{x:w,y:y,data:v,reset:b}=await l({x:h,y:f,initialPlacement:o,placement:d,strategy:i,middlewareData:u,rects:c,platform:{...r,detectOverflow:null!=(m=r.detectOverflow)?m:N},elements:{reference:t,floating:e}});h=null!=w?w:h,f=null!=y?y:f,u={...u,[n]:{...u[n],...v}},b&&p<=50&&(p++,"object"==typeof b&&(b.placement&&(d=b.placement),b.rects&&(c=!0===b.rects?await r.getElementRects({reference:t,floating:e,strategy:i}):b.rects),({x:h,y:f}=V(c,d,a))),g=-1)}return{x:h,y:f,placement:d,strategy:i,middlewareData:u}})(t,e,{...i,platform:l})};let _t,qt;if("undefined"!=typeof WeakMap){let t=/* @__PURE__ */new WeakMap;_t=e=>t.get(e),qt=(e,n)=>(t.set(e,n),n)}else{const t=[],e=10;let n=0;_t=e=>{for(let n=0;n<t.length;n+=2)if(t[n]==e)return t[n+1]},qt=(o,i)=>(n==e&&(n=0),t[n++]=o,t[n++]=i)}var jt=class{constructor(t,e,n,o){this.width=t,this.height=e,this.map=n,this.problems=o}findCell(t){for(let e=0;e<this.map.length;e++){const n=this.map[e];if(n!=t)continue;const o=e%this.width,i=e/this.width|0;let l=o+1,r=i+1;for(let t=1;l<this.width&&this.map[e+t]==n;t++)l++;for(let t=1;r<this.height&&this.map[e+this.width*t]==n;t++)r++;return{left:o,top:i,right:l,bottom:r}}throw new RangeError(`No cell with offset ${t} found`)}colCount(t){for(let e=0;e<this.map.length;e++)if(this.map[e]==t)return e%this.width;throw new RangeError(`No cell with offset ${t} found`)}nextCell(t,e,n){const{left:o,right:i,top:l,bottom:r}=this.findCell(t);return"horiz"==e?(n<0?0==o:i==this.width)?null:this.map[l*this.width+(n<0?o-1:i)]:(n<0?0==l:r==this.height)?null:this.map[o+this.width*(n<0?l-1:r)]}rectBetween(t,e){const{left:n,right:o,top:i,bottom:l}=this.findCell(t),{left:r,right:s,top:a,bottom:c}=this.findCell(e);return{left:Math.min(n,r),top:Math.min(i,a),right:Math.max(o,s),bottom:Math.max(l,c)}}cellsInRect(t){const e=[],n={};for(let o=t.top;o<t.bottom;o++)for(let i=t.left;i<t.right;i++){const l=o*this.width+i,r=this.map[l];n[r]||(n[r]=!0,i==t.left&&i&&this.map[l-1]==r||o==t.top&&o&&this.map[l-this.width]==r||e.push(r))}return e}positionAt(t,e,n){for(let o=0,i=0;;o++){const l=i+n.child(o).nodeSize;if(o==t){let n=e+t*this.width;const o=(t+1)*this.width;for(;n<o&&this.map[n]<i;)n++;return n==o?l-1:this.map[n]}i=l}}static get(t){return _t(t)||qt(t,function(t){if("table"!=t.type.spec.tableRole)throw new RangeError("Not a table node: "+t.type.name);const e=function(t){let e=-1,n=!1;for(let o=0;o<t.childCount;o++){const i=t.child(o);let l=0;if(n)for(let e=0;e<o;e++){const n=t.child(e);for(let t=0;t<n.childCount;t++){const i=n.child(t);e+i.attrs.rowspan>o&&(l+=i.attrs.colspan)}}for(let t=0;t<i.childCount;t++){const e=i.child(t);l+=e.attrs.colspan,e.attrs.rowspan>1&&(n=!0)}-1==e?e=l:e!=l&&(e=Math.max(e,l))}return e}(t),n=t.childCount,o=[];let i=0,l=null;const r=[];for(let c=0,h=e*n;c<h;c++)o[c]=0;for(let c=0,h=0;c<n;c++){const s=t.child(c);h++;for(let t=0;;t++){for(;i<o.length&&0!=o[i];)i++;if(t==s.childCount)break;const a=s.child(t),{colspan:f,rowspan:d,colwidth:u}=a.attrs;for(let t=0;t<d;t++){if(t+c>=n){(l||(l=[])).push({type:"overlong_rowspan",pos:h,n:d-t});break}const s=i+t*e;for(let t=0;t<f;t++){0==o[s+t]?o[s+t]=h:(l||(l=[])).push({type:"collision",row:c,pos:h,n:f-t});const n=u&&u[t];if(n){const o=(s+t)%e*2,i=r[o];null==i||i!=n&&1==r[o+1]?(r[o]=n,r[o+1]=1):i==n&&r[o+1]++}}}i+=f,h+=a.nodeSize}const a=(c+1)*e;let f=0;for(;i<a;)0==o[i++]&&f++;f&&(l||(l=[])).push({type:"missing",row:c,n:f}),h++}0!==e&&0!==n||(l||(l=[])).push({type:"zero_sized"});const s=new jt(e,n,o,l);let a=!1;for(let c=0;!a&&c<r.length;c+=2)null!=r[c]&&r[c+1]<n&&(a=!0);a&&function(t,e,n){t.problems||(t.problems=[]);const o={};for(let i=0;i<t.map.length;i++){const l=t.map[i];if(o[l])continue;o[l]=!0;const r=n.nodeAt(l);if(!r)throw new RangeError(`No cell with offset ${l} found`);let s=null;const a=r.attrs;for(let n=0;n<a.colspan;n++){const o=e[(i+n)%t.width*2];null==o||a.colwidth&&a.colwidth[n]==o||((s||(s=Kt(a)))[n]=o)}s&&t.problems.unshift({type:"colwidth mismatch",pos:l,colwidth:s})}}(s,r,t);return s}(t))}};function Kt(t){if(t.colwidth)return t.colwidth.slice();const e=[];for(let n=0;n<t.colspan;n++)e.push(0);return e}function Jt(t){let e=t.cached.tableNodeTypes;if(!e){e=t.cached.tableNodeTypes={};for(const n in t.nodes){const o=t.nodes[n],i=o.spec.tableRole;i&&(e[i]=o)}}return e}function Xt(t){const e=t.selection.$head;for(let n=e.depth;n>0;n--)if("row"==e.node(n).type.spec.tableRole)return!0;return!1}function Yt(t){return"row"==t.parent.type.spec.tableRole&&!!t.nodeAfter}function Gt(t,e){return t.depth==e.depth&&t.pos>=e.start(-1)&&t.pos<=e.end(-1)}function Qt(t,e,n){const o=t.node(-1),i=jt.get(o),l=t.start(-1),r=i.nextCell(t.pos-l,e,n);return null==r?null:t.node(0).resolve(l+r)}function Zt(t,e,n=1){const o={...t,colspan:t.colspan-n};return o.colwidth&&(o.colwidth=o.colwidth.slice(),o.colwidth.splice(e,n),o.colwidth.some(t=>t>0)||(o.colwidth=null)),o}new c("selectingCells");var te=class t extends i{constructor(t,e=t){const n=t.node(-1),o=jt.get(n),i=t.start(-1),r=o.rectBetween(t.pos-i,e.pos-i),s=t.node(0),a=o.cellsInRect(r).filter(t=>t!=e.pos-i);a.unshift(e.pos-i);const c=a.map(t=>{const e=n.nodeAt(t);if(!e)throw new RangeError(`No cell with offset ${t} found`);const o=i+t+1;return new l(s.resolve(o),s.resolve(o+e.content.size))});super(c[0].$from,c[0].$to,c),this.$anchorCell=t,this.$headCell=e}map(e,n){const o=e.resolve(n.map(this.$anchorCell.pos)),i=e.resolve(n.map(this.$headCell.pos));if(Yt(o)&&Yt(i)&&Gt(o,i)){const e=this.$anchorCell.node(-1)!=o.node(-1);return e&&this.isRowSelection()?t.rowSelection(o,i):e&&this.isColSelection()?t.colSelection(o,i):new t(o,i)}return r.between(o,i)}content(){const t=this.$anchorCell.node(-1),e=jt.get(t),n=this.$anchorCell.start(-1),o=e.rectBetween(this.$anchorCell.pos-n,this.$headCell.pos-n),i={},l=[];for(let a=o.top;a<o.bottom;a++){const n=[];for(let l=a*e.width+o.left,r=o.left;r<o.right;r++,l++){const r=e.map[l];if(i[r])continue;i[r]=!0;const s=e.findCell(r);let a=t.nodeAt(r);if(!a)throw new RangeError(`No cell with offset ${r} found`);const c=o.left-s.left,h=s.right-o.right;if(c>0||h>0){let t=a.attrs;if(c>0&&(t=Zt(t,0,c)),h>0&&(t=Zt(t,t.colspan-h,h)),s.left<o.left){if(a=a.type.createAndFill(t),!a)throw new RangeError(`Could not create cell with attrs ${JSON.stringify(t)}`)}else a=a.type.create(t,a.content)}if(s.top<o.top||s.bottom>o.bottom){const t={...a.attrs,rowspan:Math.min(s.bottom,o.bottom)-Math.max(s.top,o.top)};a=s.top<o.top?a.type.createAndFill(t):a.type.create(t,a.content)}n.push(a)}l.push(t.child(a).copy(s.from(n)))}const r=this.isColSelection()&&this.isRowSelection()?t:l;return new a(s.from(r),1,1)}replace(t,e=a.empty){const n=t.steps.length,o=this.ranges;for(let i=0;i<o.length;i++){const{$from:l,$to:r}=o[i],s=t.mapping.slice(n);t.replace(s.map(l.pos),s.map(r.pos),i?a.empty:e)}const l=i.findFrom(t.doc.resolve(t.mapping.slice(n).map(this.to)),-1);l&&t.setSelection(l)}replaceWith(t,e){this.replace(t,new a(s.from(e),0,0))}forEachCell(t){const e=this.$anchorCell.node(-1),n=jt.get(e),o=this.$anchorCell.start(-1),i=n.cellsInRect(n.rectBetween(this.$anchorCell.pos-o,this.$headCell.pos-o));for(let l=0;l<i.length;l++)t(e.nodeAt(i[l]),o+i[l])}isColSelection(){const t=this.$anchorCell.index(-1),e=this.$headCell.index(-1);if(Math.min(t,e)>0)return!1;const n=t+this.$anchorCell.nodeAfter.attrs.rowspan,o=e+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(n,o)==this.$headCell.node(-1).childCount}static colSelection(e,n=e){const o=e.node(-1),i=jt.get(o),l=e.start(-1),r=i.findCell(e.pos-l),s=i.findCell(n.pos-l),a=e.node(0);return r.top<=s.top?(r.top>0&&(e=a.resolve(l+i.map[r.left])),s.bottom<i.height&&(n=a.resolve(l+i.map[i.width*(i.height-1)+s.right-1]))):(s.top>0&&(n=a.resolve(l+i.map[s.left])),r.bottom<i.height&&(e=a.resolve(l+i.map[i.width*(i.height-1)+r.right-1]))),new t(e,n)}isRowSelection(){const t=this.$anchorCell.node(-1),e=jt.get(t),n=this.$anchorCell.start(-1),o=e.colCount(this.$anchorCell.pos-n),i=e.colCount(this.$headCell.pos-n);if(Math.min(o,i)>0)return!1;const l=o+this.$anchorCell.nodeAfter.attrs.colspan,r=i+this.$headCell.nodeAfter.attrs.colspan;return Math.max(l,r)==e.width}eq(e){return e instanceof t&&e.$anchorCell.pos==this.$anchorCell.pos&&e.$headCell.pos==this.$headCell.pos}static rowSelection(e,n=e){const o=e.node(-1),i=jt.get(o),l=e.start(-1),r=i.findCell(e.pos-l),s=i.findCell(n.pos-l),a=e.node(0);return r.left<=s.left?(r.left>0&&(e=a.resolve(l+i.map[r.top*i.width])),s.right<i.width&&(n=a.resolve(l+i.map[i.width*(s.top+1)-1]))):(s.left>0&&(n=a.resolve(l+i.map[s.top*i.width])),r.right<i.width&&(e=a.resolve(l+i.map[i.width*(r.top+1)-1]))),new t(e,n)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(e,n){return new t(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,o=n){return new t(e.resolve(n),e.resolve(o))}getBookmark(){return new ee(this.$anchorCell.pos,this.$headCell.pos)}};te.prototype.visible=!1,i.jsonID("cell",te);var ee=class t{constructor(t,e){this.anchor=t,this.head=e}map(e){return new t(e.map(this.anchor),e.map(this.head))}resolve(t){const e=t.resolve(this.anchor),n=t.resolve(this.head);return"row"==e.parent.type.spec.tableRole&&"row"==n.parent.type.spec.tableRole&&e.index()<e.parent.childCount&&n.index()<n.parent.childCount&&Gt(e,n)?new te(e,n):i.near(n,1)}};function ne(t){const e=t.selection,n=function(t){const e=t.selection;if("$anchorCell"in e&&e.$anchorCell)return e.$anchorCell.pos>e.$headCell.pos?e.$anchorCell:e.$headCell;if("node"in e&&e.node&&"cell"==e.node.type.spec.tableRole)return e.$anchor;const n=function(t){for(let e=t.depth-1;e>0;e--)if("row"==t.node(e).type.spec.tableRole)return t.node(0).resolve(t.before(e+1));return null}(e.$head)||function(t){for(let e=t.nodeAfter,n=t.pos;e;e=e.firstChild,n++){const o=e.type.spec.tableRole;if("cell"==o||"header_cell"==o)return t.doc.resolve(n)}for(let e=t.nodeBefore,n=t.pos;e;e=e.lastChild,n--){const o=e.type.spec.tableRole;if("cell"==o||"header_cell"==o)return t.doc.resolve(n-e.nodeSize)}}(e.$head);if(n)return n;throw new RangeError(`No cell found around position ${e.head}`)}(t),o=n.node(-1),i=n.start(-1),l=jt.get(o);return{...e instanceof te?l.rectBetween(e.$anchorCell.pos-i,e.$headCell.pos-i):l.findCell(n.pos-i),tableStart:i,map:l,table:o}}function oe(t,e,n){const o=e.map.cellsInRect({left:0,top:0,right:"row"==t?e.map.width:1,bottom:"column"==t?e.map.height:1});for(let i=0;i<o.length;i++){const t=e.table.nodeAt(o[i]);if(t&&t.type!==n.header_cell)return!1}return!0}function ie(t,e){return(e=e||{useDeprecatedLogic:!1}).useDeprecatedLogic?function(t){return function(e,n){if(!Xt(e))return!1;if(n){const o=Jt(e.schema),i=ne(e),l=e.tr,r=i.map.cellsInRect("column"==t?{left:i.left,top:0,right:i.right,bottom:i.map.height}:"row"==t?{left:0,top:i.top,right:i.map.width,bottom:i.bottom}:i),s=r.map(t=>i.table.nodeAt(t));for(let t=0;t<r.length;t++)s[t].type==o.header_cell&&l.setNodeMarkup(i.tableStart+r[t],o.cell,s[t].attrs);if(0===l.steps.length)for(let t=0;t<r.length;t++)l.setNodeMarkup(i.tableStart+r[t],o.header_cell,s[t].attrs);n(l)}return!0}}(t):function(e,n){if(!Xt(e))return!1;if(n){const o=Jt(e.schema),i=ne(e),l=e.tr,r=oe("row",i,o),s=oe("column",i,o),a=("column"===t?r:"row"===t&&s)?1:0,c="column"==t?{left:0,top:a,right:1,bottom:i.map.height}:"row"==t?{left:a,top:0,right:i.map.width,bottom:1}:i,h="column"==t?s?o.cell:o.header_cell:"row"==t?r?o.cell:o.header_cell:o.cell;i.map.cellsInRect(c).forEach(t=>{const e=t+i.tableStart,n=l.doc.nodeAt(e);n&&l.setNodeMarkup(e,h,n.attrs)}),n(l)}return!0}}function le(t,e){const n=t.selection;if(!(n instanceof te))return!1;if(e){const o=t.tr,i=Jt(t.schema).cell.createAndFill().content;n.forEachCell((t,e)=>{t.content.eq(i)||o.replace(o.mapping.map(e+1),o.mapping.map(e+t.nodeSize-1),new a(i,0,0))}),o.docChanged&&e(o)}return!0}function re(t,e,n){return!n.eq(t.selection)&&(e&&e(t.tr.setSelection(n).scrollIntoView()),!0)}function se(t,e){return(n,o,l)=>{if(!l)return!1;const r=n.selection;if(r instanceof te)return re(n,o,i.near(r.$headCell,e));if("horiz"!=t&&!r.empty)return!1;const s=ce(l,t,e);if(null==s)return!1;if("horiz"==t)return re(n,o,i.near(n.doc.resolve(r.head+e),e));{const l=n.doc.resolve(s),r=Qt(l,t,e);let a;return a=r?i.near(r,1):e<0?i.near(n.doc.resolve(l.before(-1)),-1):i.near(n.doc.resolve(l.after(-1)),1),re(n,o,a)}}}function ae(t,e){return(n,o,i)=>{if(!i)return!1;const l=n.selection;let r;if(l instanceof te)r=l;else{const o=ce(i,t,e);if(null==o)return!1;r=new te(n.doc.resolve(o))}const s=Qt(r.$headCell,t,e);return!!s&&re(n,o,new te(r.$anchorCell,s))}}function ce(t,e,n){if(!(t.state.selection instanceof r))return null;const{$head:o}=t.state.selection;for(let i=o.depth-1;i>=0;i--){const l=o.node(i);if((n<0?o.index(i):o.indexAfter(i))!=(n<0?0:l.childCount))return null;if("cell"==l.type.spec.tableRole||"header_cell"==l.type.spec.tableRole){const l=o.before(i),r="vert"==e?n>0?"down":"up":n>0?"right":"left";return t.endOfTextblock(r)?l:null}}return null}new c("fix-tables"),ie("row",{useDeprecatedLogic:!0}),ie("column",{useDeprecatedLogic:!0}),ie("cell",{useDeprecatedLogic:!0}),t({ArrowLeft:se("horiz",-1),ArrowRight:se("horiz",1),ArrowUp:se("vert",-1),ArrowDown:se("vert",1),"Shift-ArrowLeft":ae("horiz",-1),"Shift-ArrowRight":ae("horiz",1),"Shift-ArrowUp":ae("vert",-1),"Shift-ArrowDown":ae("vert",1),Backspace:le,"Mod-Backspace":le,Delete:le,"Mod-Delete":le}),new c("tableColumnResizing");var he=class{constructor({editor:t,element:e,view:o,updateDelay:i=250,resizeDelay:l=60,shouldShow:r,appendTo:s,getReferencedVirtualElement:a,options:c}){var h;this.preventHide=!1,this.isVisible=!1,this.scrollTarget=window,this.floatingUIOptions={strategy:"absolute",placement:"top",offset:8,flip:{},shift:{},arrow:!1,size:!1,autoPlacement:!1,hide:!1,inline:!1,onShow:void 0,onHide:void 0,onUpdate:void 0,onDestroy:void 0},this.shouldShow=({view:t,state:e,from:o,to:i})=>{const{doc:l,selection:r}=e,{empty:s}=r,a=!l.textBetween(o,i).length&&n(e.selection),c=this.element.contains(document.activeElement);return!(!t.hasFocus()&&!c||s||a||!this.editor.isEditable)},this.mousedownHandler=()=>{this.preventHide=!0},this.dragstartHandler=()=>{this.hide()},this.resizeHandler=()=>{this.resizeDebounceTimer&&clearTimeout(this.resizeDebounceTimer),this.resizeDebounceTimer=window.setTimeout(()=>{this.updatePosition()},this.resizeDelay)},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:t})=>{var e;this.editor.isDestroyed?this.destroy():this.preventHide?this.preventHide=!1:(null==t?void 0:t.relatedTarget)&&(null==(e=this.element.parentNode)?void 0:e.contains(t.relatedTarget))||(null==t?void 0:t.relatedTarget)!==this.editor.view.dom&&this.hide()},this.handleDebouncedUpdate=(t,e)=>{const n=!(null==e?void 0:e.selection.eq(t.state.selection)),o=!(null==e?void 0:e.doc.eq(t.state.doc));(n||o)&&(this.updateDebounceTimer&&clearTimeout(this.updateDebounceTimer),this.updateDebounceTimer=window.setTimeout(()=>{this.updateHandler(t,n,o,e)},this.updateDelay))},this.updateHandler=(t,e,n,o)=>{const{composing:i}=t;if(i||!e&&!n)return;this.getShouldShow(o)?(this.updatePosition(),this.show()):this.hide()},this.transactionHandler=({transaction:t})=>{const e=t.getMeta("bubbleMenu");"updatePosition"===e?this.updatePosition():e&&"object"==typeof e&&"updateOptions"===e.type&&this.updateOptions(e.options)},this.editor=t,this.element=e,this.view=o,this.updateDelay=i,this.resizeDelay=l,this.appendTo=s,this.scrollTarget=null!=(h=null==c?void 0:c.scrollTarget)?h:window,this.getReferencedVirtualElement=a,this.floatingUIOptions={...this.floatingUIOptions,...c},this.element.tabIndex=0,r&&(this.shouldShow=r),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.addEventListener("dragstart",this.dragstartHandler),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.editor.on("transaction",this.transactionHandler),window.addEventListener("resize",this.resizeHandler),this.scrollTarget.addEventListener("scroll",this.resizeHandler),this.update(o,o.state),this.getShouldShow()&&(this.show(),this.updatePosition())}get middlewares(){const t=[];return this.floatingUIOptions.flip&&t.push(Bt("boolean"!=typeof this.floatingUIOptions.flip?this.floatingUIOptions.flip:void 0)),this.floatingUIOptions.shift&&t.push(Pt("boolean"!=typeof this.floatingUIOptions.shift?this.floatingUIOptions.shift:void 0)),this.floatingUIOptions.offset&&t.push(Mt("boolean"!=typeof this.floatingUIOptions.offset?this.floatingUIOptions.offset:void 0)),this.floatingUIOptions.arrow&&t.push(Nt(this.floatingUIOptions.arrow)),this.floatingUIOptions.size&&t.push(kt("boolean"!=typeof this.floatingUIOptions.size?this.floatingUIOptions.size:void 0)),this.floatingUIOptions.autoPlacement&&t.push(zt("boolean"!=typeof this.floatingUIOptions.autoPlacement?this.floatingUIOptions.autoPlacement:void 0)),this.floatingUIOptions.hide&&t.push(Vt("boolean"!=typeof this.floatingUIOptions.hide?this.floatingUIOptions.hide:void 0)),this.floatingUIOptions.inline&&t.push(Ft("boolean"!=typeof this.floatingUIOptions.inline?this.floatingUIOptions.inline:void 0)),t}get virtualElement(){var t,e,n;const{selection:i}=this.editor.state,l=null==(t=this.getReferencedVirtualElement)?void 0:t.call(this);if(l)return l;if(!(null==(n=null==(e=this.view)?void 0:e.dom)?void 0:n.parentNode))return;const r=o(this.view,i.from,i.to);let s={getBoundingClientRect:()=>r,getClientRects:()=>[r]};if(i instanceof f){let t=this.view.nodeDOM(i.from);const e=t.dataset.nodeViewWrapper?t:t.querySelector("[data-node-view-wrapper]");e&&(t=e),t&&(s={getBoundingClientRect:()=>t.getBoundingClientRect(),getClientRects:()=>[t.getBoundingClientRect()]})}if(i instanceof te){const{$anchorCell:t,$headCell:e}=i,n=t?t.pos:e.pos,o=e?e.pos:t.pos,l=this.view.nodeDOM(n),r=this.view.nodeDOM(o);if(!l||!r)return;const a=l===r?l.getBoundingClientRect():function(t,e){const n=Math.min(t.top,e.top),o=Math.max(t.bottom,e.bottom),i=Math.min(t.left,e.left),l=Math.max(t.right,e.right);return new DOMRect(i,n,l-i,o-n)}(l.getBoundingClientRect(),r.getBoundingClientRect());s={getBoundingClientRect:()=>a,getClientRects:()=>[a]}}return s}updatePosition(){const t=this.virtualElement;t&&Wt(t,this.element,{placement:this.floatingUIOptions.placement,strategy:this.floatingUIOptions.strategy,middleware:this.middlewares}).then(({x:t,y:e,strategy:n,middlewareData:o})=>{var i,l;(null==(i=o.hide)?void 0:i.referenceHidden)||(null==(l=o.hide)?void 0:l.escaped)?this.element.style.visibility="hidden":(this.element.style.visibility="visible",this.element.style.width="max-content",this.element.style.position=n,this.element.style.left=`${t}px`,this.element.style.top=`${e}px`,this.isVisible&&this.floatingUIOptions.onUpdate&&this.floatingUIOptions.onUpdate())})}update(t,e){const{state:n}=t,o=n.selection.from!==n.selection.to;if(this.updateDelay>0&&o)return void this.handleDebouncedUpdate(t,e);const i=!(null==e?void 0:e.selection.eq(t.state.selection)),l=!(null==e?void 0:e.doc.eq(t.state.doc));this.updateHandler(t,i,l,e)}getShouldShow(t){var e;const{state:n}=this.view,{selection:o}=n,{ranges:i}=o,l=Math.min(...i.map(t=>t.$from.pos)),r=Math.max(...i.map(t=>t.$to.pos));return(null==(e=this.shouldShow)?void 0:e.call(this,{editor:this.editor,element:this.element,view:this.view,state:n,oldState:t,from:l,to:r}))||!1}show(){var t;if(this.isVisible)return;this.element.style.visibility="visible",this.element.style.opacity="1";const e="function"==typeof this.appendTo?this.appendTo():this.appendTo;null==(t=null!=e?e:this.view.dom.parentElement)||t.appendChild(this.element),this.floatingUIOptions.onShow&&this.floatingUIOptions.onShow(),this.isVisible=!0}hide(){this.isVisible&&(this.element.style.visibility="hidden",this.element.style.opacity="0",this.element.remove(),this.floatingUIOptions.onHide&&this.floatingUIOptions.onHide(),this.isVisible=!1)}updateOptions(t){var e;if(void 0!==t.updateDelay&&(this.updateDelay=t.updateDelay),void 0!==t.resizeDelay&&(this.resizeDelay=t.resizeDelay),void 0!==t.appendTo&&(this.appendTo=t.appendTo),void 0!==t.getReferencedVirtualElement&&(this.getReferencedVirtualElement=t.getReferencedVirtualElement),void 0!==t.shouldShow&&t.shouldShow&&(this.shouldShow=t.shouldShow),void 0!==t.options){const n=null!=(e=t.options.scrollTarget)?e:window;n!==this.scrollTarget&&(this.scrollTarget.removeEventListener("scroll",this.resizeHandler),this.scrollTarget=n,this.scrollTarget.addEventListener("scroll",this.resizeHandler)),this.floatingUIOptions={...this.floatingUIOptions,...t.options}}}destroy(){this.hide(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.removeEventListener("dragstart",this.dragstartHandler),window.removeEventListener("resize",this.resizeHandler),this.scrollTarget.removeEventListener("scroll",this.resizeHandler),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler),this.editor.off("transaction",this.transactionHandler),this.floatingUIOptions.onDestroy&&this.floatingUIOptions.onDestroy()}},fe=t=>new h({key:"string"==typeof t.pluginKey?new c(t.pluginKey):t.pluginKey,view:e=>new he({view:e,...t})}),de=e.create({name:"bubbleMenu",addOptions:()=>({element:null,pluginKey:"bubbleMenu",updateDelay:void 0,appendTo:void 0,shouldShow:null}),addProseMirrorPlugins(){return this.options.element?[fe({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,updateDelay:this.options.updateDelay,options:this.options.options,appendTo:this.options.appendTo,getReferencedVirtualElement:this.options.getReferencedVirtualElement,shouldShow:this.options.shouldShow})]:[]}}),ue=de;export{de as BubbleMenu,fe as BubbleMenuPlugin,he as BubbleMenuView,ue as default};
