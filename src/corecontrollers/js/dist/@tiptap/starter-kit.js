import{N as t,b0 as e,aF as n,d as s,aD as r,aC as o,a_ as i,aI as a,j as d,au as p,aQ as c,c as l,a4 as u,aM as h,as as m,ak as k,aj as g,a3 as f,a1 as y}from"../index-Bk8j52k6.mjs";import{P as b,c as M,T as L,b as T,N as A}from"../tiptap-pm-entry-C1u8SbQo.mjs";import{H as w}from"../index-Cao00vVX.mjs";import{L as x}from"../index-D4gsv7cx.mjs";import{P as H}from"../index-CgCy3Ufd.mjs";import{D as v,G as C,U as I,T as N}from"../index-OiUusuK4.mjs";var $=(t,e)=>{if("slot"===t)return 0;if(t instanceof Function)return t(e);const{children:n,...s}=null!=e?e:{};if("svg"===t)throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[t,s,n]},S=/^\s*>\s$/,B=t.create({name:"blockquote",addOptions:()=>({HTMLAttributes:{}}),content:"block+",group:"block",defining:!0,parseHTML:()=>[{tag:"blockquote"}],renderHTML({HTMLAttributes:t}){/* @__PURE__ */
return $("blockquote",{...n(this.options.HTMLAttributes,t),children:/* @__PURE__ */$("slot",{})})},parseMarkdown:(t,e)=>e.createNode("blockquote",void 0,e.parseChildren(t.tokens||[])),renderMarkdown:(t,e)=>{if(!t.content)return"";const n=[];return t.content.forEach(t=>{const s=e.renderChildren([t]).split("\n").map(t=>""===t.trim()?">":`> ${t}`);n.push(s.join("\n"))}),n.join("\n>\n")},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[e({find:S,type:this.type})]}}),O=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,_=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,E=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,j=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,R=s.create({name:"bold",addOptions:()=>({HTMLAttributes:{}}),parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>"normal"!==t.style.fontWeight&&null},{style:"font-weight=400",clearMark:t=>t.type.name===this.name},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){/* @__PURE__ */
return $("strong",{...n(this.options.HTMLAttributes,t),children:/* @__PURE__ */$("slot",{})})},markdownTokenName:"strong",parseMarkdown:(t,e)=>e.applyMark("bold",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`**${e.renderChildren(t)}**`,addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[o({find:O,type:this.type}),o({find:E,type:this.type})]},addPasteRules(){return[r({find:_,type:this.type}),r({find:j,type:this.type})]}}),P=/(^|[^`])`([^`]+)`(?!`)$/,K=/(^|[^`])`([^`]+)`(?!`)/g,D=s.create({name:"code",addOptions:()=>({HTMLAttributes:{}}),excludes:"_",code:!0,exitable:!0,parseHTML:()=>[{tag:"code"}],renderHTML({HTMLAttributes:t}){return["code",n(this.options.HTMLAttributes,t),0]},markdownTokenName:"codespan",parseMarkdown:(t,e)=>e.applyMark("code",[{type:"text",text:t.text||""}]),renderMarkdown:(t,e)=>t.content?`\`${e.renderChildren(t.content)}\``:"",addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[o({find:P,type:this.type})]},addPasteRules(){return[r({find:K,type:this.type})]}}),z=/^```([a-z]+)?[\s\n]$/,q=/^~~~([a-z]+)?[\s\n]$/,W=t.create({name:"codeBlock",addOptions:()=>({languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:4,HTMLAttributes:{}}),content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:t=>{var e;const{languageClassPrefix:n}=this.options;if(!n)return null;const s=[...(null==(e=t.firstElementChild)?void 0:e.classList)||[]].filter(t=>t.startsWith(n)).map(t=>t.replace(n,""))[0];return s||null},rendered:!1}}},parseHTML:()=>[{tag:"pre",preserveWhitespace:"full"}],renderHTML({node:t,HTMLAttributes:e}){return["pre",n(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(t,e)=>{var n;return!1===(null==(n=t.raw)?void 0:n.startsWith("```"))&&"indented"!==t.codeBlockStyle?[]:e.createNode("codeBlock",{language:t.lang||null},t.text?[e.createTextNode(t.text)]:[])},renderMarkdown:(t,e)=>{var n;let s="";const r=(null==(n=t.attrs)?void 0:n.language)||"";if(t.content){s=[`\`\`\`${r}`,e.renderChildren(t.content),"```"].join("\n")}else s=`\`\`\`${r}\n\n\`\`\``;return s},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection,n=1===e.pos;return!(!t||e.parent.type.name!==this.name)&&(!(!n&&e.parent.textContent.length)&&this.editor.commands.clearNodes())},Tab:({editor:t})=>{var e;if(!this.options.enableTabIndentation)return!1;const n=null!=(e=this.options.tabSize)?e:4,{state:s}=t,{selection:r}=s,{$from:o,empty:i}=r;if(o.parent.type!==this.type)return!1;const a=" ".repeat(n);return i?t.commands.insertContent(a):t.commands.command(({tr:t})=>{const{from:e,to:n}=r,o=s.doc.textBetween(e,n,"\n","\n").split("\n").map(t=>a+t).join("\n");return t.replaceWith(e,n,s.schema.text(o)),!0})},"Shift-Tab":({editor:t})=>{var e;if(!this.options.enableTabIndentation)return!1;const n=null!=(e=this.options.tabSize)?e:4,{state:s}=t,{selection:r}=s,{$from:o,empty:i}=r;return o.parent.type===this.type&&(i?t.commands.command(({tr:t})=>{var e;const{pos:r}=o,i=o.start(),a=o.end(),d=s.doc.textBetween(i,a,"\n","\n").split("\n");let p=0,c=0;const l=r-i;for(let n=0;n<d.length;n+=1){if(c+d[n].length>=l){p=n;break}c+=d[n].length+1}const u=(null==(e=d[p].match(/^ */))?void 0:e[0])||"",h=Math.min(u.length,n);if(0===h)return!0;let m=i;for(let n=0;n<p;n+=1)m+=d[n].length+1;t.delete(m,m+h);return r-m<=h&&t.setSelection(L.create(t.doc,m)),!0}):t.commands.command(({tr:t})=>{const{from:e,to:o}=r,i=s.doc.textBetween(e,o,"\n","\n").split("\n").map(t=>{var e;const s=(null==(e=t.match(/^ */))?void 0:e[0])||"",r=Math.min(s.length,n);return t.slice(r)}).join("\n");return t.replaceWith(e,o,s.schema.text(i)),!0}))},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=t,{selection:n}=e,{$from:s,empty:r}=n;if(!r||s.parent.type!==this.type)return!1;const o=s.parentOffset===s.parent.nodeSize-2,i=s.parent.textContent.endsWith("\n\n");return!(!o||!i)&&t.chain().command(({tr:t})=>(t.delete(s.pos-2,s.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=t,{selection:n,doc:s}=e,{$from:r,empty:o}=n;if(!o||r.parent.type!==this.type)return!1;if(!(r.parentOffset===r.parent.nodeSize-2))return!1;const i=r.after();if(void 0===i)return!1;return s.nodeAt(i)?t.commands.command(({tr:t})=>(t.setSelection(T.near(s.resolve(i))),!0)):t.commands.exitCode()}}},addInputRules(){return[i({find:z,type:this.type,getAttributes:t=>({language:t[1]})}),i({find:q,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new b({key:new M("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData)return!1;if(this.editor.isActive(this.type.name))return!1;const n=e.clipboardData.getData("text/plain"),s=e.clipboardData.getData("vscode-editor-data"),r=s?JSON.parse(s):void 0,o=null==r?void 0:r.mode;if(!n||!o)return!1;const{tr:i,schema:a}=t.state,d=a.text(n.replace(/\r\n?/g,"\n"));return i.replaceSelectionWith(this.type.create({language:o},d)),i.selection.$from.parent.type!==this.type&&i.setSelection(L.near(i.doc.resolve(Math.max(0,i.selection.from-2)))),i.setMeta("paste",!0),t.dispatch(i),!0}}})]}}),U=t.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,"\n\n"):""}),F=t.create({name:"hardBreak",markdownTokenName:"br",addOptions:()=>({keepMarks:!0,HTMLAttributes:{}}),inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML:()=>[{tag:"br"}],renderHTML({HTMLAttributes:t}){return["br",n(this.options.HTMLAttributes,t)]},renderText:()=>"\n",renderMarkdown:()=>"  \n",parseMarkdown:()=>({type:"hardBreak"}),addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:n,editor:s})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:t,storedMarks:r}=n;if(t.$from.parent.type.spec.isolating)return!1;const{keepMarks:o}=this.options,{splittableMarks:i}=s.extensionManager,a=r||t.$to.parentOffset&&t.$from.marks();return e().insertContent({type:this.name}).command(({tr:t,dispatch:e})=>{if(e&&a&&o){const e=a.filter(t=>i.includes(t.type.name));t.ensureMarks(e)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),V=t.create({name:"horizontalRule",addOptions:()=>({HTMLAttributes:{},nextNodeType:"paragraph"}),group:"block",parseHTML:()=>[{tag:"hr"}],renderHTML({HTMLAttributes:t}){return["hr",n(this.options.HTMLAttributes,t)]},markdownTokenName:"hr",parseMarkdown:(t,e)=>e.createNode("horizontalRule"),renderMarkdown:()=>"---",addCommands(){return{setHorizontalRule:()=>({chain:t,state:e})=>{if(!d(e,e.schema.nodes[this.name]))return!1;const{selection:n}=e,{$to:s}=n,r=t();return p(n)?r.insertContentAt(s.pos,{type:this.name}):r.insertContent({type:this.name}),r.command(({state:t,tr:e,dispatch:n})=>{if(n){const{$to:n}=e.selection,s=n.end();if(n.nodeAfter)n.nodeAfter.isTextblock?e.setSelection(L.create(e.doc,n.pos+1)):n.nodeAfter.isBlock?e.setSelection(A.create(e.doc,n.pos)):e.setSelection(L.create(e.doc,n.pos));else{const r=t.schema.nodes[this.options.nextNodeType]||n.parent.type.contentMatch.defaultType,o=null==r?void 0:r.create();o&&(e.insert(s,o),e.setSelection(L.create(e.doc,s+1)))}e.scrollIntoView()}return!0}).run()}}},addInputRules(){return[a({find:/^(?:---|â€”-|___\s|\*\*\*\s)$/,type:this.type})]}}),X=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,G=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,J=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,Q=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,Y=s.create({name:"italic",addOptions:()=>({HTMLAttributes:{}}),parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>"normal"!==t.style.fontStyle&&null},{style:"font-style=normal",clearMark:t=>t.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",n(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},markdownTokenName:"em",parseMarkdown:(t,e)=>e.applyMark("italic",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`*${e.renderChildren(t)}*`,addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[o({find:X,type:this.type}),o({find:J,type:this.type})]},addPasteRules(){return[r({find:G,type:this.type}),r({find:Q,type:this.type})]}}),Z=Object.defineProperty,tt="textStyle",et=/^\s*([-+*])\s$/,nt=t.create({name:"bulletList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}),group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML:()=>[{tag:"ul"}],renderHTML({HTMLAttributes:t}){return["ul",n(this.options.HTMLAttributes,t),0]},markdownTokenName:"list",parseMarkdown:(t,e)=>"list"!==t.type||t.ordered?[]:{type:"bulletList",content:t.items?e.parseChildren(t.items):[]},renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,"\n"):"",markdownOptions:{indentsContent:!0},addCommands(){return{toggleBulletList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes("listItem",this.editor.getAttributes(tt)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=e({find:et,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=e({find:et,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(tt),editor:this.editor})),[t]}}),st=t.create({name:"listItem",addOptions:()=>({HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}),content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML({HTMLAttributes:t}){return["li",n(this.options.HTMLAttributes,t),0]},markdownTokenName:"list_item",parseMarkdown:(t,e)=>{if("list_item"!==t.type)return[];let n=[];if(t.tokens&&t.tokens.length>0){if(t.tokens.some(t=>"paragraph"===t.type))n=e.parseChildren(t.tokens);else{const s=t.tokens[0];if(s&&"text"===s.type&&s.tokens&&s.tokens.length>0){if(n=[{type:"paragraph",content:e.parseInline(s.tokens)}],t.tokens.length>1){const s=t.tokens.slice(1),r=e.parseChildren(s);n.push(...r)}}else n=e.parseChildren(t.tokens)}}return 0===n.length&&(n=[{type:"paragraph",content:[]}]),{type:"listItem",content:n}},renderMarkdown:(t,e,n)=>c(t,e,t=>{var e,n;if("bulletList"===t.parentType)return"- ";if("orderedList"===t.parentType){return`${((null==(n=null==(e=t.meta)?void 0:e.parentAttrs)?void 0:n.start)||1)+t.index}. `}return"- "},n),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}});((t,e)=>{for(var n in e)Z(t,n,{get:e[n],enumerable:!0})})({},{findListItemPos:()=>rt,getNextListDepth:()=>ot,handleBackspace:()=>pt,handleDelete:()=>ut,hasListBefore:()=>it,hasListItemAfter:()=>ht,hasListItemBefore:()=>at,listItemHasSubList:()=>dt,nextListIsDeeper:()=>ct,nextListIsHigher:()=>lt});var rt=(t,e)=>{const{$from:n}=e.selection,s=f(t,e.schema);let r=null,o=n.depth,i=n.pos,a=null;for(;o>0&&null===a;)r=n.node(o),r.type===s?a=o:(o-=1,i-=1);return null===a?null:{$pos:e.doc.resolve(i),depth:a}},ot=(t,e)=>{const n=rt(t,e);if(!n)return!1;const[,s]=y(e,t,n.$pos.pos+4);return s},it=(t,e,n)=>{const{$anchor:s}=t.selection,r=Math.max(0,s.pos-2),o=t.doc.resolve(r).node();return!(!o||!n.includes(o.type.name))},at=(t,e)=>{var n;const{$anchor:s}=e.selection,r=e.doc.resolve(s.pos-2);return 0!==r.index()&&(null==(n=r.nodeBefore)?void 0:n.type.name)===t},dt=(t,e,n)=>{if(!n)return!1;const s=f(t,e.schema);let r=!1;return n.descendants(t=>{t.type===s&&(r=!0)}),r},pt=(t,e,n)=>{if(t.commands.undoInputRule())return!0;if(t.state.selection.from!==t.state.selection.to)return!1;if(!m(t.state,e)&&it(t.state,e,n)){const{$anchor:n}=t.state.selection,s=t.state.doc.resolve(n.before()-1),r=[];s.node().descendants((t,n)=>{t.type.name===e&&r.push({node:t,pos:n})});const o=r.at(-1);if(!o)return!1;const i=t.state.doc.resolve(s.start()+o.pos+1);return t.chain().cut({from:n.start()-1,to:n.end()+1},i.end()).joinForward().run()}if(!m(t.state,e))return!1;if(!k(t.state))return!1;const s=rt(e,t.state);if(!s)return!1;const r=t.state.doc.resolve(s.$pos.pos-2).node(s.depth),o=dt(e,t.state,r);return at(e,t.state)&&!o?t.commands.joinItemBackward():t.chain().liftListItem(e).run()},ct=(t,e)=>{const n=ot(t,e),s=rt(t,e);return!(!s||!n)&&n>s.depth},lt=(t,e)=>{const n=ot(t,e),s=rt(t,e);return!(!s||!n)&&n<s.depth},ut=(t,e)=>{if(!m(t.state,e))return!1;if(!g(t.state,e))return!1;const{selection:n}=t.state,{$from:s,$to:r}=n;return!(!n.empty&&s.sameParent(r))&&(ct(e,t.state)?t.chain().focus(t.state.selection.from+4).lift(e).joinBackward().run():lt(e,t.state)?t.chain().joinForward().joinBackward().run():t.commands.joinItemForward())},ht=(t,e)=>{var n;const{$anchor:s}=e.selection,r=e.doc.resolve(s.pos-s.parentOffset-2);return r.index()!==r.parent.childCount-1&&(null==(n=r.nodeAfter)?void 0:n.type.name)===t},mt=l.create({name:"listKeymap",addOptions:()=>({listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}),addKeyboardShortcuts(){return{Delete:({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n})=>{void 0!==t.state.schema.nodes[n]&&ut(t,n)&&(e=!0)}),e},"Mod-Delete":({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n})=>{void 0!==t.state.schema.nodes[n]&&ut(t,n)&&(e=!0)}),e},Backspace:({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n,wrapperNames:s})=>{void 0!==t.state.schema.nodes[n]&&pt(t,n,s)&&(e=!0)}),e},"Mod-Backspace":({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n,wrapperNames:s})=>{void 0!==t.state.schema.nodes[n]&&pt(t,n,s)&&(e=!0)}),e}}}}),kt=/^(\s*)(\d+)\.\s+(.*)$/,gt=/^\s/;function ft(t,e,n){var s;const r=[];let o=0;for(;o<t.length;){const i=t[o];if(i.indent===e){const a=i.content.split("\n"),d=(null==(s=a[0])?void 0:s.trim())||"",p=[];d&&p.push({type:"paragraph",raw:d,tokens:n.inlineTokens(d)});const c=a.slice(1).join("\n").trim();if(c){const t=n.blockTokens(c);p.push(...t)}let l=o+1;const u=[];for(;l<t.length&&t[l].indent>e;)u.push(t[l]),l+=1;if(u.length>0){const t=Math.min(...u.map(t=>t.indent)),e=ft(u,t,n);p.push({type:"list",ordered:!0,start:u[0].number,items:e,raw:u.map(t=>t.raw).join("\n")})}r.push({type:"list_item",raw:i.raw,tokens:p}),o=l}else o+=1}return r}var yt="textStyle",bt=/^(\d+)\.\s$/,Mt=t.create({name:"orderedList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}),group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes:()=>({start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1},type:{default:null,parseHTML:t=>t.getAttribute("type")}}),parseHTML:()=>[{tag:"ol"}],renderHTML({HTMLAttributes:t}){const{start:e,...s}=t;return 1===e?["ol",n(this.options.HTMLAttributes,s),0]:["ol",n(this.options.HTMLAttributes,t),0]},markdownTokenName:"list",parseMarkdown:(t,e)=>{if("list"!==t.type||!t.ordered)return[];const n=t.start||1,s=t.items?function(t,e){return t.map(t=>{if("list_item"!==t.type)return e.parseChildren([t])[0];const n=[];return t.tokens&&t.tokens.length>0&&t.tokens.forEach(t=>{if("paragraph"===t.type||"list"===t.type||"blockquote"===t.type||"code"===t.type)n.push(...e.parseChildren([t]));else if("text"===t.type&&t.tokens){const s=e.parseChildren([t]);n.push({type:"paragraph",content:s})}else{const s=e.parseChildren([t]);s.length>0&&n.push(...s)}}),{type:"listItem",content:n}})}(t.items,e):[];return 1!==n?{type:"orderedList",attrs:{start:n},content:s}:{type:"orderedList",content:s}},renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,"\n"):"",markdownTokenizer:{name:"orderedList",level:"block",start:t=>{const e=t.match(/^(\s*)(\d+)\.\s+/),n=null==e?void 0:e.index;return void 0!==n?n:-1},tokenize:(t,e,n)=>{var s;const r=t.split("\n"),[o,i]=function(t){const e=[];let n=0,s=0;for(;n<t.length;){const r=t[n],o=r.match(kt);if(!o)break;const[,i,a,d]=o,p=i.length;let c=d,l=n+1;const u=[r];for(;l<t.length;){const e=t[l];if(e.match(kt))break;if(""===e.trim())u.push(e),c+="\n",l+=1;else{if(!e.match(gt))break;u.push(e),c+=`\n${e.slice(p+2)}`,l+=1}}e.push({indent:p,number:parseInt(a,10),content:c.trim(),raw:u.join("\n")}),s=l,n=l}return[e,s]}(r);if(0===o.length)return;const a=ft(o,0,n);if(0===a.length)return;return{type:"list",ordered:!0,start:(null==(s=o[0])?void 0:s.number)||1,items:a,raw:r.slice(0,i).join("\n")}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes("listItem",this.editor.getAttributes(yt)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=e({find:bt,type:this.type,getAttributes:t=>({start:+t[1]}),joinPredicate:(t,e)=>e.childCount+e.attrs.start===+t[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=e({find:bt,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:t=>({start:+t[1],...this.editor.getAttributes(yt)}),joinPredicate:(t,e)=>e.childCount+e.attrs.start===+t[1],editor:this.editor})),[t]}}),Lt=/^\s*(\[([( |x])?\])\s$/,Tt=t.create({name:"taskItem",addOptions:()=>({nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}),content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes:()=>({checked:{default:!1,keepOnSplit:!1,parseHTML:t=>{const e=t.getAttribute("data-checked");return""===e||"true"===e},renderHTML:t=>({"data-checked":t.checked})}}),parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:t,HTMLAttributes:e}){return["li",n(this.options.HTMLAttributes,e,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:t.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:(t,e)=>{const n=[];if(t.tokens&&t.tokens.length>0?n.push(e.createNode("paragraph",{},e.parseInline(t.tokens))):t.text?n.push(e.createNode("paragraph",{},[e.createNode("text",{text:t.text})])):n.push(e.createNode("paragraph",{},[])),t.nestedTokens&&t.nestedTokens.length>0){const s=e.parseChildren(t.nestedTokens);n.push(...s)}return e.createNode("taskItem",{checked:t.checked||!1},n)},renderMarkdown:(t,e)=>{var n;const s=(null==(n=t.attrs)?void 0:n.checked)?"x":" ";return c(t,e,`- [${s}] `)},addKeyboardShortcuts(){const t={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...t,Tab:()=>this.editor.commands.sinkListItem(this.name)}:t},addNodeView(){return({node:t,HTMLAttributes:e,getPos:n,editor:s})=>{const r=document.createElement("li"),o=document.createElement("label"),i=document.createElement("span"),a=document.createElement("input"),d=document.createElement("div"),p=t=>{var e,n;a.ariaLabel=(null==(n=null==(e=this.options.a11y)?void 0:e.checkboxLabel)?void 0:n.call(e,t,a.checked))||`Task item checkbox for ${t.textContent||"empty task item"}`};p(t),o.contentEditable="false",a.type="checkbox",a.addEventListener("mousedown",t=>t.preventDefault()),a.addEventListener("change",e=>{if(!s.isEditable&&!this.options.onReadOnlyChecked)return void(a.checked=!a.checked);const{checked:r}=e.target;s.isEditable&&"function"==typeof n&&s.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:t})=>{const e=n();if("number"!=typeof e)return!1;const s=t.doc.nodeAt(e);return t.setNodeMarkup(e,void 0,{...null==s?void 0:s.attrs,checked:r}),!0}).run(),!s.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(t,r)||(a.checked=!a.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([t,e])=>{r.setAttribute(t,e)}),r.dataset.checked=t.attrs.checked,a.checked=t.attrs.checked,o.append(a,i),r.append(o,d),Object.entries(e).forEach(([t,e])=>{r.setAttribute(t,e)});let c=new Set(Object.keys(e));return{dom:r,contentDOM:d,update:t=>{if(t.type!==this.type)return!1;r.dataset.checked=t.attrs.checked,a.checked=t.attrs.checked,p(t);const e=s.extensionManager.attributes,n=u(t,e),o=new Set(Object.keys(n)),i=this.options.HTMLAttributes;return c.forEach(t=>{o.has(t)||(t in i?r.setAttribute(t,i[t]):r.removeAttribute(t))}),Object.entries(n).forEach(([t,e])=>{null==e?t in i?r.setAttribute(t,i[t]):r.removeAttribute(t):r.setAttribute(t,e)}),c=o,!0}}}},addInputRules(){return[e({find:Lt,type:this.type,getAttributes:t=>({checked:"x"===t[t.length-1]})})]}}),At=t.create({name:"taskList",addOptions:()=>({itemTypeName:"taskItem",HTMLAttributes:{}}),group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:t}){return["ul",n(this.options.HTMLAttributes,t,{"data-type":this.name}),0]},parseMarkdown:(t,e)=>e.createNode("taskList",{},e.parseChildren(t.items||[])),renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,"\n"):"",markdownTokenizer:{name:"taskList",level:"block",start(t){var e;const n=null==(e=t.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))?void 0:e.index;return void 0!==n?n:-1},tokenize(t,e,n){const s=t=>{const e=h(t,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:t=>({indentLevel:t[1].length,mainContent:t[4],checked:"x"===t[3].toLowerCase()}),createToken:(t,e)=>({type:"taskItem",raw:"",mainContent:t.mainContent,indentLevel:t.indentLevel,checked:t.checked,text:t.mainContent,tokens:n.inlineTokens(t.mainContent),nestedTokens:e}),customNestedParser:s},n);return e?[{type:"taskList",raw:e.raw,items:e.items}]:n.blockTokens(t)},r=h(t,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:t=>({indentLevel:t[1].length,mainContent:t[4],checked:"x"===t[3].toLowerCase()}),createToken:(t,e)=>({type:"taskItem",raw:"",mainContent:t.mainContent,indentLevel:t.indentLevel,checked:t.checked,text:t.mainContent,tokens:n.inlineTokens(t.mainContent),nestedTokens:e}),customNestedParser:s},n);if(r)return{type:"taskList",raw:r.raw,items:r.items}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleTaskList:()=>({commands:t})=>t.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}});l.create({name:"listKit",addExtensions(){const t=[];return!1!==this.options.bulletList&&t.push(nt.configure(this.options.bulletList)),!1!==this.options.listItem&&t.push(st.configure(this.options.listItem)),!1!==this.options.listKeymap&&t.push(mt.configure(this.options.listKeymap)),!1!==this.options.orderedList&&t.push(Mt.configure(this.options.orderedList)),!1!==this.options.taskItem&&t.push(Tt.configure(this.options.taskItem)),!1!==this.options.taskList&&t.push(At.configure(this.options.taskList)),t}});var wt=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,xt=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,Ht=s.create({name:"strike",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>!!t.includes("line-through")&&{}}],renderHTML({HTMLAttributes:t}){return["s",n(this.options.HTMLAttributes,t),0]},markdownTokenName:"del",parseMarkdown:(t,e)=>e.applyMark("strike",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`~~${e.renderChildren(t)}~~`,addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[o({find:wt,type:this.type})]},addPasteRules(){return[r({find:xt,type:this.type})]}}),vt=t.create({name:"text",group:"inline",parseMarkdown:t=>({type:"text",text:t.text||""}),renderMarkdown:t=>t.text||""}),Ct=s.create({name:"underline",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:t=>!!t.includes("underline")&&{}}],renderHTML({HTMLAttributes:t}){return["u",n(this.options.HTMLAttributes,t),0]},parseMarkdown(t,e){return e.applyMark(this.name||"underline",e.parseInline(t.tokens||[]))},renderMarkdown:(t,e)=>`++${e.renderChildren(t)}++`,markdownTokenizer:{name:"underline",level:"inline",start:t=>t.indexOf("++"),tokenize(t,e,n){const s=/^(\+\+)([\s\S]+?)(\+\+)/.exec(t);if(!s)return;const r=s[2].trim();return{type:"underline",raw:s[0],text:r,tokens:n.inlineTokens(r)}}},addCommands(){return{setUnderline:()=>({commands:t})=>t.setMark(this.name),toggleUnderline:()=>({commands:t})=>t.toggleMark(this.name),unsetUnderline:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),It=l.create({name:"starterKit",addExtensions(){var t,e,n,s;const r=[];return!1!==this.options.bold&&r.push(R.configure(this.options.bold)),!1!==this.options.blockquote&&r.push(B.configure(this.options.blockquote)),!1!==this.options.bulletList&&r.push(nt.configure(this.options.bulletList)),!1!==this.options.code&&r.push(D.configure(this.options.code)),!1!==this.options.codeBlock&&r.push(W.configure(this.options.codeBlock)),!1!==this.options.document&&r.push(U.configure(this.options.document)),!1!==this.options.dropcursor&&r.push(v.configure(this.options.dropcursor)),!1!==this.options.gapcursor&&r.push(C.configure(this.options.gapcursor)),!1!==this.options.hardBreak&&r.push(F.configure(this.options.hardBreak)),!1!==this.options.heading&&r.push(w.configure(this.options.heading)),!1!==this.options.undoRedo&&r.push(I.configure(this.options.undoRedo)),!1!==this.options.horizontalRule&&r.push(V.configure(this.options.horizontalRule)),!1!==this.options.italic&&r.push(Y.configure(this.options.italic)),!1!==this.options.listItem&&r.push(st.configure(this.options.listItem)),!1!==this.options.listKeymap&&r.push(mt.configure(null==(t=this.options)?void 0:t.listKeymap)),!1!==this.options.link&&r.push(x.configure(null==(e=this.options)?void 0:e.link)),!1!==this.options.orderedList&&r.push(Mt.configure(this.options.orderedList)),!1!==this.options.paragraph&&r.push(H.configure(this.options.paragraph)),!1!==this.options.strike&&r.push(Ht.configure(this.options.strike)),!1!==this.options.text&&r.push(vt.configure(this.options.text)),!1!==this.options.underline&&r.push(Ct.configure(null==(n=this.options)?void 0:n.underline)),!1!==this.options.trailingNode&&r.push(N.configure(null==(s=this.options)?void 0:s.trailingNode)),r}}),Nt=It;export{It as StarterKit,Nt as default};
