import{A as t,T as e,b as n,e as o,j as r,N as s,l as i,r as a,S as c,f as l,g as d,F as p,R as u,h,i as f,P as m,k as g,E as y,m as v,n as b,o as w,p as k,q as x,c as M,s as S}from"./tiptap-pm-entry-C1u8SbQo.mjs";const E=(t,e)=>!t.selection.empty&&(e&&e(t.tr.deleteSelection().scrollIntoView()),!0);function C(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("backward",t):n.parentOffset>0)?null:n}const T=(t,e,o)=>{let r=C(t,o);if(!r)return!1;let l=R(r);if(!l){let n=r.blockRange(),o=n&&i(n);return null!=o&&(e&&e(t.tr.lift(n,o).scrollIntoView()),!0)}let d=l.nodeBefore;if(H(t,l,e,-1))return!0;if(0==r.parent.content.size&&($(d,"end")||s.isSelectable(d)))for(let i=r.depth;;i--){let o=a(t.doc,r.before(i),r.after(i),c.empty);if(o&&o.slice.size<o.to-o.from){if(e){let r=t.tr.step(o);r.setSelection($(d,"end")?n.findFrom(r.doc.resolve(r.mapping.map(l.pos,-1)),-1):s.create(r.doc,l.pos-d.nodeSize)),e(r.scrollIntoView())}return!0}if(1==i||r.node(i-1).childCount>1)break}return!(!d.isAtom||l.depth!=r.depth-1)&&(e&&e(t.tr.delete(l.pos-d.nodeSize,l.pos).scrollIntoView()),!0)};function A(t,n,o){let r=n.nodeBefore,s=n.pos-1;for(;!r.isTextblock;s--){if(r.type.spec.isolating)return!1;let t=r.lastChild;if(!t)return!1;r=t}let i=n.nodeAfter,l=n.pos+1;for(;!i.isTextblock;l++){if(i.type.spec.isolating)return!1;let t=i.firstChild;if(!t)return!1;i=t}let d=a(t.doc,s,l,c.empty);if(!d||d.from!=s||d instanceof h&&d.slice.size>=l-s)return!1;if(o){let n=t.tr.step(d);n.setSelection(e.create(n.doc,s)),o(n.scrollIntoView())}return!0}function $(t,e,n=!1){for(let o=t;o;o="start"==e?o.firstChild:o.lastChild){if(o.isTextblock)return!0;if(n&&1!=o.childCount)return!1}return!1}const O=(t,e,n)=>{let{$head:o,empty:r}=t.selection,i=o;if(!r)return!1;if(o.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):o.parentOffset>0)return!1;i=R(o)}let a=i&&i.nodeBefore;return!(!a||!s.isSelectable(a))&&(e&&e(t.tr.setSelection(s.create(t.doc,i.pos-a.nodeSize)).scrollIntoView()),!0)};function R(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function z(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)?null:n}const N=(t,e,o)=>{let r=z(t,o);if(!r)return!1;let i=I(r);if(!i)return!1;let l=i.nodeAfter;if(H(t,i,e,1))return!0;if(0==r.parent.content.size&&($(l,"start")||s.isSelectable(l))){let o=a(t.doc,r.before(),r.after(),c.empty);if(o&&o.slice.size<o.to-o.from){if(e){let r=t.tr.step(o);r.setSelection($(l,"start")?n.findFrom(r.doc.resolve(r.mapping.map(i.pos)),1):s.create(r.doc,r.mapping.map(i.pos))),e(r.scrollIntoView())}return!0}}return!(!l.isAtom||i.depth!=r.depth-1)&&(e&&e(t.tr.delete(i.pos,i.pos+l.nodeSize).scrollIntoView()),!0)},P=(t,e,n)=>{let{$head:o,empty:r}=t.selection,i=o;if(!r)return!1;if(o.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):o.parentOffset<o.parent.content.size)return!1;i=I(o)}let a=i&&i.nodeAfter;return!(!a||!s.isSelectable(a))&&(e&&e(t.tr.setSelection(s.create(t.doc,i.pos)).scrollIntoView()),!0)};function I(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let n=t.node(e);if(t.index(e)+1<n.childCount)return t.doc.resolve(t.after(e+1));if(n.type.spec.isolating)break}return null}const D=(t,e)=>{let{$head:n,$anchor:o}=t.selection;return!(!n.parent.type.spec.code||!n.sameParent(o))&&(e&&e(t.tr.insertText("\n").scrollIntoView()),!0)};function j(t){for(let e=0;e<t.edgeCount;e++){let{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const B=(n,o)=>{let r=n.selection,{$from:s,$to:i}=r;if(r instanceof t||s.parent.inlineContent||i.parent.inlineContent)return!1;let a=j(i.parent.contentMatchAt(i.indexAfter()));if(!a||!a.isTextblock)return!1;if(o){let t=(!s.parentOffset&&i.index()<i.parent.childCount?s:i).pos,r=n.tr.insert(t,a.createAndFill());r.setSelection(e.create(r.doc,t+1)),o(r.scrollIntoView())}return!0},L=(t,e)=>{let{$cursor:n}=t.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let o=n.before();if(l(t.doc,o))return e&&e(t.tr.split(o).scrollIntoView()),!0}let o=n.blockRange(),r=o&&i(o);return null!=r&&(e&&e(t.tr.lift(o,r).scrollIntoView()),!0)};const V=(n,o)=>{let{$from:r,$to:i}=n.selection;if(n.selection instanceof s&&n.selection.node.isBlock)return!(!r.parentOffset||!l(n.doc,r.pos)||(o&&o(n.tr.split(r.pos).scrollIntoView()),0));if(!r.depth)return!1;let a,c,d=[],p=!1,u=!1;for(let t=r.depth;;t--){if(r.node(t).isBlock){p=r.end(t)==r.pos+(r.depth-t),u=r.start(t)==r.pos-(r.depth-t),c=j(r.node(t-1).contentMatchAt(r.indexAfter(t-1))),d.unshift(p&&c?{type:c}:null),a=t;break}if(1==t)return!1;d.unshift(null)}let h=n.tr;(n.selection instanceof e||n.selection instanceof t)&&h.deleteSelection();let f=h.mapping.map(r.pos),m=l(h.doc,f,d.length,d);if(m||(d[0]=c?{type:c}:null,m=l(h.doc,f,d.length,d)),!m)return!1;if(h.split(f,d.length,d),!p&&u&&r.node(a).type!=c){let t=h.mapping.map(r.before(a)),e=h.doc.resolve(t);c&&r.node(a-1).canReplaceWith(e.index(),e.index()+1,c)&&h.setNodeMarkup(h.mapping.map(r.before(a)),c)}return o&&o(h.scrollIntoView()),!0};function H(t,e,r,s){let a,l,d=e.nodeBefore,h=e.nodeAfter,f=d.type.spec.isolating||h.type.spec.isolating;if(!f&&function(t,e,n){let r=e.nodeBefore,s=e.nodeAfter,i=e.index();return!(!(r&&s&&r.type.compatibleContent(s.type))||(!r.content.size&&e.parent.canReplace(i-1,i)?(n&&n(t.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),0):!e.parent.canReplace(i,i+1)||!s.isTextblock&&!o(t.doc,e.pos)||(n&&n(t.tr.join(e.pos).scrollIntoView()),0)))}(t,e,r))return!0;let m=!f&&e.parent.canReplace(e.index(),e.index()+1);if(m&&(a=(l=d.contentMatchAt(d.childCount)).findWrapping(h.type))&&l.matchType(a[0]||h.type).validEnd){if(r){let n=e.pos+h.nodeSize,s=p.empty;for(let t=a.length-1;t>=0;t--)s=p.from(a[t].create(null,s));s=p.from(d.copy(s));let i=t.tr.step(new u(e.pos-1,n,e.pos,n,new c(s,1,0),a.length,!0)),l=i.doc.resolve(n+2*a.length);l.nodeAfter&&l.nodeAfter.type==d.type&&o(i.doc,l.pos)&&i.join(l.pos),r(i.scrollIntoView())}return!0}let g=h.type.spec.isolating||s>0&&f?null:n.findFrom(e,1),y=g&&g.$from.blockRange(g.$to),v=y&&i(y);if(null!=v&&v>=e.depth)return r&&r(t.tr.lift(y,v).scrollIntoView()),!0;if(m&&$(h,"start",!0)&&$(d,"end")){let n=d,o=[];for(;o.push(n),!n.isTextblock;)n=n.lastChild;let s=h,i=1;for(;!s.isTextblock;s=s.firstChild)i++;if(n.canReplace(n.childCount,n.childCount,s.content)){if(r){let n=p.empty;for(let t=o.length-1;t>=0;t--)n=p.from(o[t].copy(n));r(t.tr.step(new u(e.pos-o.length,e.pos+h.nodeSize,e.pos+i,e.pos+h.nodeSize-i,new c(n,o.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function U(t){return function(n,o){let r=n.selection,s=t<0?r.$from:r.$to,i=s.depth;for(;s.node(i).isInline;){if(!i)return!1;i--}return!!s.node(i).isTextblock&&(o&&o(n.tr.setSelection(e.create(n.doc,t<0?s.start(i):s.end(i)))),!0)}}const F=U(-1),W=U(1);function K(t,e=null){return function(n,o){let r=!1;for(let s=0;s<n.selection.ranges.length&&!r;s++){let{$from:{pos:o},$to:{pos:i}}=n.selection.ranges[s];n.doc.nodesBetween(o,i,(o,s)=>{if(r)return!1;if(o.isTextblock&&!o.hasMarkup(t,e))if(o.type==t)r=!0;else{let e=n.doc.resolve(s),o=e.index();r=e.parent.canReplaceWith(o,o+1,t)}})}if(!r)return!1;if(o){let r=n.tr;for(let o=0;o<n.selection.ranges.length;o++){let{$from:{pos:s},$to:{pos:i}}=n.selection.ranges[o];r.setBlockType(s,i,t,e)}o(r.scrollIntoView())}return!0}}function _(...t){return function(e,n,o){for(let r=0;r<t.length;r++)if(t[r](e,n,o))return!0;return!1}}function q(t,e=null){return function(n,o){let{$from:r,$to:s}=n.selection,i=r.blockRange(s);if(!i)return!1;let a=o?n.tr:null;return!!function(t,e,n,o=null){let r=!1,s=e,i=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(n)&&0==e.startIndex){if(0==e.$from.index(e.depth-1))return!1;let t=i.resolve(e.start-2);s=new f(t,t,e.depth),e.endIndex<e.parent.childCount&&(e=new f(e.$from,i.resolve(e.$to.end(e.depth)),e.depth)),r=!0}let a=d(s,n,o,e);if(!a)return!1;t&&function(t,e,n,o,r){let s=p.empty;for(let c=n.length-1;c>=0;c--)s=p.from(n[c].type.create(n[c].attrs,s));t.step(new u(e.start-(o?2:0),e.end,e.start,e.end,new c(s,0,0),n.length,!0));let i=0;for(let c=0;c<n.length;c++)n[c].type==r&&(i=c+1);let a=n.length-i,d=e.start+n.length-(o?2:0),h=e.parent;for(let c=e.startIndex,p=e.endIndex,u=!0;c<p;c++,u=!1)!u&&l(t.doc,d,a)&&(t.split(d,a),d+=2*a),d+=h.child(c).nodeSize}(t,e,a,r,n);return!0}(a,i,t,e)&&(o&&o(a.scrollIntoView()),!0)}}function J(t){return function(e,n){let{$from:r,$to:s}=e.selection,a=r.blockRange(s,e=>e.childCount>0&&e.firstChild.type==t);return!!a&&(!n||(r.node(a.depth-1).type==t?function(t,e,n,r){let s=t.tr,a=r.end,l=r.$to.end(r.depth);a<l&&(s.step(new u(a-1,l,a,l,new c(p.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new f(s.doc.resolve(r.$from.pos),s.doc.resolve(l),r.depth));const d=i(r);if(null==d)return!1;s.lift(r,d);let h=s.doc.resolve(s.mapping.map(a,-1)-1);o(s.doc,h.pos)&&h.nodeBefore.type==h.nodeAfter.type&&s.join(h.pos);return e(s.scrollIntoView()),!0}(e,n,t,a):function(t,e,n){let o=t.tr,r=n.parent;for(let c=n.end,p=n.endIndex-1,u=n.startIndex;p>u;p--)c-=r.child(p).nodeSize,o.delete(c-1,c+1);let s=o.doc.resolve(n.start),i=s.nodeAfter;if(o.mapping.map(n.end)!=n.start+s.nodeAfter.nodeSize)return!1;let a=0==n.startIndex,l=n.endIndex==r.childCount,d=s.node(-1),h=s.index(-1);if(!d.canReplace(h+(a?0:1),h+1,i.content.append(l?p.empty:p.from(r))))return!1;let f=s.pos,m=f+i.nodeSize;return o.step(new u(f-(a?1:0),m+(l?1:0),f+1,m-1,new c((a?p.empty:p.from(r.copy(p.empty))).append(l?p.empty:p.from(r.copy(p.empty))),a?0:1,l?0:1),a?0:1)),e(o.scrollIntoView()),!0}(e,n,a)))}}_(E,T,O),_(E,N,P),_(D,B,L,V),"undefined"!=typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):"undefined"!=typeof os&&os.platform&&os.platform();for(var X={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Y={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Z="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),Q="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),G=0;G<10;G++)X[48+G]=X[96+G]=String(G);for(G=1;G<=24;G++)X[G+111]="F"+G;for(G=65;G<=90;G++)X[G]=String.fromCharCode(G+32),Y[G]=String.fromCharCode(G);for(var tt in X)Y.hasOwnProperty(tt)||(Y[tt]=X[tt]);const et="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),nt="undefined"!=typeof navigator&&/Win/.test(navigator.platform);function ot(t){let e,n,o,r,s=t.split(/-(?!$)/),i=s[s.length-1];"Space"==i&&(i=" ");for(let a=0;a<s.length-1;a++){let t=s[a];if(/^(cmd|meta|m)$/i.test(t))r=!0;else if(/^a(lt)?$/i.test(t))e=!0;else if(/^(c|ctrl|control)$/i.test(t))n=!0;else if(/^s(hift)?$/i.test(t))o=!0;else{if(!/^mod$/i.test(t))throw new Error("Unrecognized modifier name: "+t);et?r=!0:n=!0}}return e&&(i="Alt-"+i),n&&(i="Ctrl-"+i),r&&(i="Meta-"+i),o&&(i="Shift-"+i),i}function rt(t,e,n=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),n&&e.shiftKey&&(t="Shift-"+t),t}function st(t){let e=function(t){let e=/* @__PURE__ */Object.create(null);for(let n in t)e[ot(n)]=t[n];return e}(t);return function(t,n){let o,r=function(t){var e=!(Z&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||Q&&t.shiftKey&&t.key&&1==t.key.length||"Unidentified"==t.key)&&t.key||(t.shiftKey?Y:X)[t.keyCode]||t.key||"Unidentified";return"Esc"==e&&(e="Escape"),"Del"==e&&(e="Delete"),"Left"==e&&(e="ArrowLeft"),"Up"==e&&(e="ArrowUp"),"Right"==e&&(e="ArrowRight"),"Down"==e&&(e="ArrowDown"),e}(n),s=e[rt(r,n)];if(s&&s(t.state,t.dispatch,t))return!0;if(1==r.length&&" "!=r){if(n.shiftKey){let o=e[rt(r,n,!1)];if(o&&o(t.state,t.dispatch,t))return!0}if((n.altKey||n.metaKey||n.ctrlKey)&&!(nt&&n.ctrlKey&&n.altKey)&&(o=X[n.keyCode])&&o!=r){let r=e[rt(o,n)];if(r&&r(t.state,t.dispatch,t))return!0}}return!1}}var it=Object.defineProperty,at=(t,e)=>{for(var n in e)it(t,n,{get:e[n],enumerable:!0})};function ct(t){const{state:e,transaction:n}=t;let{selection:o}=n,{doc:r}=n,{storedMarks:s}=n;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return s},get selection(){return o},get doc(){return r},get tr(){return o=n.selection,r=n.doc,s=n.storedMarks,n}}}var lt=class{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:e,state:n}=this,{view:o}=e,{tr:r}=n,s=this.buildProps(r);return Object.fromEntries(Object.entries(t).map(([t,e])=>[t,(...t)=>{const n=e(...t)(s);return r.getMeta("preventDispatch")||this.hasCustomState||o.dispatch(r),n}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,e=!0){const{rawCommands:n,editor:o,state:r}=this,{view:s}=o,i=[],a=!!t,c=t||r.tr,l={...Object.fromEntries(Object.entries(n).map(([t,n])=>[t,(...t)=>{const o=this.buildProps(c,e),r=n(...t)(o);return i.push(r),l}])),run:()=>(a||!e||c.getMeta("preventDispatch")||this.hasCustomState||s.dispatch(c),i.every(t=>!0===t))};return l}createCan(t){const{rawCommands:e,state:n}=this,o=!1,r=t||n.tr,s=this.buildProps(r,o);return{...Object.fromEntries(Object.entries(e).map(([t,e])=>[t,(...t)=>e(...t)({...s,dispatch:void 0})])),chain:()=>this.createChain(r,o)}}buildProps(t,e=!0){const{rawCommands:n,editor:o,state:r}=this,{view:s}=o,i={tr:t,editor:o,view:s,state:ct({state:r,transaction:t}),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(t,e),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(n).map(([t,e])=>[t,(...t)=>e(...t)(i)]))}};return i}},dt={};at(dt,{blur:()=>pt,clearContent:()=>ut,clearNodes:()=>ht,command:()=>ft,createParagraphNear:()=>mt,cut:()=>gt,deleteCurrentNode:()=>yt,deleteNode:()=>bt,deleteRange:()=>wt,deleteSelection:()=>kt,enter:()=>xt,exitCode:()=>Mt,extendMarkRange:()=>Ot,first:()=>Rt,focus:()=>Bt,forEach:()=>Lt,insertContent:()=>Vt,insertContentAt:()=>Kt,joinBackward:()=>Jt,joinDown:()=>qt,joinForward:()=>Xt,joinItemBackward:()=>Yt,joinItemForward:()=>Zt,joinTextblockBackward:()=>Qt,joinTextblockForward:()=>Gt,joinUp:()=>_t,keyboardShortcut:()=>ee,lift:()=>oe,liftEmptyBlock:()=>re,liftListItem:()=>se,newlineInCode:()=>ie,resetAttributes:()=>le,scrollIntoView:()=>de,selectAll:()=>pe,selectNodeBackward:()=>ue,selectNodeForward:()=>he,selectParentNode:()=>fe,selectTextblockEnd:()=>me,selectTextblockStart:()=>ge,setContent:()=>ve,setMark:()=>xn,setMeta:()=>Mn,setNode:()=>Sn,setNodeSelection:()=>En,setTextDirection:()=>Cn,setTextSelection:()=>Tn,sinkListItem:()=>An,splitBlock:()=>On,splitListItem:()=>Rn,toggleList:()=>Pn,toggleMark:()=>In,toggleNode:()=>Dn,toggleWrap:()=>jn,undoInputRule:()=>Bn,unsetAllMarks:()=>Ln,unsetMark:()=>Vn,unsetTextDirection:()=>Hn,updateAttributes:()=>Un,wrapIn:()=>Fn,wrapInList:()=>Wn});var pt=()=>({editor:t,view:e})=>(requestAnimationFrame(()=>{var n;t.isDestroyed||(e.dom.blur(),null==(n=null==window?void 0:window.getSelection())||n.removeAllRanges())}),!0),ut=(t=!0)=>({commands:e})=>e.setContent("",{emitUpdate:t}),ht=()=>({state:t,tr:e,dispatch:n})=>{const{selection:o}=e,{ranges:r}=o;return!n||(r.forEach(({$from:n,$to:o})=>{t.doc.nodesBetween(n.pos,o.pos,(t,n)=>{if(t.type.isText)return;const{doc:o,mapping:r}=e,s=o.resolve(r.map(n)),a=o.resolve(r.map(n+t.nodeSize)),c=s.blockRange(a);if(!c)return;const l=i(c);if(t.type.isTextblock){const{defaultType:t}=s.parent.contentMatchAt(s.index());e.setNodeMarkup(c.start,t)}(l||0===l)&&e.lift(c,l)})}),!0)},ft=t=>e=>t(e),mt=()=>({state:t,dispatch:e})=>B(t,e),gt=(t,n)=>({editor:o,tr:r})=>{const{state:s}=o,i=s.doc.slice(t.from,t.to);r.deleteRange(t.from,t.to);const a=r.mapping.map(n);return r.insert(a,i.content),r.setSelection(new e(r.doc.resolve(Math.max(a-1,0)))),!0},yt=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,o=n.$anchor.node();if(o.content.size>0)return!1;const r=t.selection.$anchor;for(let s=r.depth;s>0;s-=1){if(r.node(s).type===o.type){if(e){const e=r.before(s),n=r.after(s);t.delete(e,n).scrollIntoView()}return!0}}return!1};function vt(t,e){if("string"==typeof t){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}var bt=t=>({tr:e,state:n,dispatch:o})=>{const r=vt(t,n.schema),s=e.selection.$anchor;for(let t=s.depth;t>0;t-=1){if(s.node(t).type===r){if(o){const n=s.before(t),o=s.after(t);e.delete(n,o).scrollIntoView()}return!0}}return!1},wt=t=>({tr:e,dispatch:n})=>{const{from:o,to:r}=t;return n&&e.delete(o,r),!0},kt=()=>({state:t,dispatch:e})=>E(t,e),xt=()=>({commands:t})=>t.keyboardShortcut("Enter"),Mt=()=>({state:t,dispatch:e})=>((t,e)=>{let{$head:o,$anchor:r}=t.selection;if(!o.parent.type.spec.code||!o.sameParent(r))return!1;let s=o.node(-1),i=o.indexAfter(-1),a=j(s.contentMatchAt(i));if(!a||!s.canReplaceWith(i,i,a))return!1;if(e){let r=o.after(),s=t.tr.replaceWith(r,r,a.createAndFill());s.setSelection(n.near(s.doc.resolve(r),1)),e(s.scrollIntoView())}return!0})(t,e);function St(t){return"[object RegExp]"===Object.prototype.toString.call(t)}function Et(t,e,n={strict:!0}){const o=Object.keys(e);return!o.length||o.every(o=>n.strict?e[o]===t[o]:St(e[o])?e[o].test(t[o]):e[o]===t[o])}function Ct(t,e,n={}){return t.find(t=>t.type===e&&Et(Object.fromEntries(Object.keys(n).map(e=>[e,t.attrs[e]])),n))}function Tt(t,e,n={}){return!!Ct(t,e,n)}function At(t,e,n){var o;if(!t||!e)return;let r=t.parent.childAfter(t.parentOffset);if(r.node&&r.node.marks.some(t=>t.type===e)||(r=t.parent.childBefore(t.parentOffset)),!r.node||!r.node.marks.some(t=>t.type===e))return;n=n||(null==(o=r.node.marks[0])?void 0:o.attrs);if(!Ct([...r.node.marks],e,n))return;let s=r.index,i=t.start()+r.offset,a=s+1,c=i+r.node.nodeSize;for(;s>0&&Tt([...t.parent.child(s-1).marks],e,n);)s-=1,i-=t.parent.child(s).nodeSize;for(;a<t.parent.childCount&&Tt([...t.parent.child(a).marks],e,n);)c+=t.parent.child(a).nodeSize,a+=1;return{from:i,to:c}}function $t(t,e){if("string"==typeof t){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}var Ot=(t,n={})=>({tr:o,state:r,dispatch:s})=>{const i=$t(t,r.schema),{doc:a,selection:c}=o,{$from:l,from:d,to:p}=c;if(s){const t=At(l,i,n);if(t&&t.from<=d&&t.to>=p){const n=e.create(a,t.from,t.to);o.setSelection(n)}}return!0},Rt=t=>e=>{const n="function"==typeof t?t(e):t;for(let t=0;t<n.length;t+=1)if(n[t](e))return!0;return!1};function zt(t){return t instanceof e}function Nt(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function Pt(t,o=null){if(!o)return null;const r=n.atStart(t),s=n.atEnd(t);if("start"===o||!0===o)return r;if("end"===o)return s;const i=r.from,a=s.to;return"all"===o?e.create(t,Nt(0,i,a),Nt(t.content.size,i,a)):e.create(t,Nt(o,i,a),Nt(o,i,a))}function It(){return"Android"===navigator.platform||/android/i.test(navigator.userAgent)}function Dt(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function jt(){return"undefined"!=typeof navigator&&/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}var Bt=(t=null,e={})=>({editor:n,view:o,tr:r,dispatch:s})=>{e={scrollIntoView:!0,...e};const i=()=>{(Dt()||It())&&o.dom.focus(),!jt()||Dt()||It()||o.dom.focus({preventScroll:!0}),requestAnimationFrame(()=>{n.isDestroyed||(o.focus(),(null==e?void 0:e.scrollIntoView)&&n.commands.scrollIntoView())})};try{if(o.hasFocus()&&null===t||!1===t)return!0}catch{return!1}if(s&&null===t&&!zt(n.state.selection))return i(),!0;const a=Pt(r.doc,t)||n.state.selection,c=n.state.selection.eq(a);return s&&(c||r.setSelection(a),c&&r.storedMarks&&r.setStoredMarks(r.storedMarks),i()),!0},Lt=(t,e)=>n=>t.every((t,o)=>e(t,{...n,index:o})),Vt=(t,e)=>({tr:n,commands:o})=>o.insertContentAt({from:n.selection.from,to:n.selection.to},t,e),Ht=t=>{const e=t.childNodes;for(let n=e.length-1;n>=0;n-=1){const o=e[n];3===o.nodeType&&o.nodeValue&&/^(\n\s\s|\n)$/.test(o.nodeValue)?t.removeChild(o):1===o.nodeType&&Ht(o)}return t};function Ut(t){if("undefined"==typeof window)throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const e=`<body>${t}</body>`,n=(new window.DOMParser).parseFromString(e,"text/html").body;return Ht(n)}function Ft(t,e,n){if(t instanceof b||t instanceof p)return t;n={slice:!0,parseOptions:{},...n};const o="string"==typeof t;if("object"==typeof t&&null!==t)try{if(Array.isArray(t)&&t.length>0)return p.fromArray(t.map(t=>e.nodeFromJSON(t)));const o=e.nodeFromJSON(t);return n.errorOnInvalidContent&&o.check(),o}catch(r){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:r});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",r),Ft("",e,n)}if(o){if(n.errorOnInvalidContent){let o=!1,r="";const s=new w({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:t=>(o=!0,r="string"==typeof t?t:t.outerHTML,null)}]}})});if(n.slice?k.fromSchema(s).parseSlice(Ut(t),n.parseOptions):k.fromSchema(s).parse(Ut(t),n.parseOptions),n.errorOnInvalidContent&&o)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${r}`)})}const o=k.fromSchema(e);return n.slice?o.parseSlice(Ut(t),n.parseOptions).content:o.parse(Ut(t),n.parseOptions)}return Ft("",e,n)}function Wt(t,e,o){const r=t.steps.length-1;if(r<e)return;const s=t.steps[r];if(!(s instanceof h||s instanceof u))return;const i=t.mapping.maps[r];let a=0;i.forEach((t,e,n,o)=>{0===a&&(a=o)}),t.setSelection(n.near(t.doc.resolve(a),o))}var Kt=(t,e,n)=>({tr:o,dispatch:r,editor:s})=>{var i;if(r){let r;const c=t=>{s.emit("contentError",{editor:s,error:t,disableCollaboration:()=>{"collaboration"in s.storage&&"object"==typeof s.storage.collaboration&&s.storage.collaboration&&(s.storage.collaboration.isDisabled=!0)}})},l={preserveWhitespace:"full",...(n={parseOptions:s.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n}).parseOptions};if(!n.errorOnInvalidContent&&!s.options.enableContentCheck&&s.options.emitContentError)try{Ft(e,s.schema,{parseOptions:l,errorOnInvalidContent:!0})}catch(a){c(a)}try{r=Ft(e,s.schema,{parseOptions:l,errorOnInvalidContent:null!=(i=n.errorOnInvalidContent)?i:s.options.enableContentCheck})}catch(a){return c(a),!1}let{from:d,to:u}="number"==typeof t?{from:t,to:t}:{from:t.from,to:t.to},h=!0,f=!0;if(("type"in r?[r]:r).forEach(t=>{t.check(),h=!!h&&(t.isText&&0===t.marks.length),f=!!f&&t.isBlock}),d===u&&f){const{parent:t}=o.doc.resolve(d);t.isTextblock&&!t.type.spec.code&&!t.childCount&&(d-=1,u+=1)}let m;if(h){if(Array.isArray(e))m=e.map(t=>t.text||"").join("");else if(e instanceof p){let t="";e.forEach(e=>{e.text&&(t+=e.text)}),m=t}else m="object"==typeof e&&e&&e.text?e.text:e;o.insertText(m,d,u)}else{m=r;const t=o.doc.resolve(d),e=t.node(),n=0===t.parentOffset,s=e.isText||e.isTextblock,i=e.content.size>0;n&&s&&i&&(d=Math.max(0,d-1)),o.replaceWith(d,u,m)}n.updateSelection&&Wt(o,o.steps.length-1,-1),n.applyInputRules&&o.setMeta("applyInputRules",{from:d,text:m}),n.applyPasteRules&&o.setMeta("applyPasteRules",{from:d,text:m})}return!0},_t=()=>({state:t,dispatch:e})=>((t,e)=>{let n,i=t.selection,a=i instanceof s;if(a){if(i.node.isTextblock||!o(t.doc,i.from))return!1;n=i.from}else if(n=r(t.doc,i.from,-1),null==n)return!1;if(e){let o=t.tr.join(n);a&&o.setSelection(s.create(o.doc,n-t.doc.resolve(n).nodeBefore.nodeSize)),e(o.scrollIntoView())}return!0})(t,e),qt=()=>({state:t,dispatch:e})=>((t,e)=>{let n,i=t.selection;if(i instanceof s){if(i.node.isTextblock||!o(t.doc,i.to))return!1;n=i.to}else if(n=r(t.doc,i.to,1),null==n)return!1;return e&&e(t.tr.join(n).scrollIntoView()),!0})(t,e),Jt=()=>({state:t,dispatch:e})=>T(t,e),Xt=()=>({state:t,dispatch:e})=>N(t,e),Yt=()=>({state:t,dispatch:e,tr:n})=>{try{const o=r(t.doc,t.selection.$from.pos,-1);return null!=o&&(n.join(o,2),e&&e(n),!0)}catch{return!1}},Zt=()=>({state:t,dispatch:e,tr:n})=>{try{const o=r(t.doc,t.selection.$from.pos,1);return null!=o&&(n.join(o,2),e&&e(n),!0)}catch{return!1}},Qt=()=>({state:t,dispatch:e})=>((t,e,n)=>{let o=C(t,n);if(!o)return!1;let r=R(o);return!!r&&A(t,r,e)})(t,e),Gt=()=>({state:t,dispatch:e})=>((t,e,n)=>{let o=z(t,n);if(!o)return!1;let r=I(o);return!!r&&A(t,r,e)})(t,e);function te(){return"undefined"!=typeof navigator&&/Mac/.test(navigator.platform)}var ee=t=>({editor:e,view:n,tr:o,dispatch:r})=>{const s=function(t){const e=t.split(/-(?!$)/);let n,o,r,s,i=e[e.length-1];"Space"===i&&(i=" ");for(let a=0;a<e.length-1;a+=1){const t=e[a];if(/^(cmd|meta|m)$/i.test(t))s=!0;else if(/^a(lt)?$/i.test(t))n=!0;else if(/^(c|ctrl|control)$/i.test(t))o=!0;else if(/^s(hift)?$/i.test(t))r=!0;else{if(!/^mod$/i.test(t))throw new Error(`Unrecognized modifier name: ${t}`);Dt()||te()?s=!0:o=!0}}return n&&(i=`Alt-${i}`),o&&(i=`Ctrl-${i}`),s&&(i=`Meta-${i}`),r&&(i=`Shift-${i}`),i}(t).split(/-(?!$)/),i=s.find(t=>!["Alt","Ctrl","Meta","Shift"].includes(t)),a=new KeyboardEvent("keydown",{key:"Space"===i?" ":i,altKey:s.includes("Alt"),ctrlKey:s.includes("Ctrl"),metaKey:s.includes("Meta"),shiftKey:s.includes("Shift"),bubbles:!0,cancelable:!0}),c=e.captureTransaction(()=>{n.someProp("handleKeyDown",t=>t(n,a))});return null==c||c.steps.forEach(t=>{const e=t.map(o.mapping);e&&r&&o.maybeStep(e)}),!0};function ne(t,e,n={}){const{from:o,to:r,empty:s}=t.selection,i=e?vt(e,t.schema):null,a=[];t.doc.nodesBetween(o,r,(t,e)=>{if(t.isText)return;const n=Math.max(o,e),s=Math.min(r,e+t.nodeSize);a.push({node:t,from:n,to:s})});const c=r-o,l=a.filter(t=>!i||i.name===t.node.type.name).filter(t=>Et(t.node.attrs,n,{strict:!1}));if(s)return!!l.length;return l.reduce((t,e)=>t+e.to-e.from,0)>=c}var oe=(t,e={})=>({state:n,dispatch:o})=>!!ne(n,vt(t,n.schema),e)&&((t,e)=>{let{$from:n,$to:o}=t.selection,r=n.blockRange(o),s=r&&i(r);return null!=s&&(e&&e(t.tr.lift(r,s).scrollIntoView()),!0)})(n,o),re=()=>({state:t,dispatch:e})=>L(t,e),se=t=>({state:e,dispatch:n})=>J(vt(t,e.schema))(e,n),ie=()=>({state:t,dispatch:e})=>D(t,e);function ae(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function ce(t,e){const n="string"==typeof e?[e]:e;return Object.keys(t).reduce((e,o)=>(n.includes(o)||(e[o]=t[o]),e),{})}var le=(t,e)=>({tr:n,state:o,dispatch:r})=>{let s=null,i=null;const a=ae("string"==typeof t?t:t.name,o.schema);if(!a)return!1;"node"===a&&(s=vt(t,o.schema)),"mark"===a&&(i=$t(t,o.schema));let c=!1;return n.selection.ranges.forEach(t=>{o.doc.nodesBetween(t.$from.pos,t.$to.pos,(t,o)=>{s&&s===t.type&&(c=!0,r&&n.setNodeMarkup(o,void 0,ce(t.attrs,e))),i&&t.marks.length&&t.marks.forEach(s=>{i===s.type&&(c=!0,r&&n.addMark(o,o+t.nodeSize,i.create(ce(s.attrs,e))))})})}),c},de=()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),pe=()=>({tr:e,dispatch:n})=>{if(n){const n=new t(e.doc);e.setSelection(n)}return!0},ue=()=>({state:t,dispatch:e})=>O(t,e),he=()=>({state:t,dispatch:e})=>P(t,e),fe=()=>({state:t,dispatch:e})=>((t,e)=>{let n,{$from:o,to:r}=t.selection,i=o.sharedDepth(r);return 0!=i&&(n=o.before(i),e&&e(t.tr.setSelection(s.create(t.doc,n))),!0)})(t,e),me=()=>({state:t,dispatch:e})=>W(t,e),ge=()=>({state:t,dispatch:e})=>F(t,e);function ye(t,e,n={},o={}){return Ft(t,e,{slice:!1,parseOptions:n,errorOnInvalidContent:o.errorOnInvalidContent})}var ve=(t,{errorOnInvalidContent:e,emitUpdate:n=!0,parseOptions:o={}}={})=>({editor:r,tr:s,dispatch:i,commands:a})=>{const{doc:c}=s;if("full"!==o.preserveWhitespace){const a=ye(t,r.schema,o,{errorOnInvalidContent:null!=e?e:r.options.enableContentCheck});return i&&s.replaceWith(0,c.content.size,a).setMeta("preventUpdate",!n),!0}return i&&s.setMeta("preventUpdate",!n),a.insertContentAt({from:0,to:c.content.size},t,{parseOptions:o,errorOnInvalidContent:null!=e?e:r.options.enableContentCheck})};function be(t,e){const n=$t(e,t.schema),{from:o,to:r,empty:s}=t.selection,i=[];s?(t.storedMarks&&i.push(...t.storedMarks),i.push(...t.selection.$head.marks())):t.doc.nodesBetween(o,r,t=>{i.push(...t.marks)});const a=i.find(t=>t.type.name===n.name);return a?{...a.attrs}:{}}function we(t,e){const n=new g(t);return e.forEach(t=>{t.steps.forEach(t=>{n.step(t)})}),n}function ke(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function xe(t,e){const n=[];return t.descendants((t,o)=>{e(t)&&n.push({node:t,pos:o})}),n}function Me(t,e,n){const o=[];return t.nodesBetween(e.from,e.to,(t,e)=>{n(t)&&o.push({node:t,pos:e})}),o}function Se(t,e){for(let n=t.depth;n>0;n-=1){const o=t.node(n);if(e(o))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:o}}}function Ee(t){return e=>Se(e.$from,t)}function Ce(t,e,n){if(void 0===t.config[e]&&t.parent)return Ce(t.parent,e,n);if("function"==typeof t.config[e]){return t.config[e].bind({...n,parent:t.parent?Ce(t.parent,e,n):null})}return t.config[e]}function Te(t){return t.map(t=>{const e=Ce(t,"addExtensions",{name:t.name,options:t.options,storage:t.storage});return e?[t,...Te(e())]:t}).flat(10)}function Ae(t,e){const n=x.fromSchema(e).serializeFragment(t),o=document.implementation.createHTMLDocument().createElement("div");return o.appendChild(n),o.innerHTML}function $e(t){return"function"==typeof t}function Oe(t,e=void 0,...n){return $e(t)?e?t.bind(e)(...n):t(...n):t}function Re(t={}){return 0===Object.keys(t).length&&t.constructor===Object}function ze(t){return{baseExtensions:t.filter(t=>"extension"===t.type),nodeExtensions:t.filter(t=>"node"===t.type),markExtensions:t.filter(t=>"mark"===t.type)}}function Ne(t){const e=[],{nodeExtensions:n,markExtensions:o}=ze(t),r=[...n,...o],s={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(t=>{const n=Ce(t,"addGlobalAttributes",{name:t.name,options:t.options,storage:t.storage,extensions:r});if(!n)return;n().forEach(t=>{t.types.forEach(n=>{Object.entries(t.attributes).forEach(([t,o])=>{e.push({type:n,name:t,attribute:{...s,...o}})})})})}),r.forEach(t=>{const n={name:t.name,options:t.options,storage:t.storage},o=Ce(t,"addAttributes",n);if(!o)return;const r=o();Object.entries(r).forEach(([n,o])=>{const r={...s,...o};"function"==typeof(null==r?void 0:r.default)&&(r.default=r.default()),(null==r?void 0:r.isRequired)&&void 0===(null==r?void 0:r.default)&&delete r.default,e.push({type:t.name,name:n,attribute:r})})}),e}function Pe(...t){return t.filter(t=>!!t).reduce((t,e)=>{const n={...t};return Object.entries(e).forEach(([t,e])=>{if(n[t])if("class"===t){const o=e?String(e).split(" "):[],r=n[t]?n[t].split(" "):[],s=o.filter(t=>!r.includes(t));n[t]=[...r,...s].join(" ")}else if("style"===t){const o=e?e.split(";").map(t=>t.trim()).filter(Boolean):[],r=n[t]?n[t].split(";").map(t=>t.trim()).filter(Boolean):[],s=/* @__PURE__ */new Map;r.forEach(t=>{const[e,n]=t.split(":").map(t=>t.trim());s.set(e,n)}),o.forEach(t=>{const[e,n]=t.split(":").map(t=>t.trim());s.set(e,n)}),n[t]=Array.from(s.entries()).map(([t,e])=>`${t}: ${e}`).join("; ")}else n[t]=e;else n[t]=e}),n},{})}function Ie(t,e){return e.filter(e=>e.type===t.type.name).filter(t=>t.attribute.rendered).map(e=>e.attribute.renderHTML?e.attribute.renderHTML(t.attrs)||{}:{[e.name]:t.attrs[e.name]}).reduce((t,e)=>Pe(t,e),{})}function De(t){return"string"!=typeof t?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):"true"===t||"false"!==t&&t}function je(t,e){return"style"in t?t:{...t,getAttrs:n=>{const o=t.getAttrs?t.getAttrs(n):t.attrs;if(!1===o)return!1;const r=e.reduce((t,e)=>{const o=e.attribute.parseHTML?e.attribute.parseHTML(n):De(n.getAttribute(e.name));return null==o?t:{...t,[e.name]:o}},{});return{...o,...r}}}}function Be(t){return Object.fromEntries(Object.entries(t).filter(([t,e])=>("attrs"!==t||!Re(e))&&null!=e))}function Le(t){var e,n;const o={};return!(null==(e=null==t?void 0:t.attribute)?void 0:e.isRequired)&&"default"in((null==t?void 0:t.attribute)||{})&&(o.default=t.attribute.default),void 0!==(null==(n=null==t?void 0:t.attribute)?void 0:n.validate)&&(o.validate=t.attribute.validate),[t.name,o]}function Ve(t,e){var n;const o=Ne(t),{nodeExtensions:r,markExtensions:s}=ze(t),i=null==(n=r.find(t=>Ce(t,"topNode")))?void 0:n.name,a=Object.fromEntries(r.map(n=>{const r=o.filter(t=>t.type===n.name),s={name:n.name,options:n.options,storage:n.storage,editor:e},i=Be({...t.reduce((t,e)=>{const o=Ce(e,"extendNodeSchema",s);return{...t,...o?o(n):{}}},{}),content:Oe(Ce(n,"content",s)),marks:Oe(Ce(n,"marks",s)),group:Oe(Ce(n,"group",s)),inline:Oe(Ce(n,"inline",s)),atom:Oe(Ce(n,"atom",s)),selectable:Oe(Ce(n,"selectable",s)),draggable:Oe(Ce(n,"draggable",s)),code:Oe(Ce(n,"code",s)),whitespace:Oe(Ce(n,"whitespace",s)),linebreakReplacement:Oe(Ce(n,"linebreakReplacement",s)),defining:Oe(Ce(n,"defining",s)),isolating:Oe(Ce(n,"isolating",s)),attrs:Object.fromEntries(r.map(Le))}),a=Oe(Ce(n,"parseHTML",s));a&&(i.parseDOM=a.map(t=>je(t,r)));const c=Ce(n,"renderHTML",s);c&&(i.toDOM=t=>c({node:t,HTMLAttributes:Ie(t,r)}));const l=Ce(n,"renderText",s);return l&&(i.toText=l),[n.name,i]})),c=Object.fromEntries(s.map(n=>{const r=o.filter(t=>t.type===n.name),s={name:n.name,options:n.options,storage:n.storage,editor:e},i=Be({...t.reduce((t,e)=>{const o=Ce(e,"extendMarkSchema",s);return{...t,...o?o(n):{}}},{}),inclusive:Oe(Ce(n,"inclusive",s)),excludes:Oe(Ce(n,"excludes",s)),group:Oe(Ce(n,"group",s)),spanning:Oe(Ce(n,"spanning",s)),code:Oe(Ce(n,"code",s)),attrs:Object.fromEntries(r.map(Le))}),a=Oe(Ce(n,"parseHTML",s));a&&(i.parseDOM=a.map(t=>je(t,r)));const c=Ce(n,"renderHTML",s);return c&&(i.toDOM=t=>c({mark:t,HTMLAttributes:Ie(t,r)})),[n.name,i]}));return new w({topNode:i,nodes:a,marks:c})}function He(t){const e=t.filter((e,n)=>t.indexOf(e)!==n);return Array.from(new Set(e))}function Ue(t){return t.sort((t,e)=>{const n=Ce(t,"priority")||100,o=Ce(e,"priority")||100;return n>o?-1:n<o?1:0})}function Fe(t){const e=Ue(Te(t)),n=He(e.map(t=>t.name));return n.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${n.map(t=>`'${t}'`).join(", ")}]. This can lead to issues.`),e}function We(t,e){return Ve(Fe(t),e)}function Ke(t,e){const n=We(e);return Ae(b.fromJSON(n,t).content,n)}function _e(t,e){const n=We(e),o=Ut(t);return k.fromSchema(n).parse(o).toJSON()}function qe(t,e,n){const{from:o,to:r}=e,{blockSeparator:s="\n\n",textSerializers:i={}}=n||{};let a="";return t.nodesBetween(o,r,(t,n,c,l)=>{var d;t.isBlock&&n>o&&(a+=s);const p=null==i?void 0:i[t.type.name];if(p)return c&&(a+=p({node:t,pos:n,parent:c,index:l,range:e})),!1;t.isText&&(a+=null==(d=null==t?void 0:t.text)?void 0:d.slice(Math.max(o,n)-n,r-n))}),a}function Je(t,e){return qe(t,{from:0,to:t.content.size},e)}function Xe(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,t])=>t.spec.toText).map(([t,e])=>[t,e.spec.toText]))}function Ye(t,e,n){const{blockSeparator:o="\n\n",textSerializers:r={}}=n||{},s=We(e);return Je(b.fromJSON(s,t),{blockSeparator:o,textSerializers:{...Xe(s),...r}})}function Ze(t,e){const n=vt(e,t.schema),{from:o,to:r}=t.selection,s=[];t.doc.nodesBetween(o,r,t=>{s.push(t)});const i=s.reverse().find(t=>t.type.name===n.name);return i?{...i.attrs}:{}}function Qe(t,e){const n=ae("string"==typeof e?e:e.name,t.schema);return"node"===n?Ze(t,e):"mark"===n?be(t,e):{}}function Ge(t,e=JSON.stringify){const n={};return t.filter(t=>{const o=e(t);return!Object.prototype.hasOwnProperty.call(n,o)&&(n[o]=!0)})}function tn(t){const{mapping:e,steps:n}=t,o=[];return e.maps.forEach((t,r)=>{const s=[];if(t.ranges.length)t.forEach((t,e)=>{s.push({from:t,to:e})});else{const{from:t,to:e}=n[r];if(void 0===t||void 0===e)return;s.push({from:t,to:e})}s.forEach(({from:t,to:n})=>{const s=e.slice(r).map(t,-1),i=e.slice(r).map(n),a=e.invert().map(s,-1),c=e.invert().map(i);o.push({oldRange:{from:a,to:c},newRange:{from:s,to:i}})})}),function(t){const e=Ge(t);return 1===e.length?e:e.filter((t,n)=>{const o=e.filter((t,e)=>e!==n);return!o.some(e=>t.oldRange.from>=e.oldRange.from&&t.oldRange.to<=e.oldRange.to&&t.newRange.from>=e.newRange.from&&t.newRange.to<=e.newRange.to)})}(o)}function en(t,e=0){const n=t.type===t.type.schema.topNodeType?0:1,o=e,r=o+t.nodeSize,s=t.marks.map(t=>{const e={type:t.type.name};return Object.keys(t.attrs).length&&(e.attrs={...t.attrs}),e}),i={...t.attrs},a={type:t.type.name,from:o,to:r};return Object.keys(i).length&&(a.attrs=i),s.length&&(a.marks=s),t.content.childCount&&(a.content=[],t.forEach((t,o)=>{var r;null==(r=a.content)||r.push(en(t,e+o+n))})),t.text&&(a.text=t.text),a}function nn(t,e,n){const o=[];return t===e?n.resolve(t).marks().forEach(e=>{const r=At(n.resolve(t),e.type);r&&o.push({mark:e,...r})}):n.nodesBetween(t,e,(t,e)=>{t&&void 0!==(null==t?void 0:t.nodeSize)&&o.push(...t.marks.map(n=>({from:e,to:e+t.nodeSize,mark:n})))}),o}var on=(t,e,n,o=20)=>{const r=t.doc.resolve(n);let s=o,i=null;for(;s>0&&null===i;){const t=r.node(s);(null==t?void 0:t.type.name)===e?i=t:s-=1}return[i,s]};function rn(t,e){return e.nodes[t]||e.marks[t]||null}function sn(t,e,n){return Object.fromEntries(Object.entries(n).filter(([n])=>{const o=t.find(t=>t.type===e&&t.name===n);return!!o&&o.attribute.keepOnSplit}))}var an=(t,e=500)=>{let n="";const o=t.parentOffset;return t.parent.nodesBetween(Math.max(0,o-e),o,(t,e,r,s)=>{var i,a;const c=(null==(a=(i=t.type.spec).toText)?void 0:a.call(i,{node:t,pos:e,parent:r,index:s}))||t.textContent||"%leaf%";n+=t.isAtom&&!t.isText?c:c.slice(0,Math.max(0,o-e))}),n};function cn(t,e,n={}){const{empty:o,ranges:r}=t.selection,s=e?$t(e,t.schema):null;if(o)return!!(t.storedMarks||t.selection.$from.marks()).filter(t=>!s||s.name===t.type.name).find(t=>Et(t.attrs,n,{strict:!1}));let i=0;const a=[];if(r.forEach(({$from:e,$to:n})=>{const o=e.pos,r=n.pos;t.doc.nodesBetween(o,r,(t,e)=>{if(!t.isText&&!t.marks.length)return;const n=Math.max(o,e),s=Math.min(r,e+t.nodeSize);i+=s-n,a.push(...t.marks.map(t=>({mark:t,from:n,to:s})))})}),0===i)return!1;const c=a.filter(t=>!s||s.name===t.mark.type.name).filter(t=>Et(t.mark.attrs,n,{strict:!1})).reduce((t,e)=>t+e.to-e.from,0),l=a.filter(t=>!s||t.mark.type!==s&&t.mark.type.excludes(s)).reduce((t,e)=>t+e.to-e.from,0);return(c>0?c+l:c)>=i}function ln(t,e,n={}){if(!e)return ne(t,null,n)||cn(t,null,n);const o=ae(e,t.schema);return"node"===o?ne(t,e,n):"mark"===o&&cn(t,e,n)}var dn=(t,e)=>{const{$from:n,$to:o,$anchor:r}=t.selection;if(e){const n=Ee(t=>t.type.name===e)(t.selection);if(!n)return!1;const o=t.doc.resolve(n.pos+1);return r.pos+1===o.end()}return!(o.parentOffset<o.parent.nodeSize-2||n.pos!==o.pos)},pn=t=>{const{$from:e,$to:n}=t.selection;return!(e.parentOffset>0||e.pos!==n.pos)};function un(t,e){return Array.isArray(e)?e.some(e=>("string"==typeof e?e:e.name)===t.name):e}function hn(t,e){const{nodeExtensions:n}=ze(e),o=n.find(e=>e.name===t);if(!o)return!1;const r=Oe(Ce(o,"group",{name:o.name,options:o.options,storage:o.storage}));return"string"==typeof r&&r.split(" ").includes("list")}function fn(t,{checkChildren:e=!0,ignoreWhitespace:n=!1}={}){var o;if(n){if("hardBreak"===t.type.name)return!0;if(t.isText)return/^\s*$/m.test(null!=(o=t.text)?o:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(0===t.content.childCount)return!0;if(e){let o=!0;return t.content.forEach(t=>{!1!==o&&(fn(t,{ignoreWhitespace:n,checkChildren:e})||(o=!1))}),o}return!1}function mn(t){return t instanceof s}var gn=class t{constructor(t){this.position=t}static fromJSON(e){return new t(e.position)}toJSON(){return{position:this.position}}};function yn(t,e){const n=e.mapping.mapResult(t.position);return{position:new gn(n.pos),mapResult:n}}function vn(t){return new gn(t)}function bn(t,e,n){const o=t.state.doc.content.size,r=Nt(e,0,o),s=Nt(n,0,o),i=t.coordsAtPos(r),a=t.coordsAtPos(s,-1),c=Math.min(i.top,a.top),l=Math.max(i.bottom,a.bottom),d=Math.min(i.left,a.left),p=Math.max(i.right,a.right),u={top:c,bottom:l,left:d,right:p,width:p-d,height:l-c,x:d,y:c};return{...u,toJSON:()=>u}}function wn({json:t,validMarks:e,validNodes:n,options:o,rewrittenContent:r=[]}){return t.marks&&Array.isArray(t.marks)&&(t.marks=t.marks.filter(t=>{const n="string"==typeof t?t:t.type;return!!e.has(n)||(r.push({original:JSON.parse(JSON.stringify(t)),unsupported:n}),!1)})),t.content&&Array.isArray(t.content)&&(t.content=t.content.map(t=>wn({json:t,validMarks:e,validNodes:n,options:o,rewrittenContent:r}).json).filter(t=>null!=t)),t.type&&!n.has(t.type)?(r.push({original:JSON.parse(JSON.stringify(t)),unsupported:t.type}),t.content&&Array.isArray(t.content)&&!1!==(null==o?void 0:o.fallbackToParagraph)?(t.type="paragraph",{json:t,rewrittenContent:r}):{json:null,rewrittenContent:r}):{json:t,rewrittenContent:r}}function kn(t,e,n){return wn({json:t,validNodes:new Set(Object.keys(e.nodes)),validMarks:new Set(Object.keys(e.marks)),options:n})}var xn=(t,e={})=>({tr:n,state:o,dispatch:r})=>{const{selection:s}=n,{empty:i,ranges:a}=s,c=$t(t,o.schema);if(r)if(i){const t=be(o,c);n.addStoredMark(c.create({...t,...e}))}else a.forEach(t=>{const r=t.$from.pos,s=t.$to.pos;o.doc.nodesBetween(r,s,(t,o)=>{const i=Math.max(o,r),a=Math.min(o+t.nodeSize,s);t.marks.find(t=>t.type===c)?t.marks.forEach(t=>{c===t.type&&n.addMark(i,a,c.create({...t.attrs,...e}))}):n.addMark(i,a,c.create(e))})});return function(t,e,n){var o;const{selection:r}=e;let s=null;if(zt(r)&&(s=r.$cursor),s){const e=null!=(o=t.storedMarks)?o:s.marks();return s.parent.type.allowsMarkType(n)&&(!!n.isInSet(e)||!e.some(t=>t.type.excludes(n)))}const{ranges:i}=r;return i.some(({$from:e,$to:o})=>{let r=0===e.depth&&t.doc.inlineContent&&t.doc.type.allowsMarkType(n);return t.doc.nodesBetween(e.pos,o.pos,(t,e,o)=>{if(r)return!1;if(t.isInline){const e=!o||o.type.allowsMarkType(n),s=!!n.isInSet(t.marks)||!t.marks.some(t=>t.type.excludes(n));r=e&&s}return!r}),r})}(o,n,c)},Mn=(t,e)=>({tr:n})=>(n.setMeta(t,e),!0),Sn=(t,e={})=>({state:n,dispatch:o,chain:r})=>{const s=vt(t,n.schema);let i;return n.selection.$anchor.sameParent(n.selection.$head)&&(i=n.selection.$anchor.parent.attrs),s.isTextblock?r().command(({commands:t})=>!!K(s,{...i,...e})(n)||t.clearNodes()).command(({state:t})=>K(s,{...i,...e})(t,o)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},En=t=>({tr:e,dispatch:n})=>{if(n){const{doc:n}=e,o=Nt(t,0,n.content.size),r=s.create(n,o);e.setSelection(r)}return!0},Cn=(t,e)=>({tr:n,state:o,dispatch:r})=>{const{selection:s}=o;let i,a;return"number"==typeof e?(i=e,a=e):e&&"from"in e&&"to"in e?(i=e.from,a=e.to):(i=s.from,a=s.to),r&&n.doc.nodesBetween(i,a,(e,o)=>{e.isText||n.setNodeMarkup(o,void 0,{...e.attrs,dir:t})}),!0},Tn=t=>({tr:n,dispatch:o})=>{if(o){const{doc:o}=n,{from:r,to:s}="number"==typeof t?{from:t,to:t}:t,i=e.atStart(o).from,a=e.atEnd(o).to,c=Nt(r,i,a),l=Nt(s,i,a),d=e.create(o,c,l);n.setSelection(d)}return!0},An=t=>({state:e,dispatch:n})=>{const o=vt(t,e.schema);return(r=o,function(t,e){let{$from:n,$to:o}=t.selection,s=n.blockRange(o,t=>t.childCount>0&&t.firstChild.type==r);if(!s)return!1;let i=s.startIndex;if(0==i)return!1;let a=s.parent,l=a.child(i-1);if(l.type!=r)return!1;if(e){let n=l.lastChild&&l.lastChild.type==a.type,o=p.from(n?r.create():null),i=new c(p.from(r.create(null,p.from(a.type.create(null,o)))),n?3:1,0),d=s.start,h=s.end;e(t.tr.step(new u(d-(n?3:1),h,d,h,i,1,!0)).scrollIntoView())}return!0})(e,n);var r};function $n(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const o=n.filter(t=>null==e?void 0:e.includes(t.type.name));t.tr.ensureMarks(o)}}var On=({keepMarks:t=!0}={})=>({tr:n,state:o,dispatch:r,editor:i})=>{const{selection:a,doc:c}=n,{$from:d,$to:p}=a,u=sn(i.extensionManager.attributes,d.node().type.name,d.node().attrs);if(a instanceof s&&a.node.isBlock)return!(!d.parentOffset||!l(c,d.pos))&&(r&&(t&&$n(o,i.extensionManager.splittableMarks),n.split(d.pos).scrollIntoView()),!0);if(!d.parent.isBlock)return!1;const h=p.parentOffset===p.parent.content.size,f=0===d.depth?void 0:ke(d.node(-1).contentMatchAt(d.indexAfter(-1)));let m=h&&f?[{type:f,attrs:u}]:void 0,g=l(n.doc,n.mapping.map(d.pos),1,m);if(m||g||!l(n.doc,n.mapping.map(d.pos),1,f?[{type:f}]:void 0)||(g=!0,m=f?[{type:f,attrs:u}]:void 0),r){if(g&&(a instanceof e&&n.deleteSelection(),n.split(n.mapping.map(d.pos),1,m),f&&!h&&!d.parentOffset&&d.parent.type!==f)){const t=n.mapping.map(d.before()),e=n.doc.resolve(t);d.node(-1).canReplaceWith(e.index(),e.index()+1,f)&&n.setNodeMarkup(n.mapping.map(d.before()),f)}t&&$n(o,i.extensionManager.splittableMarks),n.scrollIntoView()}return g},Rn=(t,n={})=>({tr:o,state:r,dispatch:s,editor:i})=>{var a;const d=vt(t,r.schema),{$from:u,$to:h}=r.selection,f=r.selection.node;if(f&&f.isBlock||u.depth<2||!u.sameParent(h))return!1;const m=u.node(-1);if(m.type!==d)return!1;const g=i.extensionManager.attributes;if(0===u.parent.content.size&&u.node(-1).childCount===u.indexAfter(-1)){if(2===u.depth||u.node(-3).type!==d||u.index(-2)!==u.node(-2).childCount-1)return!1;if(s){let t=p.empty;const r=u.index(-1)?1:u.index(-2)?2:3;for(let e=u.depth-r;e>=u.depth-3;e-=1)t=p.from(u.node(e).copy(t));const s=u.indexAfter(-1)<u.node(-2).childCount?1:u.indexAfter(-2)<u.node(-3).childCount?2:3,i={...sn(g,u.node().type.name,u.node().attrs),...n},l=(null==(a=d.contentMatch.defaultType)?void 0:a.createAndFill(i))||void 0;t=t.append(p.from(d.createAndFill(null,l)||void 0));const h=u.before(u.depth-(r-1));o.replace(h,u.after(-s),new c(t,4-r,0));let f=-1;o.doc.nodesBetween(h,o.doc.content.size,(t,e)=>{if(f>-1)return!1;t.isTextblock&&0===t.content.size&&(f=e+1)}),f>-1&&o.setSelection(e.near(o.doc.resolve(f))),o.scrollIntoView()}return!0}const y=h.pos===u.end()?m.contentMatchAt(0).defaultType:null,v={...sn(g,m.type.name,m.attrs),...n},b={...sn(g,u.node().type.name,u.node().attrs),...n};o.delete(u.pos,h.pos);const w=y?[{type:d,attrs:v},{type:y,attrs:b}]:[{type:d,attrs:v}];if(!l(o.doc,u.pos,2))return!1;if(s){const{selection:t,storedMarks:e}=r,{splittableMarks:n}=i.extensionManager,a=e||t.$to.parentOffset&&t.$from.marks();if(o.split(u.pos,2,w).scrollIntoView(),!a||!s)return!0;const c=a.filter(t=>n.includes(t.type.name));o.ensureMarks(c)}return!0},zn=(t,e)=>{const n=Ee(t=>t.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(void 0===r)return!0;const s=t.doc.nodeAt(r);return n.node.type!==(null==s?void 0:s.type)||!o(t.doc,n.pos)||(t.join(n.pos),!0)},Nn=(t,e)=>{const n=Ee(t=>t.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(n.start).after(n.depth);if(void 0===r)return!0;const s=t.doc.nodeAt(r);return n.node.type!==(null==s?void 0:s.type)||!o(t.doc,r)||(t.join(r),!0)},Pn=(t,e,n,o={})=>({editor:r,tr:s,state:i,dispatch:a,chain:c,commands:l,can:d})=>{const{extensions:p,splittableMarks:u}=r.extensionManager,h=vt(t,i.schema),f=vt(e,i.schema),{selection:m,storedMarks:g}=i,{$from:y,$to:v}=m,b=y.blockRange(v),w=g||m.$to.parentOffset&&m.$from.marks();if(!b)return!1;const k=Ee(t=>hn(t.type.name,p))(m);if(b.depth>=1&&k&&b.depth-k.depth<=1){if(k.node.type===h)return l.liftListItem(f);if(hn(k.node.type.name,p)&&h.validContent(k.node.content)&&a)return c().command(()=>(s.setNodeMarkup(k.pos,h),!0)).command(()=>zn(s,h)).command(()=>Nn(s,h)).run()}return n&&w&&a?c().command(()=>{const t=d().wrapInList(h,o),e=w.filter(t=>u.includes(t.type.name));return s.ensureMarks(e),!!t||l.clearNodes()}).wrapInList(h,o).command(()=>zn(s,h)).command(()=>Nn(s,h)).run():c().command(()=>!!d().wrapInList(h,o)||l.clearNodes()).wrapInList(h,o).command(()=>zn(s,h)).command(()=>Nn(s,h)).run()},In=(t,e={},n={})=>({state:o,commands:r})=>{const{extendEmptyMarkRange:s=!1}=n,i=$t(t,o.schema);return cn(o,i,e)?r.unsetMark(i,{extendEmptyMarkRange:s}):r.setMark(i,e)},Dn=(t,e,n={})=>({state:o,commands:r})=>{const s=vt(t,o.schema),i=vt(e,o.schema),a=ne(o,s,n);let c;return o.selection.$anchor.sameParent(o.selection.$head)&&(c=o.selection.$anchor.parent.attrs),a?r.setNode(i,c):r.setNode(s,{...c,...n})},jn=(t,e={})=>({state:n,commands:o})=>{const r=vt(t,n.schema);return ne(n,r,e)?o.lift(r):o.wrapIn(r,e)},Bn=()=>({state:t,dispatch:e})=>{const n=t.plugins;for(let o=0;o<n.length;o+=1){const r=n[o];let s;if(r.spec.isInputRules&&(s=r.getState(t))){if(e){const e=t.tr,n=s.transform;for(let t=n.steps.length-1;t>=0;t-=1)e.step(n.steps[t].invert(n.docs[t]));if(s.text){const n=e.doc.resolve(s.from).marks();e.replaceWith(s.from,s.to,t.schema.text(s.text,n))}else e.delete(s.from,s.to)}return!0}}return!1},Ln=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,{empty:o,ranges:r}=n;return o||e&&r.forEach(e=>{t.removeMark(e.$from.pos,e.$to.pos)}),!0},Vn=(t,e={})=>({tr:n,state:o,dispatch:r})=>{var s;const{extendEmptyMarkRange:i=!1}=e,{selection:a}=n,c=$t(t,o.schema),{$from:l,empty:d,ranges:p}=a;if(!r)return!0;if(d&&i){let{from:t,to:e}=a;const o=null==(s=l.marks().find(t=>t.type===c))?void 0:s.attrs,r=At(l,c,o);r&&(t=r.from,e=r.to),n.removeMark(t,e,c)}else p.forEach(t=>{n.removeMark(t.$from.pos,t.$to.pos,c)});return n.removeStoredMark(c),!0},Hn=t=>({tr:e,state:n,dispatch:o})=>{const{selection:r}=n;let s,i;return"number"==typeof t?(s=t,i=t):t&&"from"in t&&"to"in t?(s=t.from,i=t.to):(s=r.from,i=r.to),o&&e.doc.nodesBetween(s,i,(t,n)=>{if(t.isText)return;const o={...t.attrs};delete o.dir,e.setNodeMarkup(n,void 0,o)}),!0},Un=(t,e={})=>({tr:n,state:o,dispatch:r})=>{let s=null,i=null;const a=ae("string"==typeof t?t:t.name,o.schema);if(!a)return!1;"node"===a&&(s=vt(t,o.schema)),"mark"===a&&(i=$t(t,o.schema));let c=!1;return n.selection.ranges.forEach(t=>{const a=t.$from.pos,l=t.$to.pos;let d,p,u,h;n.selection.empty?o.doc.nodesBetween(a,l,(t,e)=>{s&&s===t.type&&(c=!0,u=Math.max(e,a),h=Math.min(e+t.nodeSize,l),d=e,p=t)}):o.doc.nodesBetween(a,l,(t,o)=>{o<a&&s&&s===t.type&&(c=!0,u=Math.max(o,a),h=Math.min(o+t.nodeSize,l),d=o,p=t),o>=a&&o<=l&&(s&&s===t.type&&(c=!0,r&&n.setNodeMarkup(o,void 0,{...t.attrs,...e})),i&&t.marks.length&&t.marks.forEach(s=>{if(i===s.type&&(c=!0,r)){const r=Math.max(o,a),c=Math.min(o+t.nodeSize,l);n.addMark(r,c,i.create({...s.attrs,...e}))}}))}),p&&(void 0!==d&&r&&n.setNodeMarkup(d,void 0,{...p.attrs,...e}),i&&p.marks.length&&p.marks.forEach(t=>{i===t.type&&r&&n.addMark(u,h,i.create({...t.attrs,...e}))}))}),c},Fn=(t,e={})=>({state:n,dispatch:o})=>function(t,e=null){return function(n,o){let{$from:r,$to:s}=n.selection,i=r.blockRange(s),a=i&&d(i,t,e);return!!a&&(o&&o(n.tr.wrap(i,a).scrollIntoView()),!0)}}(vt(t,n.schema),e)(n,o),Wn=(t,e={})=>({state:n,dispatch:o})=>q(vt(t,n.schema),e)(n,o),Kn=class{constructor(){this.callbacks={}}on(t,e){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e),this}emit(t,...e){const n=this.callbacks[t];return n&&n.forEach(t=>t.apply(this,e)),this}off(t,e){const n=this.callbacks[t];return n&&(e?this.callbacks[t]=n.filter(t=>t!==e):delete this.callbacks[t]),this}once(t,e){const n=(...o)=>{this.off(t,n),e.apply(this,o)};return this.on(t,n)}removeAllListeners(){this.callbacks={}}},_n=class{constructor(t){var e;this.find=t.find,this.handler=t.handler,this.undoable=null==(e=t.undoable)||e}};function qn(t){var e;const{editor:n,from:o,to:r,text:s,rules:i,plugin:a}=t,{view:c}=n;if(c.composing)return!1;const l=c.state.doc.resolve(o);if(l.parent.type.spec.code||(null==(e=l.nodeBefore||l.nodeAfter)?void 0:e.marks.find(t=>t.type.spec.code)))return!1;let d=!1;const p=an(l)+s;return i.forEach(t=>{if(d)return;const e=((t,e)=>{if(St(e))return e.exec(t);const n=e(t);if(!n)return null;const o=[n.text];return o.index=n.index,o.input=t,o.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),o.push(n.replaceWith)),o})(p,t.find);if(!e)return;const i=c.state.tr,l=ct({state:c.state,transaction:i}),u={from:o-(e[0].length-s.length),to:r},{commands:h,chain:f,can:m}=new lt({editor:n,state:l});null!==t.handler({state:l,range:u,match:e,commands:h,chain:f,can:m})&&i.steps.length&&(t.undoable&&i.setMeta(a,{transform:i,from:o,to:r,text:s}),c.dispatch(i),d=!0)}),d}function Jn(t){const{editor:e,rules:n}=t,o=new m({state:{init:()=>null,apply(t,r,s){const i=t.getMeta(o);if(i)return i;const a=t.getMeta("applyInputRules");return!!a&&setTimeout(()=>{let{text:t}=a;"string"==typeof t||(t=Ae(p.from(t),s.schema));const{from:r}=a,i=r+t.length;qn({editor:e,from:r,to:i,text:t,rules:n,plugin:o})}),t.selectionSet||t.docChanged?null:r}},props:{handleTextInput:(t,r,s,i)=>qn({editor:e,from:r,to:s,text:i,rules:n,plugin:o}),handleDOMEvents:{compositionend:t=>(setTimeout(()=>{const{$cursor:r}=t.state.selection;r&&qn({editor:e,from:r.pos,to:r.pos,text:"",rules:n,plugin:o})}),!1)},handleKeyDown(t,r){if("Enter"!==r.key)return!1;const{$cursor:s}=t.state.selection;return!!s&&qn({editor:e,from:s.pos,to:s.pos,text:"\n",rules:n,plugin:o})}},isInputRules:!0});return o}function Xn(t){return"Object"===function(t){return Object.prototype.toString.call(t).slice(8,-1)}(t)&&(t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype)}function Yn(t,e){const n={...t};return Xn(t)&&Xn(e)&&Object.keys(e).forEach(o=>{Xn(e[o])&&Xn(t[o])?n[o]=Yn(t[o],e[o]):n[o]=e[o]}),n}var Zn=class{constructor(t={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...t},this.name=this.config.name}get options(){return{...Oe(Ce(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...Oe(Ce(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(t={}){const e=this.extend({...this.config,addOptions:()=>Yn(this.options,t)});return e.name=this.name,e.parent=this.parent,e}extend(t={}){const e=new this.constructor({...this.config,...t});return e.parent=this,this.child=e,e.name="name"in t?t.name:e.parent.name,e}},Qn=class t extends Zn{constructor(){super(...arguments),this.type="mark"}static create(e={}){const n="function"==typeof e?e():e;return new t(n)}static handleExit({editor:t,mark:e}){const{tr:n}=t.state,o=t.state.selection.$from;if(o.pos===o.end()){const r=o.marks();if(!!!r.find(t=>(null==t?void 0:t.type.name)===e.name))return!1;const s=r.find(t=>(null==t?void 0:t.type.name)===e.name);return s&&n.removeStoredMark(s),n.insertText(" ",o.pos),t.view.dispatch(n),!0}return!1}configure(t){return super.configure(t)}extend(t){const e="function"==typeof t?t():t;return super.extend(e)}};function Gn(t){return"number"==typeof t}var to=class{constructor(t){this.find=t.find,this.handler=t.handler}};function eo(t){const{editor:e,state:n,from:o,to:r,rule:s,pasteEvent:i,dropEvent:a}=t,{commands:c,chain:l,can:d}=new lt({editor:e,state:n}),p=[];n.doc.nodesBetween(o,r,(t,e)=>{var u,h,f,m,g;if((null==(h=null==(u=t.type)?void 0:u.spec)?void 0:h.code)||!(t.isText||t.isTextblock||t.isInline))return;const y=null!=(g=null!=(m=null==(f=t.content)?void 0:f.size)?m:t.nodeSize)?g:0,v=Math.max(o,e),b=Math.min(r,e+y);if(v>=b)return;((t,e,n)=>{if(St(e))return[...t.matchAll(e)];const o=e(t,n);return o?o.map(e=>{const n=[e.text];return n.index=e.index,n.input=t,n.data=e.data,e.replaceWith&&(e.text.includes(e.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),n.push(e.replaceWith)),n}):[]})(t.isText?t.text||"":t.textBetween(v-e,b-e,void 0,""),s.find,i).forEach(t=>{if(void 0===t.index)return;const e=v+t.index+1,o=e+t[0].length,r={from:n.tr.mapping.map(e),to:n.tr.mapping.map(o)},u=s.handler({state:n,range:r,match:t,commands:c,chain:l,can:d,pasteEvent:i,dropEvent:a});p.push(u)})});return p.every(t=>null!==t)}var no=null;function oo(t){const{editor:e,rules:n}=t;let o,r=null,s=!1,i=!1,a="undefined"!=typeof ClipboardEvent?new ClipboardEvent("paste"):null;try{o="undefined"!=typeof DragEvent?new DragEvent("drop"):null}catch{o=null}const c=({state:t,from:n,to:r,rule:s,pasteEvt:i})=>{const c=t.tr,l=ct({state:t,transaction:c});if(eo({editor:e,state:l,from:Math.max(n-1,0),to:r.b-1,rule:s,pasteEvent:i,dropEvent:o})&&c.steps.length){try{o="undefined"!=typeof DragEvent?new DragEvent("drop"):null}catch{o=null}return a="undefined"!=typeof ClipboardEvent?new ClipboardEvent("paste"):null,c}};return n.map(t=>new m({view(t){const n=n=>{var o;r=(null==(o=t.dom.parentElement)?void 0:o.contains(n.target))?t.dom.parentElement:null,r&&(no=e)},o=()=>{no&&(no=null)};return window.addEventListener("dragstart",n),window.addEventListener("dragend",o),{destroy(){window.removeEventListener("dragstart",n),window.removeEventListener("dragend",o)}}},props:{handleDOMEvents:{drop:(t,e)=>{if(i=r===t.dom.parentElement,o=e,!i){const t=no;(null==t?void 0:t.isEditable)&&setTimeout(()=>{const e=t.state.selection;e&&t.commands.deleteRange({from:e.from,to:e.to})},10)}return!1},paste:(t,e)=>{var n;const o=null==(n=e.clipboardData)?void 0:n.getData("text/html");return a=e,s=!!(null==o?void 0:o.includes("data-pm-slice")),!1}}},appendTransaction:(e,n,o)=>{const r=e[0],l="paste"===r.getMeta("uiEvent")&&!s,d="drop"===r.getMeta("uiEvent")&&!i,u=r.getMeta("applyPasteRules"),h=!!u;if(!l&&!d&&!h)return;if(h){let{text:e}=u;"string"==typeof e||(e=Ae(p.from(e),o.schema));const{from:n}=u,r=n+e.length,s=(t=>{var e;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return null==(e=n.clipboardData)||e.setData("text/html",t),n})(e);return c({rule:t,state:o,from:n,to:{b:r},pasteEvt:s})}const f=n.doc.content.findDiffStart(o.doc.content),m=n.doc.content.findDiffEnd(o.doc.content);return Gn(f)&&m&&f!==m.b?c({rule:t,state:o,from:f,to:m,pasteEvt:a}):void 0}}))}var ro=class{constructor(t,e){this.splittableMarks=[],this.editor=e,this.baseExtensions=t,this.extensions=Fe(t),this.schema=Ve(this.extensions,e),this.setupExtensions()}get commands(){return this.extensions.reduce((t,e)=>{const n=Ce(e,"addCommands",{name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:rn(e.name,this.schema)});return n?{...t,...n()}:t},{})}get plugins(){const{editor:t}=this;return Ue([...this.extensions].reverse()).flatMap(e=>{const n={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:t,type:rn(e.name,this.schema)},o=[],r=Ce(e,"addKeyboardShortcuts",n);let s={};if("mark"===e.type&&Ce(e,"exitable",n)&&(s.ArrowRight=()=>Qn.handleExit({editor:t,mark:e})),r){const e=Object.fromEntries(Object.entries(r()).map(([e,n])=>[e,()=>n({editor:t})]));s={...s,...e}}const i=new m({props:{handleKeyDown:st(s)}});o.push(i);const a=Ce(e,"addInputRules",n);if(un(e,t.options.enableInputRules)&&a){const e=a();if(e&&e.length){const n=Jn({editor:t,rules:e}),r=Array.isArray(n)?n:[n];o.push(...r)}}const c=Ce(e,"addPasteRules",n);if(un(e,t.options.enablePasteRules)&&c){const e=c();if(e&&e.length){const n=oo({editor:t,rules:e});o.push(...n)}}const l=Ce(e,"addProseMirrorPlugins",n);if(l){const t=l();o.push(...t)}return o})}get attributes(){return Ne(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:e}=ze(this.extensions);return Object.fromEntries(e.filter(t=>!!Ce(t,"addNodeView")).map(e=>{const n=this.attributes.filter(t=>t.type===e.name),o={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:t,type:vt(e.name,this.schema)},r=Ce(e,"addNodeView",o);if(!r)return[];const s=r();if(!s)return[];return[e.name,(o,r,i,a,c)=>{const l=Ie(o,n);return s({node:o,view:r,getPos:i,decorations:a,innerDecorations:c,editor:t,extension:e,HTMLAttributes:l})}]}))}dispatchTransaction(t){const{editor:e}=this;return Ue([...this.extensions].reverse()).reduceRight((t,n)=>{const o={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:e,type:rn(n.name,this.schema)},r=Ce(n,"dispatchTransaction",o);return r?e=>{r.call(o,{transaction:e,next:t})}:t},t)}get markViews(){const{editor:t}=this,{markExtensions:e}=ze(this.extensions);return Object.fromEntries(e.filter(t=>!!Ce(t,"addMarkView")).map(e=>{const n=this.attributes.filter(t=>t.type===e.name),o={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:t,type:$t(e.name,this.schema)},r=Ce(e,"addMarkView",o);if(!r)return[];return[e.name,(o,s,i)=>{const a=Ie(o,n);return r()({mark:o,view:s,inline:i,editor:t,extension:e,HTMLAttributes:a,updateAttributes:e=>{Ko(o,t,e)}})}]}))}setupExtensions(){const t=this.extensions;this.editor.extensionStorage=Object.fromEntries(t.map(t=>[t.name,t.storage])),t.forEach(t=>{var e;const n={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:this.editor,type:rn(t.name,this.schema)};if("mark"===t.type){(null==(e=Oe(Ce(t,"keepOnSplit",n)))||e)&&this.splittableMarks.push(t.name)}const o=Ce(t,"onBeforeCreate",n),r=Ce(t,"onCreate",n),s=Ce(t,"onUpdate",n),i=Ce(t,"onSelectionUpdate",n),a=Ce(t,"onTransaction",n),c=Ce(t,"onFocus",n),l=Ce(t,"onBlur",n),d=Ce(t,"onDestroy",n);o&&this.editor.on("beforeCreate",o),r&&this.editor.on("create",r),s&&this.editor.on("update",s),i&&this.editor.on("selectionUpdate",i),a&&this.editor.on("transaction",a),c&&this.editor.on("focus",c),l&&this.editor.on("blur",l),d&&this.editor.on("destroy",d)})}};ro.resolve=Fe,ro.sort=Ue,ro.flatten=Te;var so={};at(so,{ClipboardTextSerializer:()=>ao,Commands:()=>co,Delete:()=>lo,Drop:()=>po,Editable:()=>uo,FocusEvents:()=>fo,Keymap:()=>mo,Paste:()=>go,Tabindex:()=>yo,TextDirection:()=>vo,focusEventsPluginKey:()=>ho});var io=class t extends Zn{constructor(){super(...arguments),this.type="extension"}static create(e={}){const n="function"==typeof e?e():e;return new t(n)}configure(t){return super.configure(t)}extend(t){const e="function"==typeof t?t():t;return super.extend(e)}},ao=io.create({name:"clipboardTextSerializer",addOptions:()=>({blockSeparator:void 0}),addProseMirrorPlugins(){return[new m({key:new M("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:n}=t,{doc:o,selection:r}=e,{ranges:s}=r,i=Math.min(...s.map(t=>t.$from.pos)),a=Math.max(...s.map(t=>t.$to.pos)),c=Xe(n);return qe(o,{from:i,to:a},{...void 0!==this.options.blockSeparator?{blockSeparator:this.options.blockSeparator}:{},textSerializers:c})}}})]}}),co=io.create({name:"commands",addCommands:()=>({...dt})}),lo=io.create({name:"delete",onUpdate({transaction:t,appendedTransactions:e}){var n,o,r;const s=()=>{var n,o,r,s;if(null!=(s=null==(r=null==(o=null==(n=this.editor.options.coreExtensionOptions)?void 0:n.delete)?void 0:o.filterTransaction)?void 0:r.call(o,t))?s:t.getMeta("y-sync$"))return;const i=we(t.before,[t,...e]);tn(i).forEach(e=>{i.mapping.mapResult(e.oldRange.from).deletedAfter&&i.mapping.mapResult(e.oldRange.to).deletedBefore&&i.before.nodesBetween(e.oldRange.from,e.oldRange.to,(n,o)=>{const r=o+n.nodeSize-2,s=e.oldRange.from<=o&&r<=e.oldRange.to;this.editor.emit("delete",{type:"node",node:n,from:o,to:r,newFrom:i.mapping.map(o),newTo:i.mapping.map(r),deletedRange:e.oldRange,newRange:e.newRange,partial:!s,editor:this.editor,transaction:t,combinedTransform:i})})});const a=i.mapping;i.steps.forEach((e,n)=>{var o,r;if(e instanceof S){const s=a.slice(n).map(e.from,-1),c=a.slice(n).map(e.to),l=a.invert().map(s,-1),d=a.invert().map(c),p=null==(o=i.doc.nodeAt(s-1))?void 0:o.marks.some(t=>t.eq(e.mark)),u=null==(r=i.doc.nodeAt(c))?void 0:r.marks.some(t=>t.eq(e.mark));this.editor.emit("delete",{type:"mark",mark:e.mark,from:e.from,to:e.to,deletedRange:{from:l,to:d},newRange:{from:s,to:c},partial:Boolean(u||p),editor:this.editor,transaction:t,combinedTransform:i})}})};null==(r=null==(o=null==(n=this.editor.options.coreExtensionOptions)?void 0:n.delete)?void 0:o.async)||r?setTimeout(s,0):s()}}),po=io.create({name:"drop",addProseMirrorPlugins(){return[new m({key:new M("tiptapDrop"),props:{handleDrop:(t,e,n,o)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:n,moved:o})}}})]}}),uo=io.create({name:"editable",addProseMirrorPlugins(){return[new m({key:new M("editable"),props:{editable:()=>this.editor.options.editable}})]}}),ho=new M("focusEvents"),fo=io.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new m({key:ho,props:{handleDOMEvents:{focus:(e,n)=>{t.isFocused=!0;const o=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(o),!1},blur:(e,n)=>{t.isFocused=!1;const o=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(o),!1}}}})]}}),mo=io.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:t})=>[()=>t.undoInputRule(),()=>t.command(({tr:e})=>{const{selection:o,doc:r}=e,{empty:s,$anchor:i}=o,{pos:a,parent:c}=i,l=i.parent.isTextblock&&a>0?e.doc.resolve(a-1):i,d=l.parent.type.spec.isolating,p=i.pos-i.parentOffset,u=d&&1===l.parent.childCount?p===i.pos:n.atStart(r).from===a;return!(!s||!c.type.isTextblock||c.textContent.length||!u||u&&"paragraph"===i.parent.type.name)&&t.clearNodes()}),()=>t.deleteSelection(),()=>t.joinBackward(),()=>t.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:t})=>[()=>t.deleteSelection(),()=>t.deleteCurrentNode(),()=>t.joinForward(),()=>t.selectNodeForward()]),o={Enter:()=>this.editor.commands.first(({commands:t})=>[()=>t.newlineInCode(),()=>t.createParagraphNear(),()=>t.liftEmptyBlock(),()=>t.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},r={...o},s={...o,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return Dt()||te()?s:r},addProseMirrorPlugins(){return[new m({key:new M("clearDocument"),appendTransaction:(t,e,o)=>{if(t.some(t=>t.getMeta("composition")))return;const r=t.some(t=>t.docChanged)&&!e.doc.eq(o.doc),s=t.some(t=>t.getMeta("preventClearDocument"));if(!r||s)return;const{empty:i,from:a,to:c}=e.selection,l=n.atStart(e.doc).from,d=n.atEnd(e.doc).to;if(i||!(a===l&&c===d))return;if(!fn(o.doc))return;const p=o.tr,u=ct({state:o,transaction:p}),{commands:h}=new lt({editor:this.editor,state:u});return h.clearNodes(),p.steps.length?p:void 0}})]}}),go=io.create({name:"paste",addProseMirrorPlugins(){return[new m({key:new M("tiptapPaste"),props:{handlePaste:(t,e,n)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:n})}}})]}}),yo=io.create({name:"tabindex",addProseMirrorPlugins(){return[new m({key:new M("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),vo=io.create({name:"textDirection",addOptions:()=>({direction:void 0}),addGlobalAttributes(){if(!this.options.direction)return[];const{nodeExtensions:t}=ze(this.extensions);return[{types:t.filter(t=>"text"!==t.name).map(t=>t.name),attributes:{dir:{default:this.options.direction,parseHTML:t=>{const e=t.getAttribute("dir");return!e||"ltr"!==e&&"rtl"!==e&&"auto"!==e?this.options.direction:e},renderHTML:t=>t.dir?{dir:t.dir}:{}}}}]},addProseMirrorPlugins(){return[new m({key:new M("textDirection"),props:{attributes:()=>{const t=this.options.direction;return t?{dir:t}:{}}}})]}}),bo=class t{constructor(t,e,n=!1,o=null){this.currentNode=null,this.actualDepth=null,this.isBlock=n,this.resolvedPos=t,this.editor=e,this.currentNode=o}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var t;return null!=(t=this.actualDepth)?t:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(t){let e=this.from,n=this.to;if(this.isBlock){if(0===this.content.size)return void console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);e=this.from+1,n=this.to-1}this.editor.commands.insertContentAt({from:e,to:n},t)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(0===this.depth)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(e);return new t(n,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new t(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new t(e,this.editor)}get children(){const e=[];return this.node.content.forEach((n,o)=>{const r=n.isBlock&&!n.isTextblock,s=n.isAtom&&!n.isText,i=n.isInline,a=this.pos+o+(s?0:1);if(a<0||a>this.resolvedPos.doc.nodeSize-2)return;const c=this.resolvedPos.doc.resolve(a);if(!r&&!i&&c.depth<=this.depth)return;const l=new t(c,this.editor,r,r||i?n:null);r&&(l.actualDepth=this.depth+1),e.push(l)}),e}get firstChild(){return this.children[0]||null}get lastChild(){const t=this.children;return t[t.length-1]||null}closest(t,e={}){let n=null,o=this.parent;for(;o&&!n;){if(o.node.type.name===t)if(Object.keys(e).length>0){const t=o.node.attrs,n=Object.keys(e);for(let o=0;o<n.length;o+=1){const r=n[o];if(t[r]!==e[r])break}}else n=o;o=o.parent}return n}querySelector(t,e={}){return this.querySelectorAll(t,e,!0)[0]||null}querySelectorAll(t,e={},n=!1){let o=[];if(!this.children||0===this.children.length)return o;const r=Object.keys(e);return this.children.forEach(s=>{if(!(n&&o.length>0)){if(s.node.type.name===t){r.every(t=>e[t]===s.node.attrs[t])&&o.push(s)}n&&o.length>0||(o=o.concat(s.querySelectorAll(t,e,n)))}}),o}setAttribute(t){const{tr:e}=this.editor.state;e.setNodeMarkup(this.from,void 0,{...this.node.attrs,...t}),this.editor.view.dispatch(e)}};function wo(t,e,n){const o=document.querySelector(`style[data-tiptap-style${n?`-${n}`:""}]`);if(null!==o)return o;const r=document.createElement("style");return e&&r.setAttribute("nonce",e),r.setAttribute("data-tiptap-style"+(n?`-${n}`:""),""),r.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(r),r}var ko=class extends Kn{constructor(t={}){super(),this.css=null,this.className="tiptap",this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:"undefined"!=typeof document?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,textDirection:void 0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:t})=>{throw t},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null,enableExtensionDispatchTransaction:!0},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.utils={getUpdatedPosition:yn,createMappablePosition:vn},this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:t,slice:e,moved:n})=>this.options.onDrop(t,e,n)),this.on("paste",({event:t,slice:e})=>this.options.onPaste(t,e)),this.on("delete",this.options.onDelete);const e=this.createDoc(),n=Pt(e,this.options.autofocus);this.editorState=y.create({doc:e,schema:this.schema,selection:n||void 0}),this.options.element&&this.mount(this.options.element)}mount(t){if("undefined"==typeof document)throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(t),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(!1!==this.options.autofocus&&null!==this.options.autofocus&&this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){const t=this.editorView.dom;(null==t?void 0:t.editor)&&delete t.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll(`.${this.className}`).length)try{"function"==typeof this.css.remove?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(t){console.warn("Failed to remove CSS element:",t)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&"undefined"!=typeof document&&(this.css=wo('.ProseMirror {\n  position: relative;\n}\n\n.ProseMirror {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  white-space: break-spaces;\n  -webkit-font-variant-ligatures: none;\n  font-variant-ligatures: none;\n  font-feature-settings: "liga" 0; /* the above doesn\'t seem to work in Edge */\n}\n\n.ProseMirror [contenteditable="false"] {\n  white-space: normal;\n}\n\n.ProseMirror [contenteditable="false"] [contenteditable="true"] {\n  white-space: pre-wrap;\n}\n\n.ProseMirror pre {\n  white-space: pre-wrap;\n}\n\nimg.ProseMirror-separator {\n  display: inline !important;\n  border: none !important;\n  margin: 0 !important;\n  width: 0 !important;\n  height: 0 !important;\n}\n\n.ProseMirror-gapcursor {\n  display: none;\n  pointer-events: none;\n  position: absolute;\n  margin: 0;\n}\n\n.ProseMirror-gapcursor:after {\n  content: "";\n  display: block;\n  position: absolute;\n  top: -2px;\n  width: 20px;\n  border-top: 1px solid black;\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\n}\n\n@keyframes ProseMirror-cursor-blink {\n  to {\n    visibility: hidden;\n  }\n}\n\n.ProseMirror-hideselection *::selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection *::-moz-selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection * {\n  caret-color: transparent;\n}\n\n.ProseMirror-focused .ProseMirror-gapcursor {\n  display: block;\n}',this.options.injectNonce))}setOptions(t={}){this.options={...this.options,...t},this.editorView&&this.state&&!this.isDestroyed&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t,e=!0){this.setOptions({editable:t}),e&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:t=>{this.editorState=t},dispatch:t=>{this.dispatchTransaction(t)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(t,e)=>{if(this.editorView)return this.editorView[e];if("state"===e)return this.editorState;if(e in t)return Reflect.get(t,e);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${e}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(t,e){const n=$e(e)?e(t,[...this.state.plugins]):[...this.state.plugins,t],o=this.state.reconfigure({plugins:n});return this.view.updateState(o),o}unregisterPlugin(t){if(this.isDestroyed)return;const e=this.state.plugins;let n=e;if([].concat(t).forEach(t=>{const e="string"==typeof t?`${t}$`:t.key;n=n.filter(t=>!t.key.startsWith(e))}),e.length===n.length)return;const o=this.state.reconfigure({plugins:n});return this.view.updateState(o),o}createExtensionManager(){var t,e;const n=[...this.options.enableCoreExtensions?[uo,ao.configure({blockSeparator:null==(e=null==(t=this.options.coreExtensionOptions)?void 0:t.clipboardTextSerializer)?void 0:e.blockSeparator}),co,fo,mo,yo,po,go,lo,vo.configure({direction:this.options.textDirection})].filter(t=>"object"!=typeof this.options.enableCoreExtensions||!1!==this.options.enableCoreExtensions[t.name]):[],...this.options.extensions].filter(t=>["extension","node","mark"].includes(null==t?void 0:t.type));this.extensionManager=new ro(n,this)}createCommandManager(){this.commandManager=new lt({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let t;try{t=ye(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(e){if(!(e instanceof Error&&["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(e.message)))throw e;this.emit("contentError",{editor:this,error:e,disableCollaboration:()=>{"collaboration"in this.storage&&"object"==typeof this.storage.collaboration&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(t=>"collaboration"!==t.name),this.createExtensionManager()}}),t=ye(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return t}createView(t){const{editorProps:e,enableExtensionDispatchTransaction:n}=this.options,o=e.dispatchTransaction||this.dispatchTransaction.bind(this),r=n?this.extensionManager.dispatchTransaction(o):o;this.editorView=new v(t,{...e,attributes:{role:"textbox",...null==e?void 0:e.attributes},dispatchTransaction:r,state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews});const s=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(s),this.prependClass(),this.injectCSS();this.view.dom.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`${this.className} ${this.view.dom.className}`}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const e=this.capturedTransaction;return this.capturedTransaction=null,e}dispatchTransaction(t){if(this.view.isDestroyed)return;if(this.isCapturingTransaction)return this.capturedTransaction?void t.steps.forEach(t=>{var e;return null==(e=this.capturedTransaction)?void 0:e.step(t)}):void(this.capturedTransaction=t);const{state:e,transactions:n}=this.state.applyTransaction(t),o=!this.state.selection.eq(e.selection),r=n.includes(t),s=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:t,nextState:e}),!r)return;this.view.updateState(e),this.emit("transaction",{editor:this,transaction:t,appendedTransactions:n.slice(1)}),o&&this.emit("selectionUpdate",{editor:this,transaction:t});const i=n.findLast(t=>t.getMeta("focus")||t.getMeta("blur")),a=null==i?void 0:i.getMeta("focus"),c=null==i?void 0:i.getMeta("blur");a&&this.emit("focus",{editor:this,event:a.event,transaction:i}),c&&this.emit("blur",{editor:this,event:c.event,transaction:i}),t.getMeta("preventUpdate")||!n.some(t=>t.docChanged)||s.doc.eq(e.doc)||this.emit("update",{editor:this,transaction:t,appendedTransactions:n.slice(1)})}getAttributes(t){return Qe(this.state,t)}isActive(t,e){const n="string"==typeof t?t:null,o="string"==typeof t?e:t;return ln(this.state,n,o)}getJSON(){return this.state.doc.toJSON()}getHTML(){return Ae(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:e="\n\n",textSerializers:n={}}=t||{};return Je(this.state.doc,{blockSeparator:e,textSerializers:{...Xe(this.schema),...n}})}get isEmpty(){return fn(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var t,e;return null==(e=null==(t=this.editorView)?void 0:t.isDestroyed)||e}$node(t,e){var n;return(null==(n=this.$doc)?void 0:n.querySelector(t,e))||null}$nodes(t,e){var n;return(null==(n=this.$doc)?void 0:n.querySelectorAll(t,e))||null}$pos(t){const e=this.state.doc.resolve(t);return new bo(e,this)}get $doc(){return this.$pos(0)}};function xo(t){return new _n({find:t.find,handler:({state:e,range:n,match:o})=>{const r=Oe(t.getAttributes,void 0,o);if(!1===r||null===r)return null;const{tr:s}=e,i=o[o.length-1],a=o[0];if(i){const o=a.search(/\S/),c=n.from+a.indexOf(i),l=c+i.length;if(nn(n.from,n.to,e.doc).filter(e=>e.mark.type.excluded.find(n=>n===t.type&&n!==e.mark.type)).filter(t=>t.to>c).length)return null;l<n.to&&s.delete(l,n.to),c>n.from&&s.delete(n.from+o,c);const d=n.from+o+i.length;s.addMark(n.from+o,d,t.type.create(r||{})),s.removeStoredMark(t.type)}},undoable:t.undoable})}function Mo(t){return new _n({find:t.find,handler:({state:e,range:n,match:o})=>{const r=Oe(t.getAttributes,void 0,o)||{},{tr:s}=e,i=n.from;let a=n.to;const c=t.type.create(r);if(o[1]){let t=i+o[0].lastIndexOf(o[1]);t>a?t=a:a=t+o[1].length;const e=o[0][o[0].length-1];s.insertText(e,i+o[0].length-1),s.replaceWith(t,a,c)}else if(o[0]){const e=t.type.isInline?i:i-1;s.insert(e,t.type.create(r)).delete(s.mapping.map(i),s.mapping.map(a))}s.scrollIntoView()},undoable:t.undoable})}function So(t){return new _n({find:t.find,handler:({state:e,range:n,match:o})=>{const r=e.doc.resolve(n.from),s=Oe(t.getAttributes,void 0,o)||{};if(!r.node(-1).canReplaceWith(r.index(-1),r.indexAfter(-1),t.type))return null;e.tr.delete(n.from,n.to).setBlockType(n.from,n.from,t.type,s)},undoable:t.undoable})}function Eo(t){return new _n({find:t.find,handler:({state:e,range:n,match:o})=>{let r=t.replace,s=n.from;const i=n.to;if(o[1]){const t=o[0].lastIndexOf(o[1]);r+=o[0].slice(t+o[1].length),s+=t;const e=s-i;e>0&&(r=o[0].slice(t-e,t)+r,s=i)}e.tr.insertText(r,s,i)},undoable:t.undoable})}function Co(t){return new _n({find:t.find,handler:({state:e,range:n,match:r,chain:s})=>{const i=Oe(t.getAttributes,void 0,r)||{},a=e.tr.delete(n.from,n.to),c=a.doc.resolve(n.from).blockRange(),l=c&&d(c,t.type,i);if(!l)return null;if(a.wrap(c,l),t.keepMarks&&t.editor){const{selection:n,storedMarks:o}=e,{splittableMarks:r}=t.editor.extensionManager,s=o||n.$to.parentOffset&&n.$from.marks();if(s){const t=s.filter(t=>r.includes(t.type.name));a.ensureMarks(t)}}if(t.keepAttributes){const e="bulletList"===t.type.name||"orderedList"===t.type.name?"listItem":"taskList";s().updateAttributes(e,i).run()}const p=a.doc.resolve(n.from-1).nodeBefore;p&&p.type===t.type&&o(a.doc,n.from-1)&&(!t.joinPredicate||t.joinPredicate(r,p))&&a.join(n.from-1)},undoable:t.undoable})}function To(t){return t.children}var Ao=(t,e)=>{if("slot"===t)return 0;if(t instanceof Function)return t(e);const{children:n,...o}=null!=e?e:{};if("svg"===t)throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[t,o,n]},$o=class{constructor(t){var e,n,o,r,s,i;this.directions=["bottom-left","bottom-right","top-left","top-right"],this.minSize={height:8,width:8},this.preserveAspectRatio=!1,this.classNames={container:"",wrapper:"",handle:"",resizing:""},this.initialWidth=0,this.initialHeight=0,this.aspectRatio=1,this.isResizing=!1,this.activeHandle=null,this.startX=0,this.startY=0,this.startWidth=0,this.startHeight=0,this.isShiftKeyPressed=!1,this.lastEditableState=void 0,this.handleMap=/* @__PURE__ */new Map,this.handleMouseMove=t=>{if(!this.isResizing||!this.activeHandle)return;const e=t.clientX-this.startX,n=t.clientY-this.startY;this.handleResize(e,n)},this.handleTouchMove=t=>{if(!this.isResizing||!this.activeHandle)return;const e=t.touches[0];if(!e)return;const n=e.clientX-this.startX,o=e.clientY-this.startY;this.handleResize(n,o)},this.handleMouseUp=()=>{if(!this.isResizing)return;const t=this.element.offsetWidth,e=this.element.offsetHeight;this.onCommit(t,e),this.isResizing=!1,this.activeHandle=null,this.container.dataset.resizeState="false",this.classNames.resizing&&this.container.classList.remove(this.classNames.resizing),document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("keyup",this.handleKeyUp)},this.handleKeyDown=t=>{"Shift"===t.key&&(this.isShiftKeyPressed=!0)},this.handleKeyUp=t=>{"Shift"===t.key&&(this.isShiftKeyPressed=!1)},this.node=t.node,this.editor=t.editor,this.element=t.element,this.contentElement=t.contentElement,this.getPos=t.getPos,this.onResize=t.onResize,this.onCommit=t.onCommit,this.onUpdate=t.onUpdate,(null==(e=t.options)?void 0:e.min)&&(this.minSize={...this.minSize,...t.options.min}),(null==(n=t.options)?void 0:n.max)&&(this.maxSize=t.options.max),(null==(o=null==t?void 0:t.options)?void 0:o.directions)&&(this.directions=t.options.directions),(null==(r=t.options)?void 0:r.preserveAspectRatio)&&(this.preserveAspectRatio=t.options.preserveAspectRatio),(null==(s=t.options)?void 0:s.className)&&(this.classNames={container:t.options.className.container||"",wrapper:t.options.className.wrapper||"",handle:t.options.className.handle||"",resizing:t.options.className.resizing||""}),(null==(i=t.options)?void 0:i.createCustomHandle)&&(this.createCustomHandle=t.options.createCustomHandle),this.wrapper=this.createWrapper(),this.container=this.createContainer(),this.applyInitialSize(),this.attachHandles(),this.editor.on("update",this.handleEditorUpdate.bind(this))}get dom(){return this.container}get contentDOM(){var t;return null!=(t=this.contentElement)?t:null}handleEditorUpdate(){const t=this.editor.isEditable;t!==this.lastEditableState&&(this.lastEditableState=t,t?t&&0===this.handleMap.size&&this.attachHandles():this.removeHandles())}update(t,e,n){return t.type===this.node.type&&(this.node=t,!this.onUpdate||this.onUpdate(t,e,n))}destroy(){this.isResizing&&(this.container.dataset.resizeState="false",this.classNames.resizing&&this.container.classList.remove(this.classNames.resizing),document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("keyup",this.handleKeyUp),this.isResizing=!1,this.activeHandle=null),this.editor.off("update",this.handleEditorUpdate.bind(this)),this.container.remove()}createContainer(){const t=document.createElement("div");return t.dataset.resizeContainer="",t.dataset.node=this.node.type.name,t.style.display="flex",this.classNames.container&&(t.className=this.classNames.container),t.appendChild(this.wrapper),t}createWrapper(){const t=document.createElement("div");return t.style.position="relative",t.style.display="block",t.dataset.resizeWrapper="",this.classNames.wrapper&&(t.className=this.classNames.wrapper),t.appendChild(this.element),t}createHandle(t){const e=document.createElement("div");return e.dataset.resizeHandle=t,e.style.position="absolute",this.classNames.handle&&(e.className=this.classNames.handle),e}positionHandle(t,e){const n=e.includes("top"),o=e.includes("bottom"),r=e.includes("left"),s=e.includes("right");n&&(t.style.top="0"),o&&(t.style.bottom="0"),r&&(t.style.left="0"),s&&(t.style.right="0"),"top"!==e&&"bottom"!==e||(t.style.left="0",t.style.right="0"),"left"!==e&&"right"!==e||(t.style.top="0",t.style.bottom="0")}attachHandles(){this.directions.forEach(t=>{let e;e=this.createCustomHandle?this.createCustomHandle(t):this.createHandle(t),e instanceof HTMLElement||(console.warn(`[ResizableNodeView] createCustomHandle("${t}") did not return an HTMLElement. Falling back to default handle.`),e=this.createHandle(t)),this.createCustomHandle||this.positionHandle(e,t),e.addEventListener("mousedown",e=>this.handleResizeStart(e,t)),e.addEventListener("touchstart",e=>this.handleResizeStart(e,t)),this.handleMap.set(t,e),this.wrapper.appendChild(e)})}removeHandles(){this.handleMap.forEach(t=>t.remove()),this.handleMap.clear()}applyInitialSize(){const t=this.node.attrs.width,e=this.node.attrs.height;t?(this.element.style.width=`${t}px`,this.initialWidth=t):this.initialWidth=this.element.offsetWidth,e?(this.element.style.height=`${e}px`,this.initialHeight=e):this.initialHeight=this.element.offsetHeight,this.initialWidth>0&&this.initialHeight>0&&(this.aspectRatio=this.initialWidth/this.initialHeight)}handleResizeStart(t,e){t.preventDefault(),t.stopPropagation(),this.isResizing=!0,this.activeHandle=e,"touches"in t?(this.startX=t.touches[0].clientX,this.startY=t.touches[0].clientY):(this.startX=t.clientX,this.startY=t.clientY),this.startWidth=this.element.offsetWidth,this.startHeight=this.element.offsetHeight,this.startWidth>0&&this.startHeight>0&&(this.aspectRatio=this.startWidth/this.startHeight),this.getPos(),this.container.dataset.resizeState="true",this.classNames.resizing&&this.container.classList.add(this.classNames.resizing),document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("touchmove",this.handleTouchMove),document.addEventListener("mouseup",this.handleMouseUp),document.addEventListener("keydown",this.handleKeyDown),document.addEventListener("keyup",this.handleKeyUp)}handleResize(t,e){if(!this.activeHandle)return;const n=this.preserveAspectRatio||this.isShiftKeyPressed,{width:o,height:r}=this.calculateNewDimensions(this.activeHandle,t,e),s=this.applyConstraints(o,r,n);this.element.style.width=`${s.width}px`,this.element.style.height=`${s.height}px`,this.onResize&&this.onResize(s.width,s.height)}calculateNewDimensions(t,e,n){let o=this.startWidth,r=this.startHeight;const s=t.includes("right"),i=t.includes("left"),a=t.includes("bottom"),c=t.includes("top");s?o=this.startWidth+e:i&&(o=this.startWidth-e),a?r=this.startHeight+n:c&&(r=this.startHeight-n),"right"!==t&&"left"!==t||(o=this.startWidth+(s?e:-e)),"top"!==t&&"bottom"!==t||(r=this.startHeight+(a?n:-n));return this.preserveAspectRatio||this.isShiftKeyPressed?this.applyAspectRatio(o,r,t):{width:o,height:r}}applyConstraints(t,e,n){var o,r,s,i;if(!n){let n=Math.max(this.minSize.width,t),s=Math.max(this.minSize.height,e);return(null==(o=this.maxSize)?void 0:o.width)&&(n=Math.min(this.maxSize.width,n)),(null==(r=this.maxSize)?void 0:r.height)&&(s=Math.min(this.maxSize.height,s)),{width:n,height:s}}let a=t,c=e;return a<this.minSize.width&&(a=this.minSize.width,c=a/this.aspectRatio),c<this.minSize.height&&(c=this.minSize.height,a=c*this.aspectRatio),(null==(s=this.maxSize)?void 0:s.width)&&a>this.maxSize.width&&(a=this.maxSize.width,c=a/this.aspectRatio),(null==(i=this.maxSize)?void 0:i.height)&&c>this.maxSize.height&&(c=this.maxSize.height,a=c*this.aspectRatio),{width:a,height:c}}applyAspectRatio(t,e,n){const o="top"===n||"bottom"===n;return"left"===n||"right"===n?{width:t,height:t/this.aspectRatio}:o?{width:e*this.aspectRatio,height:e}:{width:t,height:t/this.aspectRatio}}},Oo=$o;function Ro(t,e){const{selection:n}=t,{$from:o}=n;if(n instanceof s){const t=o.index();return o.parent.canReplaceWith(t,t+1,e)}let r=o.depth;for(;r>=0;){const t=o.index(r);if(o.node(r).contentMatchAt(t).matchType(e))return!0;r-=1}return!1}function zo(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function No(){return"undefined"!=typeof navigator&&/Firefox/.test(navigator.userAgent)}function Po(t){return"string"==typeof t}var Io={};function Do(t){if(!(null==t?void 0:t.trim()))return{};const e={},n=[],o=t.replace(/["']([^"']*)["']/g,t=>(n.push(t),`__QUOTED_${n.length-1}__`)),r=o.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(r){const t=r.map(t=>t.trim().slice(1));e.class=t.join(" ")}const s=o.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);s&&(e.id=s[1]);Array.from(o.matchAll(/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g)).forEach(([,t,o])=>{var r;const s=parseInt((null==(r=o.match(/__QUOTED_(\d+)__/))?void 0:r[1])||"0",10),i=n[s];i&&(e[t]=i.slice(1,-1))});const i=o.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();if(i){i.split(/\s+/).filter(Boolean).forEach(t=>{t.match(/^[a-zA-Z][\w-]*$/)&&(e[t]=!0)})}return e}function jo(t){if(!t||0===Object.keys(t).length)return"";const e=[];if(t.class){String(t.class).split(/\s+/).filter(Boolean).forEach(t=>e.push(`.${t}`))}return t.id&&e.push(`#${t.id}`),Object.entries(t).forEach(([t,n])=>{"class"!==t&&"id"!==t&&(!0===n?e.push(t):!1!==n&&null!=n&&e.push(`${t}="${String(n)}"`))}),e.join(" ")}function Bo(t){const{nodeName:e,name:n,parseAttributes:o=Do,serializeAttributes:r=jo,defaultAttributes:s={},requiredAttributes:i=[],allowedAttributes:a}=t,c=n||e;return{parseMarkdown:(t,n)=>{const o={...s,...t.attributes};return n.createNode(e,o,[])},markdownTokenizer:{name:e,level:"block",start(t){var e;const n=new RegExp(`^:::${c}(?:\\s|$)`,"m"),o=null==(e=t.match(n))?void 0:e.index;return void 0!==o?o:-1},tokenize(t,n,r){const s=new RegExp(`^:::${c}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),a=t.match(s);if(!a)return;const l=a[1]||"",d=o(l);return i.find(t=>!(t in d))?void 0:{type:e,raw:a[0],attributes:d}}},renderMarkdown:t=>{const e=(t=>{if(!a)return t;const e={};return a.forEach(n=>{n in t&&(e[n]=t[n])}),e})(t.attrs||{}),n=r(e);return`:::${c}${n?` {${n}}`:""} :::`}}}function Lo(t){const{nodeName:e,name:n,getContent:o,parseAttributes:r=Do,serializeAttributes:s=jo,defaultAttributes:i={},content:a="block",allowedAttributes:c}=t,l=n||e;return{parseMarkdown:(t,n)=>{let r;if(o){const e=o(t);r="string"==typeof e?[{type:"text",text:e}]:e}else r="block"===a?n.parseChildren(t.tokens||[]):n.parseInline(t.tokens||[]);const s={...i,...t.attributes};return n.createNode(e,s,r)},markdownTokenizer:{name:e,level:"block",start(t){var e;const n=new RegExp(`^:::${l}`,"m"),o=null==(e=t.match(n))?void 0:e.index;return void 0!==o?o:-1},tokenize(t,n,o){var s;const i=new RegExp(`^:::${l}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),c=t.match(i);if(!c)return;const[d,p=""]=c,u=r(p);let h=1;const f=d.length;let m="";const g=/^:::([\w-]*)(\s.*)?/gm,y=t.slice(f);for(g.lastIndex=0;;){const n=g.exec(y);if(null===n)break;const r=n.index,i=n[1];if(!(null==(s=n[2])?void 0:s.endsWith(":::")))if(i)h+=1;else if(h-=1,0===h){const s=y.slice(0,r);m=s.trim();const i=t.slice(0,f+r+n[0].length);let c=[];if(m)if("block"===a)for(c=o.blockTokens(s),c.forEach(t=>{!t.text||t.tokens&&0!==t.tokens.length||(t.tokens=o.inlineTokens(t.text))});c.length>0;){const t=c[c.length-1];if("paragraph"!==t.type||t.text&&""!==t.text.trim())break;c.pop()}else c=o.inlineTokens(m);return{type:e,raw:i,attributes:u,content:m,tokens:c}}}}},renderMarkdown:(t,e)=>{const n=(t=>{if(!c)return t;const e={};return c.forEach(n=>{n in t&&(e[n]=t[n])}),e})(t.attrs||{}),o=s(n),r=o?` {${o}}`:"",i=e.renderChildren(t.content||[],"\n\n");return`:::${l}${r}\n\n${i}\n\n:::`}}}function Vo(t){if(!t.trim())return{};const e={},n=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let o=n.exec(t);for(;null!==o;){const[,r,s,i]=o;e[r]=s||i,o=n.exec(t)}return e}function Ho(t){return Object.entries(t).filter(([,t])=>null!=t).map(([t,e])=>`${t}="${e}"`).join(" ")}function Uo(t){const{nodeName:e,name:n,getContent:o,parseAttributes:r=Vo,serializeAttributes:s=Ho,defaultAttributes:i={},selfClosing:a=!1,allowedAttributes:c}=t,l=n||e,d=l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(t,n)=>{const r={...i,...t.attributes};if(a)return n.createNode(e,r);const s=o?o(t):t.content||"";return s?n.createNode(e,r,[n.createTextNode(s)]):n.createNode(e,r,[])},markdownTokenizer:{name:e,level:"inline",start(t){const e=a?new RegExp(`\\[${d}\\s*[^\\]]*\\]`):new RegExp(`\\[${d}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${d}\\]`),n=t.match(e),o=null==n?void 0:n.index;return void 0!==o?o:-1},tokenize(t,n,o){const s=a?new RegExp(`^\\[${d}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${d}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${d}\\]`),i=t.match(s);if(!i)return;let c="",l="";if(a){const[,t]=i;l=t}else{const[,t,e]=i;l=t,c=e||""}const p=r(l.trim());return{type:e,raw:i[0],content:c.trim(),attributes:p}}},renderMarkdown:t=>{let e="";o?e=o(t):t.content&&t.content.length>0&&(e=t.content.filter(t=>"text"===t.type).map(t=>t.text).join(""));const n=(t=>{if(!c)return t;const e={};return c.forEach(n=>{const o="string"==typeof n?n:n.name,r="string"==typeof n?void 0:n.skipIfDefault;if(o in t){const n=t[o];if(void 0!==r&&n===r)return;e[o]=n}}),e})(t.attrs||{}),r=s(n),i=r?` ${r}`:"";return a?`[${l}${i}]`:`[${l}${i}]${e}[/${l}]`}}}function Fo(t,e,n){var o,r,s,i;const a=t.split("\n"),c=[];let l="",d=0;const p=e.baseIndentSize||2;for(;d<a.length;){const t=a[d],u=t.match(e.itemPattern);if(!u){if(c.length>0)break;if(""===t.trim()){d+=1,l=`${l}${t}\n`;continue}return}const h=e.extractItemData(u),{indentLevel:f,mainContent:m}=h;l=`${l}${t}\n`;const g=[m];for(d+=1;d<a.length;){const t=a[d];if(""===t.trim()){const e=a.slice(d+1).findIndex(t=>""!==t.trim());if(-1===e)break;if(((null==(r=null==(o=a[d+1+e].match(/^(\s*)/))?void 0:o[1])?void 0:r.length)||0)>f){g.push(t),l=`${l}${t}\n`,d+=1;continue}break}if(!(((null==(i=null==(s=t.match(/^(\s*)/))?void 0:s[1])?void 0:i.length)||0)>f))break;g.push(t),l=`${l}${t}\n`,d+=1}let y;const v=g.slice(1);if(v.length>0){const t=v.map(t=>t.slice(f+p)).join("\n");t.trim()&&(y=e.customNestedParser?e.customNestedParser(t):n.blockTokens(t))}const b=e.createToken(h,y);c.push(b)}if(0!==c.length)return{items:c,raw:l}}function Wo(t,e,n,o){if(!t||!Array.isArray(t.content))return"";const r="function"==typeof n?n(o):n,[s,...i]=t.content,a=[`${r}${e.renderChildren([s])}`];return i&&i.length>0&&i.forEach(t=>{const n=e.renderChildren([t]);if(n){const t=n.split("\n").map(t=>t?e.indent(t):"").join("\n");a.push(t)}}),a.join("\n")}function Ko(t,e,n={}){const{state:o}=e,{doc:r,tr:s}=o,i=t;r.descendants((e,o)=>{const r=s.mapping.map(o),a=s.mapping.map(o)+e.nodeSize;let c=null;if(e.marks.forEach(t=>{if(t!==i)return!1;c=t}),!c)return;let l=!1;if(Object.keys(n).forEach(t=>{n[t]!==c.attrs[t]&&(l=!0)}),l){const e=t.type.create({...t.attrs,...n});s.removeMark(r,a,t.type),s.addMark(r,a,e)}}),s.docChanged&&e.view.dispatch(s)}at(Io,{createAtomBlockMarkdownSpec:()=>Bo,createBlockMarkdownSpec:()=>Lo,createInlineMarkdownSpec:()=>Uo,parseAttributes:()=>Do,parseIndentedBlocks:()=>Fo,renderNestedMarkdownContent:()=>Wo,serializeAttributes:()=>jo});var _o=class{constructor(t,e,n){this.component=t,this.editor=e.editor,this.options={...n},this.mark=e.mark,this.HTMLAttributes=e.HTMLAttributes}get dom(){return this.editor.view.dom}get contentDOM(){return null}updateAttributes(t,e){Ko(e||this.mark,this.editor,t)}ignoreMutation(t){if(!this.dom||!this.contentDOM)return!0;if("function"==typeof this.options.ignoreMutation)return this.options.ignoreMutation({mutation:t});if("selection"===t.type)return!1;if(this.dom.contains(t.target)&&"childList"===t.type&&(Dt()||It())&&this.editor.isFocused){if([...Array.from(t.addedNodes),...Array.from(t.removedNodes)].every(t=>t.isContentEditable))return!1}return this.contentDOM===t.target&&"attributes"===t.type||!this.contentDOM.contains(t.target)}},qo=class t extends Zn{constructor(){super(...arguments),this.type="node"}static create(e={}){const n="function"==typeof e?e():e;return new t(n)}configure(t){return super.configure(t)}extend(t){const e="function"==typeof t?t():t;return super.extend(e)}},Jo=class{constructor(t,e,n){this.isDragging=!1,this.component=t,this.editor=e.editor,this.options={stopEvent:null,ignoreMutation:null,...n},this.extension=e.extension,this.node=e.node,this.decorations=e.decorations,this.innerDecorations=e.innerDecorations,this.view=e.view,this.HTMLAttributes=e.HTMLAttributes,this.getPos=e.getPos,this.mount()}mount(){}get dom(){return this.editor.view.dom}get contentDOM(){return null}onDragStart(t){var e,n,o,r,i,a,c;const{view:l}=this.editor,d=t.target,p=3===d.nodeType?null==(e=d.parentElement)?void 0:e.closest("[data-drag-handle]"):d.closest("[data-drag-handle]");if(!this.dom||(null==(n=this.contentDOM)?void 0:n.contains(d))||!p)return;let u=0,h=0;if(this.dom!==p){const e=this.dom.getBoundingClientRect(),n=p.getBoundingClientRect(),s=null!=(r=t.offsetX)?r:null==(o=t.nativeEvent)?void 0:o.offsetX,c=null!=(a=t.offsetY)?a:null==(i=t.nativeEvent)?void 0:i.offsetY;u=n.x-e.x+s,h=n.y-e.y+c}const f=this.dom.cloneNode(!0);try{const t=this.dom.getBoundingClientRect();f.style.width=`${Math.round(t.width)}px`,f.style.height=`${Math.round(t.height)}px`,f.style.boxSizing="border-box",f.style.pointerEvents="none"}catch{}let m=null;try{m=document.createElement("div"),m.style.position="absolute",m.style.top="-9999px",m.style.left="-9999px",m.style.pointerEvents="none",m.appendChild(f),document.body.appendChild(m),null==(c=t.dataTransfer)||c.setDragImage(f,u,h)}finally{m&&setTimeout(()=>{try{null==m||m.remove()}catch{}},0)}const g=this.getPos();if("number"!=typeof g)return;const y=s.create(l.state.doc,g),v=l.state.tr.setSelection(y);l.dispatch(v)}stopEvent(t){var e;if(!this.dom)return!1;if("function"==typeof this.options.stopEvent)return this.options.stopEvent({event:t});const n=t.target;if(!(this.dom.contains(n)&&!(null==(e=this.contentDOM)?void 0:e.contains(n))))return!1;const o=t.type.startsWith("drag"),r="drop"===t.type;if((["INPUT","BUTTON","SELECT","TEXTAREA"].includes(n.tagName)||n.isContentEditable)&&!r&&!o)return!0;const{isEditable:i}=this.editor,{isDragging:a}=this,c=!!this.node.type.spec.draggable,l=s.isSelectable(this.node),d="copy"===t.type,p="paste"===t.type,u="cut"===t.type,h="mousedown"===t.type;if(!c&&l&&o&&t.target===this.dom&&t.preventDefault(),c&&o&&!a&&t.target===this.dom)return t.preventDefault(),!1;if(c&&i&&!a&&h){const t=n.closest("[data-drag-handle]");t&&(this.dom===t||this.dom.contains(t))&&(this.isDragging=!0,document.addEventListener("dragend",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("drop",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("mouseup",()=>{this.isDragging=!1},{once:!0}))}return!(a||r||d||p||u||h&&l)}ignoreMutation(t){if(!this.dom||!this.contentDOM)return!0;if("function"==typeof this.options.ignoreMutation)return this.options.ignoreMutation({mutation:t});if(this.node.isLeaf||this.node.isAtom)return!0;if("selection"===t.type)return!1;if(this.dom.contains(t.target)&&"childList"===t.type&&(Dt()||It())&&this.editor.isFocused){if([...Array.from(t.addedNodes),...Array.from(t.removedNodes)].every(t=>t.isContentEditable))return!1}return this.contentDOM===t.target&&"attributes"===t.type||!this.contentDOM.contains(t.target)}updateAttributes(t){this.editor.commands.command(({tr:e})=>{const n=this.getPos();return"number"==typeof n&&(e.setNodeMarkup(n,void 0,{...this.node.attrs,...t}),!0)})}deleteNode(){const t=this.getPos();if("number"!=typeof t)return;const e=t+this.node.nodeSize;this.editor.commands.deleteRange({from:t,to:e})}};function Xo(t){return new to({find:t.find,handler:({state:e,range:n,match:o,pasteEvent:r})=>{const s=Oe(t.getAttributes,void 0,o,r);if(!1===s||null===s)return null;const{tr:i}=e,a=o[o.length-1],c=o[0];let l=n.to;if(a){const o=c.search(/\S/),r=n.from+c.indexOf(a),d=r+a.length;if(nn(n.from,n.to,e.doc).filter(e=>e.mark.type.excluded.find(n=>n===t.type&&n!==e.mark.type)).filter(t=>t.to>r).length)return null;d<n.to&&i.delete(d,n.to),r>n.from&&i.delete(n.from+o,r),l=n.from+o+a.length,i.addMark(n.from+o,l,t.type.create(s||{})),i.removeStoredMark(t.type)}}})}function Yo(t){return new to({find:t.find,handler({match:e,chain:n,range:o,pasteEvent:r}){const s=Oe(t.getAttributes,void 0,e,r),i=Oe(t.getContent,void 0,s);if(!1===s||null===s)return null;const a={type:t.type.name,attrs:s};i&&(a.content=i),e.input&&n().deleteRange(o).insertContentAt(o.from,a)}})}function Zo(t){return new to({find:t.find,handler:({state:e,range:n,match:o})=>{let r=t.replace,s=n.from;const i=n.to;if(o[1]){const t=o[0].lastIndexOf(o[1]);r+=o[0].slice(t+o[1].length),s+=t;const e=s-i;e>0&&(r=o[0].slice(t-e,t)+r,s=i)}e.tr.insertText(r,s,i)}})}var Qo=class{constructor(t){this.transaction=t,this.currentStep=this.transaction.steps.length}map(t){let e=!1;return{position:this.transaction.steps.slice(this.currentStep).reduce((t,n)=>{const o=n.getMap().mapResult(t);return o.deleted&&(e=!0),o.pos},t),deleted:e}}};const Go=/* @__PURE__ */Object.freeze(/* @__PURE__ */Object.defineProperty({__proto__:null,CommandManager:lt,Editor:ko,Extendable:Zn,Extension:io,Fragment:To,InputRule:_n,MappablePosition:gn,Mark:Qn,MarkView:_o,Node:qo,NodePos:bo,NodeView:Jo,PasteRule:to,ResizableNodeView:$o,ResizableNodeview:Oo,Tracker:Qo,callOrReturn:Oe,canInsertNode:Ro,combineTransactionSteps:we,commands:dt,createAtomBlockMarkdownSpec:Bo,createBlockMarkdownSpec:Lo,createChainableState:ct,createDocument:ye,createElement:Ao,createInlineMarkdownSpec:Uo,createMappablePosition:vn,createNodeFromContent:Ft,createStyleTag:wo,defaultBlockAt:ke,deleteProps:ce,elementFromString:Ut,escapeForRegEx:zo,extensions:so,findChildren:xe,findChildrenInRange:Me,findDuplicates:He,findParentNode:Ee,findParentNodeClosestToPos:Se,flattenExtensions:Te,fromString:De,generateHTML:Ke,generateJSON:_e,generateText:Ye,getAttributes:Qe,getAttributesFromExtensions:Ne,getChangedRanges:tn,getDebugJSON:en,getExtensionField:Ce,getHTMLFromFragment:Ae,getMarkAttributes:be,getMarkRange:At,getMarkType:$t,getMarksBetween:nn,getNodeAtPosition:on,getNodeAttributes:Ze,getNodeType:vt,getRenderedAttributes:Ie,getSchema:We,getSchemaByResolvedExtensions:Ve,getSchemaTypeByName:rn,getSchemaTypeNameByName:ae,getSplittedAttributes:sn,getText:Je,getTextBetween:qe,getTextContentFromNodes:an,getTextSerializersFromSchema:Xe,getUpdatedPosition:yn,h:Ao,injectExtensionAttributesToParseRule:je,inputRulesPlugin:Jn,isActive:ln,isAndroid:It,isAtEndOfNode:dn,isAtStartOfNode:pn,isEmptyObject:Re,isExtensionRulesEnabled:un,isFirefox:No,isFunction:$e,isList:hn,isMacOS:te,isMarkActive:cn,isNodeActive:ne,isNodeEmpty:fn,isNodeSelection:mn,isNumber:Gn,isPlainObject:Xn,isRegExp:St,isSafari:jt,isString:Po,isTextSelection:zt,isiOS:Dt,markInputRule:xo,markPasteRule:Xo,markdown:Io,mergeAttributes:Pe,mergeDeep:Yn,minMax:Nt,nodeInputRule:Mo,nodePasteRule:Yo,objectIncludes:Et,parseAttributes:Do,parseIndentedBlocks:Fo,pasteRulesPlugin:oo,posToDOMRect:bn,removeDuplicates:Ge,renderNestedMarkdownContent:Wo,resolveExtensions:Fe,resolveFocusPosition:Pt,rewriteUnknownContent:kn,selectionToInsertionEnd:Wt,serializeAttributes:jo,sortExtensions:Ue,splitExtensions:ze,textInputRule:Eo,textPasteRule:Zo,textblockTypeInputRule:So,updateMarkViewAttributes:Ko,wrappingInputRule:Co},Symbol.toStringTag,{value:"Module"}));export{$t as $,xe as A,Me as B,Go as C,He as D,ko as E,To as F,Ee as G,Se as H,_n as I,Te as J,De as K,Ke as L,gn as M,qo as N,_e as O,to as P,Ye as Q,$o as R,Qe as S,Qo as T,Ne as U,tn as V,en as W,Ce as X,Ae as Y,be as Z,At as _,lt as a,Ko as a$,nn as a0,on as a1,Ze as a2,vt as a3,Ie as a4,We as a5,Ve as a6,rn as a7,ae as a8,sn as a9,zt as aA,Dt as aB,xo as aC,Xo as aD,Io as aE,Pe as aF,Yn as aG,Nt as aH,Mo as aI,Yo as aJ,Et as aK,Do as aL,Fo as aM,oo as aN,bn as aO,Ge as aP,Wo as aQ,Fe as aR,Pt as aS,kn as aT,Wt as aU,jo as aV,Ue as aW,ze as aX,Eo as aY,Zo as aZ,So as a_,Je as aa,qe as ab,an as ac,Xe as ad,yn as ae,je as af,Jn as ag,ln as ah,It as ai,dn as aj,pn as ak,Re as al,un as am,No as an,$e as ao,hn as ap,te as aq,cn as ar,ne as as,fn as at,mn as au,Gn as av,Xn as aw,St as ax,jt as ay,Po as az,Zn as b,Co as b0,st as b1,io as c,Qn as d,_o as e,bo as f,Jo as g,Oo as h,Oe as i,Ro as j,we as k,dt as l,Bo as m,Lo as n,ct as o,ye as p,Ao as q,Uo as r,vn as s,Ft as t,wo as u,ke as v,ce as w,Ut as x,zo as y,so as z};
